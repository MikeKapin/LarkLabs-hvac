<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canadian A2L Refrigerant Safety Certificate Course - LARK Labs</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            text-align: center;
        }

        .header h1 {
            color: #1e3c72;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header .subtitle {
            color: #2a5298;
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .course-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .info-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #2a5298;
        }

        .info-card h3 {
            color: #1e3c72;
            margin-bottom: 5px;
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            width: 0%;
            transition: width 0.5s ease;
        }

        .progress-text {
            text-align: center;
            margin-top: 10px;
            font-weight: 600;
            color: #2a5298;
        }

        .module {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: none;
        }

        .module.active {
            display: block;
        }

        .module-header {
            background: linear-gradient(135deg, #2a5298, #1e3c72);
            color: white;
            padding: 25px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .module-header h2 {
            font-size: 1.8em;
            margin-bottom: 5px;
        }

        .module-number {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 15px;
            border-radius: 25px;
            font-weight: bold;
        }

        .module-content {
            padding: 30px;
        }

        .objectives {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 5px;
        }

        .objectives h3 {
            color: #1565c0;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .objectives h3::before {
            content: "üéØ";
            margin-right: 10px;
        }

        .objectives ul {
            list-style: none;
        }

        .objectives li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }

        .objectives li::before {
            content: "‚úì";
            position: absolute;
            left: 0;
            color: #2196f3;
            font-weight: bold;
        }

        .content-section {
            margin: 25px 0;
            line-height: 1.6;
        }

        .content-section h3 {
            color: #1e3c72;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .content-section h4 {
            color: #2a5298;
            margin: 15px 0 10px 0;
        }

        .highlight-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }

        .highlight-box.warning {
            background: #f8d7da;
            border-color: #f5c6cb;
        }

        .highlight-box.info {
            background: #d1ecf1;
            border-color: #bee5eb;
        }

        .highlight-box.success {
            background: #d4edda;
            border-color: #c3e6cb;
        }

        .quiz-container {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 25px;
            margin: 25px 0;
            border: 2px solid #e9ecef;
        }

        .quiz-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .quiz-header::before {
            content: "‚ùì";
            font-size: 1.5em;
            margin-right: 10px;
        }

        .quiz-question {
            font-weight: 600;
            color: #1e3c72;
            margin-bottom: 15px;
        }

        .quiz-options {
            display: grid;
            gap: 10px;
        }

        .quiz-option {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-option:hover {
            border-color: #2a5298;
            background: #f8f9fa;
        }

        .quiz-option.selected {
            border-color: #2a5298;
            background: #e3f2fd;
        }

        .quiz-option.correct {
            border-color: #28a745;
            background: #d4edda;
        }

        .quiz-option.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .quiz-feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            display: none;
        }

        .quiz-feedback.show {
            display: block;
        }

        .quiz-feedback.correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .quiz-feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e9ecef;
        }

        .nav-button {
            background: linear-gradient(135deg, #2a5298, #1e3c72);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(42, 82, 152, 0.3);
        }

        .nav-button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .module-navigation {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .module-nav-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
        }

        .module-nav-item {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .module-nav-item:hover {
            border-color: #2a5298;
            background: #e3f2fd;
        }

        .module-nav-item.completed {
            border-color: #28a745;
            background: #d4edda;
        }

        .module-nav-item.current {
            border-color: #2a5298;
            background: #e3f2fd;
        }

        .module-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #2a5298;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .module-icon.completed {
            background: #28a745;
        }

        .drag-drop-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 20px 0;
        }

        .drag-items, .drop-zones {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            min-height: 200px;
        }

        .drag-item {
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
            cursor: grab;
            transition: all 0.3s ease;
        }

        .drag-item:hover {
            border-color: #2a5298;
            transform: translateY(-2px);
        }

        .drop-zone {
            background: white;
            border: 2px dashed #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            min-height: 50px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .drop-zone.drag-over {
            border-color: #2a5298;
            background: #e3f2fd;
        }

        .drop-zone.filled {
            border-style: solid;
            border-color: #28a745;
            background: #d4edda;
        }

        .calculation-widget {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .calculation-input {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 15px 0;
        }

        .calculation-input input {
            padding: 10px;
            border: 2px solid #dee2e6;
            border-radius: 5px;
            font-size: 1em;
        }

        .calculate-btn {
            background: #2a5298;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
        }

        .certificate-container {
            background: linear-gradient(135deg, #fff, #f8f9fa);
            border: 3px solid #2a5298;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin: 20px auto;
            max-width: 750px;
            width: 100%;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            /* Ensure it fits on 8.5x11 paper */
            height: auto;
            min-height: 600px;
            max-height: 700px;
        }

        .certificate-header {
            color: #1e3c72;
            font-size: 1.8em;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .certificate-body {
            font-size: 1em;
            line-height: 1.4;
            margin: 15px 0;
        }

        .download-certificate {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            cursor: pointer;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .module-header {
                padding: 20px;
                flex-direction: column;
                gap: 10px;
            }
            
            .module-content {
                padding: 20px;
            }
            
            .drag-drop-container {
                grid-template-columns: 1fr;
            }
            
            .navigation {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Canadian A2L Refrigerant Safety Certificate Course</h1>
            <p class="subtitle">Professional Training for HVAC Technicians, Students, and Educators</p>
            <div class="course-info">
                <div class="info-card">
                    <h3>üéì Target Audience</h3>
                    <p>HVAC technicians, apprentices, students, educators</p>
                </div>
                <div class="info-card">
                    <h3>‚è±Ô∏è Duration</h3>
                    <p>6-8 hours (including assessments)</p>
                </div>
                <div class="info-card">
                    <h3>üìã Certification</h3>
                    <p>Digital Certificate of Completion</p>
                </div>
                <div class="info-card">
                    <h3>üá®üá¶ Compliance</h3>
                    <p>CSA B52, B149.1-25, TSSA Standards</p>
                </div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-text" id="progressText">Module 1 of 8 - 12.5% Complete</div>
        </div>

        <!-- Module Navigation -->
        <div class="module-navigation">
            <h3 style="margin-bottom: 20px; color: #1e3c72;">Course Modules</h3>
            <div class="module-nav-grid" id="moduleNavGrid">
                <!-- Module navigation items will be populated by JavaScript -->
            </div>
        </div>

        <!-- Module 1: Introduction to A2L Refrigerants -->
        <div class="module active" id="module1">
            <div class="module-header">
                <div>
                    <h2>Introduction to A2L Refrigerants</h2>
                    <p>Understanding the basics of mildly flammable refrigerants</p>
                </div>
                <div class="module-number">1</div>
            </div>
            <div class="module-content">
                <div class="objectives">
                    <h3>Learning Objectives</h3>
                    <ul>
                        <li>Define A2L refrigerants and their characteristics</li>
                        <li>Understand why A2Ls are being adopted in Canada</li>
                        <li>Identify common A2L refrigerants (R-32, R-454B, etc.)</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Welcome to A2L Refrigerant Safety</h3>
                    <p>The HVAC industry is undergoing a major shift as we transition from high-GWP HFC refrigerants to lower-GWP alternatives. A2L refrigerants‚Äîsuch as R-32 and R-454B‚Äîare now being widely adopted in Canada due to their lower environmental impact.</p>
                </div>

                <div class="content-section">
                    <h3>ASHRAE 34 Refrigerant Classification System</h3>
                    
                    <div style="overflow-x: auto; margin: 20px 0;">
                        <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                            <thead>
                                <tr style="background: #2a5298; color: white;">
                                    <th style="padding: 12px; border: 1px solid #ddd;">Classification</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">Toxicity Level</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">Flammability Characteristics</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">Common Examples</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">Canadian Safety Level</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">CSA B52-22 Requirements</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">A1</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Lower (OEL ‚â•400 ppm)</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">No Flame Propagation</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">R-134a, R-410A, R-404A</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Highest</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Standard protocols</td>
                                </tr>
                                <tr style="background: #fff3cd;">
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">A2L</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Lower (OEL ‚â•400 ppm)</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Lower Flammability (<3.9 in/s)</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;"><strong>R-32, R-454B, R-1234yf, R-452B</strong></td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">High with precautions</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;"><strong>Enhanced detection & ventilation required</strong></td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">A2</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Lower (OEL ‚â•400 ppm)</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Higher Flammability</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">R-152a, R-290 (Propane)</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Moderate</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Special handling & detection required</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">A3</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Lower (OEL ‚â•400 ppm)</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Highest Flammability</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">R-600a (Isobutane), R-170</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Lowest</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Extreme caution protocols</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">B1, B2L, B2, B3</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Higher (<400 ppm)</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Various Flammability</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">R-123, Ammonia variants</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Restricted</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">Special training & equipment required</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="highlight-box info">
                    <h4>üá®üá¶ Complete Canadian Regulatory Framework</h4>
                    <p>All A2L refrigerant work in Canada must comply with:</p>
                    <ul style="margin-left: 20px;">
                        <li><strong>CSA B52-22:</strong> Mechanical Refrigeration Code (Primary Standard)</li>
                        <li><strong>CSA B149.1:</strong> Natural Gas and Propane Installation Code (where applicable)</li>
                        <li><strong>TSSA Regulations:</strong> Provincial oversight and mandatory inspection requirements</li>
                        <li><strong>ECCC Guidelines:</strong> Environmental protection and HFC phase-down reporting</li>
                        <li><strong>Provincial OHS:</strong> Workplace safety standards and WHMIS compliance</li>
                        <li><strong>CEC (Canadian Electrical Code):</strong> Electrical safety requirements</li>
                        <li><strong>Local Building Codes:</strong> Municipal installation requirements</li>
                    </ul>
                </div>

                <div class="highlight-box info">
                    <h4>Why A2Ls?</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Environmental compliance:</strong> Montreal Protocol and Kigali Amendment require phase-down of high-GWP HFCs</li>
                        <li><strong>Efficiency:</strong> Many A2Ls offer better thermodynamic performance</li>
                        <li><strong>Regulatory alignment:</strong> CSA B52, B149.1-25, and TSSA now permit A2Ls in specific applications</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Common A2L Refrigerants</h3>
                    <h4>R-32</h4>
                    <p>Used in mini-splits, VRF, and packaged equipment. GWP of 675 (much lower than R-410A's 2088).</p>
                    
                    <h4>R-454B</h4>
                    <p>Replaces R-410A in many new units. Designed as a lower-GWP alternative.</p>
                    
                    <h4>Others</h4>
                    <p>R-1234yf, R-1234ze (less common in Canada, but growing).</p>
                </div>

                <div class="highlight-box warning">
                    <h4>‚ö†Ô∏è Key Takeaway</h4>
                    <p>A2Ls are not "drop-in" replacements. They require new equipment, updated codes, and special handling procedures.</p>
                </div>

                <!-- Interactive Quiz -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Knowledge Check 1.1</h3>
                    </div>
                    <div class="quiz-question">Which of these is an A2L refrigerant?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-answer="a">a) R-22</div>
                        <div class="quiz-option" data-answer="b">b) R-410A</div>
                        <div class="quiz-option" data-answer="c">c) R-32</div>
                        <div class="quiz-option" data-answer="d">d) R-290</div>
                    </div>
                    <div class="quiz-feedback">
                        <p><strong>Correct!</strong> R-32 is classified as an A2L refrigerant - lower toxicity and mildly flammable.</p>
                    </div>
                </div>

                <!-- Drag and Drop Activity -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Interactive Activity 1.2 - Match Refrigerants to Safety Groups</h3>
                    </div>
                    <div class="drag-drop-container">
                        <div class="drag-items">
                            <h4>Refrigerants</h4>
                            <div class="drag-item" draggable="true" data-value="R-32">R-32</div>
                            <div class="drag-item" draggable="true" data-value="R-410A">R-410A</div>
                            <div class="drag-item" draggable="true" data-value="R-290">R-290</div>
                        </div>
                        <div class="drop-zones">
                            <h4>Safety Groups</h4>
                            <div class="drop-zone" data-target="A2L">A2L (Mildly Flammable)</div>
                            <div class="drop-zone" data-target="A1">A1 (Non-flammable)</div>
                            <div class="drop-zone" data-target="A3">A3 (Highly Flammable)</div>
                        </div>
                    </div>
                </div>

                <!-- System Diagnostic Calculator -->
                <div class="calculation-widget">
                    <h4>üîß System Diagnostic Calculator</h4>
                    <p>Analyze A2L system performance based on operating conditions</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div>
                            <h5>Operating Conditions</h5>
                            <div class="calculation-input">
                                <label>Outdoor Temperature (¬∞C):</label>
                                <input type="number" id="outdoorTemp" placeholder="e.g., 35" min="-40" max="50" step="1" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 5px;">
                            </div>
                            <div class="calculation-input">
                                <label>Indoor Temperature (¬∞C):</label>
                                <input type="number" id="indoorTemp" placeholder="e.g., 22" min="15" max="35" step="1" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 5px;">
                            </div>
                            <div class="calculation-input">
                                <label>Refrigerant Type:</label>
                                <select id="diagnosticRefrigerant" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 5px;">
                                    <option value="R-32">R-32</option>
                                    <option value="R-454B">R-454B</option>
                                    <option value="R-1234yf">R-1234yf</option>
                                    <option value="R-452B">R-452B</option>
                                </select>
                            </div>
                            
                            <h5 style="margin-top: 20px;">Measured Pressures</h5>
                            <div class="calculation-input">
                                <label>Suction Pressure (bar):</label>
                                <input type="number" id="suctionPressure" placeholder="Low side" min="0" step="0.1" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 5px;">
                            </div>
                            <div class="calculation-input">
                                <label>Discharge Pressure (bar):</label>
                                <input type="number" id="dischargePressure" placeholder="High side" min="0" step="0.1" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 5px;">
                            </div>
                            
                            <button class="calculate-btn" onclick="diagnoseSystem()" style="width: 100%; margin-top: 15px;">Analyze System Performance</button>
                        </div>
                        
                        <div id="diagnosticResult" style="background: #f8f9fa; padding: 20px; border-radius: 10px; display: none;">
                            <h5>System Performance Analysis</h5>
                            <div id="diagnosticSummary" style="margin: 15px 0; padding: 15px; border-radius: 5px;"></div>
                            
                            <div id="expectedValues" style="margin: 15px 0;">
                                <h6>Expected vs. Actual Values:</h6>
                                <div id="comparisonTable"></div>
                            </div>
                            
                            <div id="diagnosticRecommendations" style="margin: 15px 0;">
                                <h6>Diagnostic Recommendations:</h6>
                                <div id="recommendationsList"></div>
                            </div>
                            
                            <div id="safetyConsiderations" style="margin: 15px 0; padding: 10px; background: #fff3cd; border-radius: 5px;">
                                <h6>A2L Safety Considerations:</h6>
                                <div id="safetyNotes"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="navigation">
                    <button class="nav-button" disabled>‚Üê Previous Module</button>
                    <button class="nav-button" onclick="nextModule()">Next Module ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Module 2: Regulatory Requirements & Codes -->
        <div class="module" id="module2">
            <div class="module-header">
                <div>
                    <h2>Regulatory Requirements & Codes</h2>
                    <p>Understanding Canadian codes and standards for A2L refrigerants</p>
                </div>
                <div class="module-number">2</div>
            </div>
            <div class="module-content">
                <div class="objectives">
                    <h3>Learning Objectives</h3>
                    <ul>
                        <li>Identify relevant Canadian codes (CSA B52, B149.1-25)</li>
                        <li>Understand TSSA requirements for A2L installations</li>
                        <li>Recognize labeling, documentation, and record-keeping requirements</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Canadian Code Overview</h3>
                    
                    <h4>CSA B52: Mechanical Refrigeration Code</h4>
                    <p>Now includes A2L-specific provisions for charge limits, ventilation, and leak detection. This is your primary reference for A2L installations.</p>
                    
                    <h4>CSA B149.1-25: Natural Gas and Propane Installation Code</h4>
                    <p>Covers piping, venting, and appliance requirements for A2L systems when integrated with gas heating systems.</p>
                    
                    <h4>TSSA (Technical Standards and Safety Authority)</h4>
                    <p>Enforces compliance in Ontario, issues bulletins and inspection protocols for A2L installations.</p>
                </div>

                <div class="highlight-box info">
                    <h4>Key Requirements</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Labeling:</strong> All A2L systems must be clearly labeled with "A2L ‚Äì Mildly Flammable Refrigerant" near service ports and on access panels</li>
                        <li><strong>Documentation:</strong> Keep MSDS sheets, installation manuals, and code references on site</li>
                        <li><strong>Permits & Inspections:</strong> Most A2L installs require a permit and TSSA inspection</li>
                    </ul>
                </div>

                <div class="highlight-box warning">
                    <h4>üîç Best Practice</h4>
                    <p>Always check the latest code updates and TSSA advisories before starting any A2L project. Codes are updated regularly!</p>
                </div>

                <!-- Interactive Quiz -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Knowledge Check 2.1</h3>
                    </div>
                    <div class="quiz-question">You're installing a mini-split with R-32. Which code sections must you reference for piping and ventilation?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-answer="a">a) Only CSA B52</div>
                        <div class="quiz-option" data-answer="b">b) Only CSA B149.1-25</div>
                        <div class="quiz-option" data-answer="c">c) CSA B52 Sections 6 & 7, plus manufacturer's manual</div>
                        <div class="quiz-option" data-answer="d">d) No specific codes required</div>
                    </div>
                    <div class="quiz-feedback">
                        <p><strong>Correct!</strong> CSA B52 Sections 6 & 7 cover piping and ventilation requirements, and you must always follow the manufacturer's installation manual.</p>
                    </div>
                </div>

                <!-- Fill in the blank -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Knowledge Check 2.2</h3>
                    </div>
                    <div class="quiz-question">All A2L systems must have a _________ label near the service port.</div>
                    <input type="text" id="fillBlank1" placeholder="Enter your answer" style="width: 200px; padding: 10px; margin: 10px; border: 2px solid #dee2e6; border-radius: 5px;">
                    <button onclick="checkFillBlank('fillBlank1', 'flammable refrigerant')" class="calculate-btn">Check Answer</button>
                    <div id="fillBlank1Feedback" class="quiz-feedback"></div>
                </div>

                <div class="navigation">
                    <button class="nav-button" onclick="previousModule()">‚Üê Previous Module</button>
                    <button class="nav-button" onclick="nextModule()">Next Module ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Module 3: Properties and Hazards -->
        <div class="module" id="module3">
            <div class="module-header">
                <div>
                    <h2>Properties and Hazards of A2L Refrigerants</h2>
                    <p>Understanding the physical and chemical characteristics</p>
                </div>
                <div class="module-number">3</div>
            </div>
            <div class="module-content">
                <div class="objectives">
                    <h3>Learning Objectives</h3>
                    <ul>
                        <li>List key physical and chemical properties of A2Ls</li>
                        <li>Explain flammability, toxicity, and combustion risks</li>
                        <li>Describe safe handling and storage procedures</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>A2L Flammability Characteristics - Canadian Standards</h3>
                    
                    <div style="overflow-x: auto; margin: 20px 0;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #2a5298; color: white;">
                                    <th style="padding: 12px; border: 1px solid #ddd;">Refrigerant</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">LFL (% vol)</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">UFL (% vol)</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">Burning Velocity (in/s)</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">Ignition Energy (mJ)</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">CSA B52-22 Classification</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">R-32</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">14.4</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">29.3</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">2.6</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">15-20</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">A2L</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">R-454B</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">15.2</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">28.7</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">2.3</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">18-25</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">A2L</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">R-1234yf</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">6.2</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">12.3</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">1.5</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">3-5</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">A2L</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">R-452B</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">16.1</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">30.2</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">2.8</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">12-18</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">A2L</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Detailed Physical & Chemical Properties</h3>
                    
                    <div style="overflow-x: auto; margin: 20px 0;">
                        <table style="width: 100%; border-collapse: collapse;">
                            <thead>
                                <tr style="background: #2a5298; color: white;">
                                    <th style="padding: 12px; border: 1px solid #ddd;">Property</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">R-32</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">R-454B</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">R-1234yf</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">R-452B</th>
                                    <th style="padding: 12px; border: 1px solid #ddd;">Units</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Molecular Weight</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">52.02</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">69.5</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">114.04</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">69.4</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">g/mol</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Boiling Point</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">-51.7</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">-47.1</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">-29.5</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">-49.8</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">¬∞C</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Critical Temperature</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">78.1</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">95.7</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">94.7</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">82.4</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">¬∞C</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Critical Pressure</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">57.8</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">46.1</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">33.8</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">45.5</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">bar</td>
                                </tr>
                                <tr style="background: #e8f5e8;">
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">GWP (AR5)</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">675</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">466</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">4</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">698</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">-</td>
                                </tr>
                                <tr style="background: #e8f5e8;">
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">ODP</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">0</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">0</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">0</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">0</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">-</td>
                                </tr>
                                <tr>
                                    <td style="padding: 12px; border: 1px solid #ddd; font-weight: bold;">Safety Classification</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">A2L</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">A2L</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">A2L</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">A2L</td>
                                    <td style="padding: 12px; border: 1px solid #ddd;">ASHRAE 34</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Leak Detector Calibration Calculator -->
                <div class="calculation-widget">
                    <h4>üîç Leak Detector Calibration Calculator</h4>
                    <p>Calculate proper calibration gas concentration for A2L leak detectors</p>
                    <div class="calculation-input">
                        <label>Refrigerant Type:</label>
                        <select id="calibRefrigerant" style="padding: 8px; margin: 5px; border: 2px solid #dee2e6; border-radius: 5px;">
                            <option value="R-32">R-32</option>
                            <option value="R-454B">R-454B</option>
                            <option value="R-1234yf">R-1234yf</option>
                            <option value="R-452B">R-452B</option>
                        </select>
                    </div>
                    <div class="calculation-input">
                        <label>Detection Level (% of LFL):</label>
                        <input type="number" id="detectionLevel" value="25" min="10" max="50" style="padding: 8px; margin: 5px; border: 2px solid #dee2e6; border-radius: 5px;">
                        <span>%</span>
                    </div>
                    <button class="calculate-btn" onclick="calculateCalibration()">Calculate Calibration Gas</button>
                    <div id="calibrationResult" style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 5px; display: none;">
                        <h5>Calibration Results:</h5>
                        <div id="calibrationDetails"></div>
                    </div>
                </div>

                <div class="highlight-box warning">
                    <h4>‚ö†Ô∏è Key Hazards</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Mild flammability:</strong> Not explosive, but can ignite with a strong ignition source</li>
                        <li><strong>Low toxicity:</strong> Still avoid inhalation‚Äîalways use in ventilated spaces</li>
                        <li><strong>Leak behavior:</strong> Heavier than air; can pool near floor</li>
                        <li><strong>Displacement:</strong> Can displace oxygen in confined spaces</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Safe Handling & Storage</h3>
                    
                    <h4>Storage Requirements</h4>
                    <ul style="margin-left: 20px;">
                        <li>Store cylinders upright, away from heat and open flame</li>
                        <li>Secure cylinders to prevent falling or rolling</li>
                        <li>Keep in well-ventilated areas</li>
                        <li>Separate from incompatible materials</li>
                    </ul>
                    
                    <h4>Handling Procedures</h4>
                    <ul style="margin-left: 20px;">
                        <li>Use only approved recovery machines and leak detectors</li>
                        <li>Ensure adequate ventilation before opening systems</li>
                        <li>Never use compressed air for pressure testing</li>
                        <li>Follow lockout/tagout procedures</li>
                    </ul>
                </div>

                <!-- True/False Quiz -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Knowledge Check 3.1</h3>
                    </div>
                    <div class="quiz-question">A2L refrigerants can be stored in the same area as A1 refrigerants without restrictions.</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-answer="true">True</div>
                        <div class="quiz-option" data-answer="false">False</div>
                    </div>
                    <div class="quiz-feedback">
                        <p><strong>Correct!</strong> False. A2L refrigerants require special storage considerations due to their mild flammability.</p>
                    </div>
                </div>

                <!-- Hotspot Activity -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Interactive Activity 3.2 - Storage Area Selection</h3>
                    </div>
                    <p>Click on the correct storage area for A2L cylinders in this diagram:</p>
                    <div style="position: relative; background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <!-- Simple diagram representation -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; height: 200px;">
                            <div class="hotspot-area" data-correct="false" style="background: #ffebee; border: 2px solid #f44336; border-radius: 10px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                                <div style="text-align: center;">
                                    <div>üî•</div>
                                    <div>Near Heat Source</div>
                                </div>
                            </div>
                            <div class="hotspot-area" data-correct="true" style="background: #e8f5e8; border: 2px solid #4caf50; border-radius: 10px; display: flex; align-items: center; justify-content: center; cursor: pointer;">
                                <div style="text-align: center;">
                                    <div>üå¨Ô∏è</div>
                                    <div>Ventilated Area</div>
                                    <div>(Away from ignition sources)</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div id="hotspotFeedback" class="quiz-feedback"></div>
                </div>

                <div class="navigation">
                    <button class="nav-button" onclick="previousModule()">‚Üê Previous Module</button>
                    <button class="nav-button" onclick="nextModule()">Next Module ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Module 4: System Design & Installation -->
        <div class="module" id="module4">
            <div class="module-header">
                <div>
                    <h2>System Design & Installation Considerations</h2>
                    <p>Design requirements and installation best practices</p>
                </div>
                <div class="module-number">4</div>
            </div>
            <div class="module-content">
                <div class="objectives">
                    <h3>Learning Objectives</h3>
                    <ul>
                        <li>Identify design considerations for A2L systems</li>
                        <li>Understand ventilation, leak detection, and mitigation requirements</li>
                        <li>Select approved components and materials</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Charge Limits</h3>
                    <p>CSA B52 Table 5 specifies maximum refrigerant charges based on room volume and occupancy:</p>
                    
                    <div class="highlight-box info">
                        <h4>R-32 Charge Limit Formula</h4>
                        <p><strong>Maximum Charge = Room Volume (m¬≥) √ó 0.307 kg/m¬≥</strong></p>
                        <p>For occupied spaces without additional safety measures</p>
                    </div>
                    
                    <p>Exceeding these limits requires:</p>
                    <ul style="margin-left: 20px;">
                        <li>Additional mechanical ventilation</li>
                        <li>Refrigerant leak detection systems</li>
                        <li>Emergency ventilation controls</li>
                        <li>Additional documentation and approvals</li>
                    </ul>
                </div>

                <!-- Enhanced Calculation Widget -->
                <div class="calculation-widget">
                    <h4>üßÆ Enhanced Charge Limit Calculator</h4>
                    <div class="calculation-input">
                        <label>Room Volume (m¬≥):</label>
                        <input type="number" id="roomVolume" placeholder="Enter volume" min="1" step="0.1">
                        <label>Refrigerant Type:</label>
                        <select id="chargeRefrigerant" style="padding: 8px; margin: 5px; border: 2px solid #dee2e6; border-radius: 5px;">
                            <option value="R-32">R-32 (0.307 kg/m¬≥)</option>
                            <option value="R-454B">R-454B (0.320 kg/m¬≥)</option>
                            <option value="R-1234yf">R-1234yf (0.290 kg/m¬≥)</option>
                            <option value="R-452B">R-452B (0.315 kg/m¬≥)</option>
                        </select>
                    </div>
                    <div class="calculation-input">
                        <span>Maximum Charge = </span>
                        <span id="chargeResult">__ kg</span>
                    </div>
                    <button class="calculate-btn" onclick="calculateEnhancedCharge()">Calculate Maximum Charge</button>
                    <div id="chargeExplanation" style="margin-top: 15px; font-style: italic;"></div>
                </div>

                <!-- Pressure-Temperature Calculator -->
                <div class="calculation-widget">
                    <h4>üìä Interactive Pressure-Temperature Calculator</h4>
                    <p>Calculate saturation pressure/temperature relationships for A2L refrigerants</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <div class="calculation-input">
                                <label>Refrigerant:</label>
                                <select id="ptRefrigerant" style="padding: 8px; margin: 5px; border: 2px solid #dee2e6; border-radius: 5px; width: 100%;">
                                    <option value="R-32">R-32</option>
                                    <option value="R-454B">R-454B</option>
                                    <option value="R-1234yf">R-1234yf</option>
                                    <option value="R-452B">R-452B</option>
                                </select>
                            </div>
                            <div class="calculation-input">
                                <label>Known Value:</label>
                                <input type="radio" id="tempKnown" name="knownValue" value="temperature" checked>
                                <label for="tempKnown">Temperature (¬∞C)</label>
                                <input type="radio" id="pressKnown" name="knownValue" value="pressure">
                                <label for="pressKnown">Pressure (bar)</label>
                            </div>
                            <div class="calculation-input">
                                <input type="number" id="ptInput" placeholder="Enter value" step="0.1" style="padding: 8px; border: 2px solid #dee2e6; border-radius: 5px; width: 100%;">
                            </div>
                            <button class="calculate-btn" onclick="calculatePT()" style="width: 100%;">Calculate</button>
                        </div>
                        <div id="ptResult" style="background: #f8f9fa; padding: 15px; border-radius: 5px; display: none;">
                            <h5>Results:</h5>
                            <div id="ptDetails"></div>
                            <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                                <strong>Canadian Operating Pressures:</strong>
                                <div id="operatingPressures"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="highlight-box info">
                    <h4>üá®üá¶ Canadian Operating Pressures (Typical Conditions)</h4>
                    <ul style="margin-left: 20px; font-size: 0.95em;">
                        <li><strong>R-32:</strong> Low side: 4-8 bar, High side: 18-28 bar (typical residential)</li>
                        <li><strong>R-454B:</strong> Low side: 3-7 bar, High side: 16-24 bar (balanced performance)</li>
                        <li><strong>R-1234yf:</strong> Low side: 2-5 bar, High side: 12-20 bar (automotive applications)</li>
                        <li><strong>R-452B:</strong> Low side: 4-8 bar, High side: 19-26 bar (commercial systems)</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Pipework & Fittings</h3>
                    
                    <h4>Approved Materials</h4>
                    <ul style="margin-left: 20px;">
                        <li>A2L-rated copper tubing and fittings</li>
                        <li>Stainless steel for special applications</li>
                        <li>Approved flexible hoses (A2L-rated only)</li>
                    </ul>
                    
                    <h4>Connection Methods</h4>
                    <div class="highlight-box success">
                        <p><strong>‚úÖ Approved:</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>Brazed connections (preferred)</li>
                            <li>Mechanical fittings (A2L-rated)</li>
                            <li>Flared connections (with proper torque)</li>
                        </ul>
                    </div>
                    
                    <div class="highlight-box warning">
                        <p><strong>‚ùå Not Permitted:</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>Soldered joints</li>
                            <li>Standard compression fittings</li>
                            <li>Threaded connections (except where specifically approved)</li>
                        </ul>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Leak Detection Requirements</h3>
                    <p>Mandatory in certain occupancy types:</p>
                    <ul style="margin-left: 20px;">
                        <li>Hotels and apartments</li>
                        <li>Schools and institutional buildings</li>
                        <li>Commercial kitchens</li>
                        <li>Mechanical rooms with limited ventilation</li>
                    </ul>
                    
                    <h4>Detection System Requirements</h4>
                    <ul style="margin-left: 20px;">
                        <li>Place detectors near floor level (A2Ls are heavier than air)</li>
                        <li>Alarm at 25% of LFL</li>
                        <li>Automatic ventilation activation</li>
                        <li>Connection to building management system (where applicable)</li>
                    </ul>
                </div>

                <!-- Quiz -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Knowledge Check 4.1</h3>
                    </div>
                    <div class="quiz-question">Which of the following connection methods is NOT permitted for A2L refrigerants?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-answer="a">a) Soldered copper joints</div>
                        <div class="quiz-option" data-answer="b">b) Brazed copper joints</div>
                        <div class="quiz-option" data-answer="c">c) Mechanical A2L-rated fittings</div>
                        <div class="quiz-option" data-answer="d">d) Flared connections</div>
                    </div>
                    <div class="quiz-feedback">
                        <p><strong>Correct!</strong> Soldered joints are not permitted for A2L refrigerants due to their lower melting point and potential for failure.</p>
                    </div>
                </div>

                <!-- Calculation Quiz -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Knowledge Check 4.2</h3>
                    </div>
                    <div class="quiz-question">A mechanical room has a volume of 40 m¬≥. What is the maximum allowable R-32 charge per CSA B52?</div>
                    <div class="calculation-input">
                        <input type="number" id="quizCalculation" placeholder="Enter answer in kg">
                        <button onclick="checkCalculation('quizCalculation', 12.28)" class="calculate-btn">Check Answer</button>
                    </div>
                    <div id="quizCalculationFeedback" class="quiz-feedback"></div>
                </div>

                <div class="navigation">
                    <button class="nav-button" onclick="previousModule()">‚Üê Previous Module</button>
                    <button class="nav-button" onclick="nextModule()">Next Module ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Module 5: Safe Work Practices & PPE -->
        <div class="module" id="module5">
            <div class="module-header">
                <div>
                    <h2>Safe Work Practices & PPE</h2>
                    <p>Personal protective equipment and safety procedures</p>
                </div>
                <div class="module-number">5</div>
            </div>
            <div class="module-content">
                <div class="objectives">
                    <h3>Learning Objectives</h3>
                    <ul>
                        <li>List required PPE for A2L handling</li>
                        <li>Describe safe recovery, charging, and evacuation procedures</li>
                        <li>Explain emergency procedures for leaks and fires</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Personal Protective Equipment (PPE)</h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0;">
                        <div class="highlight-box">
                            <h4>üëì Eye Protection</h4>
                            <ul style="margin-left: 20px;">
                                <li>Safety glasses (minimum)</li>
                                <li>Face shield for bulk transfer</li>
                                <li>Chemical splash goggles</li>
                            </ul>
                        </div>
                        <div class="highlight-box">
                            <h4>üß§ Hand Protection</h4>
                            <ul style="margin-left: 20px;">
                                <li>Chemical-resistant gloves</li>
                                <li>Insulated gloves for cold exposure</li>
                                <li>Cut-resistant for handling equipment</li>
                            </ul>
                        </div>
                        <div class="highlight-box">
                            <h4>üëï Body Protection</h4>
                            <ul style="margin-left: 20px;">
                                <li>Flame-resistant clothing</li>
                                <li>Long sleeves and pants</li>
                                <li>Coveralls for major service</li>
                            </ul>
                        </div>
                        <div class="highlight-box">
                            <h4>ü´Å Respiratory Protection</h4>
                            <ul style="margin-left: 20px;">
                                <li>Half-face respirator (confined spaces)</li>
                                <li>Escape respirator (emergency)</li>
                                <li>Supplied air (tank entry)</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Safe Work Procedures</h3>
                    
                    <h4>Before Starting Work</h4>
                    <ol style="margin-left: 20px;">
                        <li>Check all PPE and equipment</li>
                        <li>Verify ventilation is adequate</li>
                        <li>Test leak detection equipment</li>
                        <li>Review MSDS and emergency procedures</li>
                        <li>Notify others in the area</li>
                    </ol>
                    
                    <h4>During Service</h4>
                    <ul style="margin-left: 20px;">
                        <li>Always purge lines with nitrogen before brazing</li>
                        <li>Ventilate area before opening system</li>
                        <li>Use A2L-rated recovery and charging equipment</li>
                        <li>Monitor for leaks continuously</li>
                        <li>Eliminate ignition sources</li>
                    </ul>
                </div>

                <div class="highlight-box warning">
                    <h4>üö® Emergency Response Procedures</h4>
                    
                    <h5>For Refrigerant Leaks:</h5>
                    <ol style="margin-left: 20px;">
                        <li>Evacuate area immediately</li>
                        <li>Shut down all ignition sources</li>
                        <li>Increase ventilation if safe to do so</li>
                        <li>Monitor leak detection equipment</li>
                        <li>Do not re-enter until area is safe</li>
                    </ol>
                    
                    <h5>For Fire Involving A2L Refrigerants:</h5>
                    <ol style="margin-left: 20px;">
                        <li>Evacuate immediately</li>
                        <li>Call fire department</li>
                        <li>Use water spray to cool containers</li>
                        <li>Do not use CO2 extinguishers on refrigerant fires</li>
                        <li>Approach from upwind</li>
                    </ol>
                </div>

                <!-- Scenario Quiz -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Knowledge Check 5.1</h3>
                    </div>
                    <div class="quiz-question">You detect an A2L leak in a mechanical room. What is your immediate action?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-answer="a">a) Continue working to find the source</div>
                        <div class="quiz-option" data-answer="b">b) Shut down all ignition sources and ventilate</div>
                        <div class="quiz-option" data-answer="c">c) Ignore it if the concentration is low</div>
                        <div class="quiz-option" data-answer="d">d) Use a torch to locate the leak</div>
                    </div>
                    <div class="quiz-feedback">
                        <p><strong>Correct!</strong> Always shut down ignition sources first and increase ventilation to prevent accumulation of flammable vapors.</p>
                    </div>
                </div>

                <!-- Matching Activity -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Interactive Activity 5.2 - PPE Matching</h3>
                    </div>
                    <p>Match the PPE item to the hazard it addresses:</p>
                    <div class="drag-drop-container">
                        <div class="drag-items">
                            <h4>PPE Items</h4>
                            <div class="drag-item" draggable="true" data-value="Safety glasses">Safety glasses</div>
                            <div class="drag-item" draggable="true" data-value="Chemical gloves">Chemical-resistant gloves</div>
                            <div class="drag-item" draggable="true" data-value="Flame-resistant clothing">Flame-resistant clothing</div>
                        </div>
                        <div class="drop-zones">
                            <h4>Hazards</h4>
                            <div class="drop-zone" data-target="Eye injury">Eye injury from splashing</div>
                            <div class="drop-zone" data-target="Chemical exposure">Chemical exposure to skin</div>
                            <div class="drop-zone" data-target="Fire hazard">Fire hazard from ignition</div>
                        </div>
                    </div>
                </div>

                <div class="navigation">
                    <button class="nav-button" onclick="previousModule()">‚Üê Previous Module</button>
                    <button class="nav-button" onclick="nextModule()">Next Module ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Module 6: Servicing and Maintenance -->
        <div class="module" id="module6">
            <div class="module-header">
                <div>
                    <h2>Servicing and Maintenance</h2>
                    <p>Safe service procedures and maintenance practices</p>
                </div>
                <div class="module-number">6</div>
            </div>
            <div class="module-content">
                <div class="objectives">
                    <h3>Learning Objectives</h3>
                    <ul>
                        <li>Perform leak checks and repairs safely</li>
                        <li>Use appropriate tools and recovery machines</li>
                        <li>Document service and maintenance activities</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Leak Detection Methods</h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0;">
                        <div class="highlight-box">
                            <h4>üì± Electronic Detection</h4>
                            <ul style="margin-left: 20px;">
                                <li>A2L-rated electronic detectors</li>
                                <li>Infrared (IR) detectors</li>
                                <li>Heated diode sensors</li>
                                <li>Must be calibrated regularly</li>
                            </ul>
                        </div>
                        <div class="highlight-box">
                            <h4>ü´ß Soap Bubble Solution</h4>
                            <ul style="margin-left: 20px;">
                                <li>Safe for all refrigerants</li>
                                <li>Good for pinpointing leaks</li>
                                <li>Use commercial leak detection solution</li>
                                <li>Apply to suspected areas</li>
                            </ul>
                        </div>
                        <div class="highlight-box">
                            <h4>üí° Ultraviolet (UV) Detection</h4>
                            <ul style="margin-left: 20px;">
                                <li>UV dye added to system</li>
                                <li>Requires UV light to detect</li>
                                <li>Good for ongoing monitoring</li>
                                <li>Safe for A2L refrigerants</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <h3>Recovery and Charging Equipment</h3>
                    
                    <div class="highlight-box warning">
                        <h4>‚ö†Ô∏è Critical Requirement</h4>
                        <p><strong>Only use recovery machines specifically rated for A2L refrigerants!</strong></p>
                        <p>Standard recovery machines are not safe for mildly flammable refrigerants and may create ignition hazards.</p>
                    </div>
                    
                    <h4>A2L-Rated Equipment Features</h4>
                    <ul style="margin-left: 20px;">
                        <li>Explosion-proof electrical components</li>
                        <li>Enhanced leak detection</li>
                        <li>Automatic shutdown on leak detection</li>
                        <li>Purge capabilities</li>
                        <li>Proper certification markings</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Service Procedures</h3>
                    
                    <h4>Pre-Service Checklist</h4>
                    <ol style="margin-left: 20px;">
                        <li>Verify system type and refrigerant</li>
                        <li>Check equipment ratings (A2L compatible)</li>
                        <li>Ensure adequate ventilation</li>
                        <li>Test leak detection equipment</li>
                        <li>Review system documentation</li>
                    </ol>
                    
                    <h4>During Service</h4>
                    <ol style="margin-left: 20px;">
                        <li>Monitor for leaks continuously</li>
                        <li>Use proper recovery procedures</li>
                        <li>Purge lines before brazing</li>
                        <li>Pressure test with nitrogen only</li>
                        <li>Triple evacuate before charging</li>
                    </ol>
                    
                    <h4>Post-Service</h4>
                    <ol style="margin-left: 20px;">
                        <li>Perform comprehensive leak check</li>
                        <li>Verify system operation</li>
                        <li>Complete service documentation</li>
                        <li>Update system labels if needed</li>
                        <li>Clean up work area</li>
                    </ol>
                </div>

                <div class="highlight-box info">
                    <h4>üìã Documentation Requirements</h4>
                    <ul style="margin-left: 20px;">
                        <li>Service date and technician name</li>
                        <li>Work performed and parts replaced</li>
                        <li>Refrigerant quantities added/recovered</li>
                        <li>Leak check results</li>
                        <li>System pressures and temperatures</li>
                        <li>Any code compliance issues</li>
                    </ul>
                </div>

                <!-- Leak Rate Calculator -->
                <div class="calculation-widget">
                    <h4>üìè Leak Rate Calculator - A2L Systems</h4>
                    <p>Calculate acceptable leak rates and determine compliance with Canadian standards</p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <div class="calculation-input">
                                <label>System Refrigerant Charge (kg):</label>
                                <input type="number" id="systemCharge" placeholder="Enter total charge" min="0.1" step="0.1" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 5px;">
                            </div>
                            <div class="calculation-input">
                                <label>Refrigerant Type:</label>
                                <select id="leakRefrigerant" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 5px;">
                                    <option value="R-32">R-32</option>
                                    <option value="R-454B">R-454B</option>
                                    <option value="R-1234yf">R-1234yf</option>
                                    <option value="R-452B">R-452B</option>
                                </select>
                            </div>
                            <div class="calculation-input">
                                <label>Application Type:</label>
                                <select id="applicationType" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 5px;">
                                    <option value="residential">Residential (Split Systems)</option>
                                    <option value="commercial">Commercial (Package Units)</option>
                                    <option value="industrial">Industrial (Large Systems)</option>
                                    <option value="automotive">Automotive (Mobile A/C)</option>
                                </select>
                            </div>
                            <div class="calculation-input">
                                <label>Measured Leak Rate (g/year):</label>
                                <input type="number" id="measuredLeak" placeholder="Enter measured leak" min="0" step="1" style="width: 100%; padding: 8px; border: 2px solid #dee2e6; border-radius: 5px;">
                            </div>
                            <button class="calculate-btn" onclick="calculateLeakRate()" style="width: 100%;">Analyze Leak Rate</button>
                        </div>
                        <div id="leakResult" style="background: #f8f9fa; padding: 15px; border-radius: 5px; display: none;">
                            <h5>Leak Rate Analysis:</h5>
                            <div id="leakDetails"></div>
                            <div id="leakCompliance" style="margin-top: 10px; padding: 10px; border-radius: 5px;"></div>
                            <div style="margin-top: 10px; font-size: 0.9em;">
                                <strong>Recommended Actions:</strong>
                                <div id="leakActions"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- True/False Quiz -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Knowledge Check 6.1</h3>
                    </div>
                    <div class="quiz-question">Only recovery machines rated for A2L refrigerants can be used for R-32.</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-answer="true">True</div>
                        <div class="quiz-option" data-answer="false">False</div>
                    </div>
                    <div class="quiz-feedback">
                        <p><strong>Correct!</strong> A2L-rated recovery equipment is mandatory for safety reasons and code compliance.</p>
                    </div>
                </div>

                <!-- Short Answer -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Knowledge Check 6.2</h3>
                    </div>
                    <div class="quiz-question">List three steps to follow if your leak detector alarms during service:</div>
                    <textarea id="shortAnswer1" rows="4" style="width: 100%; padding: 10px; border: 2px solid #dee2e6; border-radius: 5px; margin: 10px 0;" placeholder="Enter your answer here..."></textarea>
                    <button onclick="checkShortAnswer()" class="calculate-btn">Submit Answer</button>
                    <div id="shortAnswerFeedback" class="quiz-feedback"></div>
                </div>

                <div class="navigation">
                    <button class="nav-button" onclick="previousModule()">‚Üê Previous Module</button>
                    <button class="nav-button" onclick="nextModule()">Next Module ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Module 7: Case Studies -->
        <div class="module" id="module7">
            <div class="module-header">
                <div>
                    <h2>Case Studies and Real-World Scenarios</h2>
                    <p>Apply knowledge to practical field situations</p>
                </div>
                <div class="module-number">7</div>
            </div>
            <div class="module-content">
                <div class="objectives">
                    <h3>Learning Objectives</h3>
                    <ul>
                        <li>Apply course knowledge to practical field situations</li>
                        <li>Troubleshoot common A2L system issues</li>
                        <li>Make code-compliant decisions in challenging environments</li>
                    </ul>
                </div>

                <div class="content-section">
                    <h3>Case Study 1: High Pressure Trip with Refrigerant Odor</h3>
                    
                    <div class="highlight-box">
                        <h4>üìû Service Call Scenario</h4>
                        <p><strong>Situation:</strong> A customer's rooftop R-454B unit is tripping on high pressure. Upon arrival, you notice a faint refrigerant odor near the unit.</p>
                        
                        <p><strong>Unit Details:</strong></p>
                        <ul style="margin-left: 20px;">
                            <li>10-ton rooftop unit with R-454B</li>
                            <li>Installed 6 months ago</li>
                            <li>Located on restaurant roof</li>
                            <li>Mechanical room below with kitchen exhaust fans</li>
                        </ul>
                    </div>
                    
                    <h4>Troubleshooting Sequence</h4>
                    <ol style="margin-left: 20px;">
                        <li><strong>Safety First:</strong> Don PPE, shut down unit, increase ventilation</li>
                        <li><strong>Initial Assessment:</strong> Use A2L-rated leak detector to confirm leak</li>
                        <li><strong>Locate Source:</strong> Systematic inspection of all joints and connections</li>
                        <li><strong>Isolate System:</strong> Recover refrigerant using A2L-rated equipment</li>
                        <li><strong>Repair:</strong> Replace faulty component, pressure test with nitrogen</li>
                        <li><strong>Evacuation:</strong> Triple evacuate to proper vacuum levels</li>
                        <li><strong>Recharge:</strong> Add refrigerant per manufacturer specifications</li>
                        <li><strong>Testing:</strong> Comprehensive leak check and system operation test</li>
                    </ol>
                </div>

                <div class="content-section">
                    <h3>Case Study 2: Installation Code Violations</h3>
                    
                    <p>Examine this installation photo and identify all code violations:</p>
                    
                    <!-- Simulated installation photo with violations -->
                    <div style="background: #f8f9fa; border: 2px solid #dee2e6; border-radius: 10px; padding: 20px; margin: 20px 0;">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div style="background: #fff; border-radius: 8px; padding: 15px; border: 1px solid #ccc;">
                                <h5>Condensing Unit</h5>
                                <ul style="margin-left: 20px; font-size: 0.9em;">
                                    <li>‚ùå No A2L warning label visible</li>
                                    <li>‚úÖ Proper clearances maintained</li>
                                    <li>‚ùå Service valves have soldered connections</li>
                                    <li>‚úÖ Electrical disconnect properly located</li>
                                </ul>
                            </div>
                            <div style="background: #fff; border-radius: 8px; padding: 15px; border: 1px solid #ccc;">
                                <h5>Refrigerant Storage Area</h5>
                                <ul style="margin-left: 20px; font-size: 0.9em;">
                                    <li>‚ùå R-32 cylinder stored near electrical panel</li>
                                    <li>‚ùå Cylinder not secured upright</li>
                                    <li>‚úÖ Fire extinguisher present</li>
                                    <li>‚ùå No ventilation in storage area</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Case Study Quiz -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Knowledge Check 7.1</h3>
                    </div>
                    <div class="quiz-question">For the high pressure trip scenario, what should be your FIRST action upon arrival?</div>
                    <div class="quiz-options">
                        <div class="quiz-option" data-answer="a">a) Check refrigerant levels</div>
                        <div class="quiz-option" data-answer="b">b) Start the unit to diagnose the problem</div>
                        <div class="quiz-option" data-answer="c">c) Don PPE and ensure area safety</div>
                        <div class="quiz-option" data-answer="d">d) Call for backup immediately</div>
                    </div>
                    <div class="quiz-feedback">
                        <p><strong>Correct!</strong> Safety is always the first priority. Don PPE and ensure the area is safe before beginning any diagnostic work.</p>
                    </div>
                </div>

                <!-- Multiple Select Quiz -->
                <div class="quiz-container">
                    <div class="quiz-header">
                        <h3>Knowledge Check 7.2</h3>
                    </div>
                    <div class="quiz-question">Select ALL code violations from the installation photo above:</div>
                    <div class="quiz-options multi-select">
                        <div class="quiz-option" data-answer="violation1">No A2L warning label</div>
                        <div class="quiz-option" data-answer="violation2">Soldered service valve connections</div>
                        <div class="quiz-option" data-answer="violation3">Cylinder stored near electrical panel</div>
                        <div class="quiz-option" data-answer="violation4">Cylinder not secured upright</div>
                        <div class="quiz-option" data-answer="violation5">No ventilation in storage area</div>
                        <div class="quiz-option" data-answer="correct1">Proper clearances maintained</div>
                    </div>
                    <div class="quiz-feedback">
                        <p><strong>Violations identified:</strong> Missing A2L label, soldered connections, improper cylinder storage, and inadequate ventilation are all serious code violations.</p>
                    </div>
                </div>

                <div class="navigation">
                    <button class="nav-button" onclick="previousModule()">‚Üê Previous Module</button>
                    <button class="nav-button" onclick="nextModule()">Final Assessment ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Module 8: Final Assessment -->
        <div class="module" id="module8">
            <div class="module-header">
                <div>
                    <h2>Final Assessment & Certificate</h2>
                    <p>Demonstrate your A2L refrigerant safety knowledge</p>
                </div>
                <div class="module-number">8</div>
            </div>
            <div class="module-content">
                <div class="objectives">
                    <h3>Assessment Objectives</h3>
                    <ul>
                        <li>Demonstrate understanding of all course modules</li>
                        <li>Achieve a passing score of 80% to earn certificate</li>
                        <li>Apply knowledge to real-world scenarios</li>
                    </ul>
                </div>

                <div class="highlight-box info">
                    <h4>üìã Assessment Information</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Questions:</strong> 25 randomized questions</li>
                        <li><strong>Time Limit:</strong> 60 minutes</li>
                        <li><strong>Passing Score:</strong> 80% (20 correct answers)</li>
                        <li><strong>Question Types:</strong> Multiple choice, scenarios, calculations, drag-and-drop</li>
                        <li><strong>Attempts:</strong> 3 attempts allowed</li>
                    </ul>
                </div>

                <div id="assessmentContainer" style="display: none;">
                    <div class="quiz-container">
                        <div class="quiz-header">
                            <h3 id="questionCounter">Question 1 of 25</h3>
                        </div>
                        <div id="assessmentQuestion" class="quiz-question"></div>
                        <div id="assessmentOptions" class="quiz-options"></div>
                        <div class="navigation" style="border-top: none; padding-top: 20px;">
                            <button class="nav-button" id="prevQuestion" onclick="previousQuestion()" disabled>‚Üê Previous</button>
                            <button class="nav-button" id="nextQuestion" onclick="nextQuestion()">Next ‚Üí</button>
                        </div>
                    </div>
                </div>

                <div id="assessmentResults" style="display: none;">
                    <div class="highlight-box success">
                        <h3>üéâ Assessment Complete!</h3>
                        <div id="scoreDisplay"></div>
                        <div id="passFailMessage"></div>
                    </div>
                </div>

                <div id="nameInputSection" style="display: none;">
                    <div class="highlight-box success">
                        <h3>üéâ Congratulations! You've Passed the Assessment</h3>
                        <p>Please enter your name to generate your certificate:</p>
                        <div style="margin: 20px 0;">
                            <input type="text" id="certificateName" placeholder="Enter your full name" 
                                   style="width: 300px; padding: 12px; border: 2px solid #2a5298; border-radius: 8px; font-size: 1.1em; text-align: center;">
                        </div>
                        <button class="nav-button" onclick="generatePersonalizedCertificate()" style="background: linear-gradient(135deg, #28a745, #20c997);">
                            Generate My Certificate
                        </button>
                    </div>
                </div>

                <div id="certificateSection" style="display: none;">
                    <div class="certificate-container" id="certificateContainer">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <div style="text-align: left;">
                                <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMTAwIDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8dGV4dCB4PSI1IiB5PSIyNSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE4IiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0iIzFlM2M3MiI+TEFSSzwvdGV4dD4KPHRleHQgeD0iNTUiIHk9IjI1IiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZpbGw9IiMyYTUyOTgiPkxhYnM8L3RleHQ+Cjwvc3ZnPgo=" alt="LARK Labs Logo">
                                <div style="font-size: 0.8em; color: #666; margin-top: 2px;">Professional HVAC Training</div>
                            </div>
                            <div style="text-align: right; font-size: 0.8em; color: #666;">
                                <div>Certificate ID: <span id="certificateId"></span></div>
                                <div>Issued: <span id="completionDate"></span></div>
                            </div>
                        </div>
                        
                        <div class="certificate-header" style="font-size: 1.6em; margin-bottom: 15px;">üèÜ Certificate of Completion</div>
                        <div class="certificate-body">
                            <h3 style="color: #1e3c72; margin-bottom: 15px; font-size: 1.3em;">Canadian A2L Refrigerant Safety Certificate</h3>
                            <p style="font-size: 1em; margin-bottom: 8px;">This is to certify that</p>
                            <h2 id="studentName" style="color: #2a5298; border-bottom: 3px solid #2a5298; display: inline-block; padding-bottom: 6px; margin: 15px 0; font-size: 1.8em;">Student Name</h2>
                            <p style="font-size: 1em; margin-bottom: 15px;">has successfully completed the Canadian A2L Refrigerant Safety Certificate Course<br>
                            with a passing score and demonstrated competency in:</p>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin: 18px 0; text-align: left; font-size: 0.9em;">
                                <div>
                                    <div style="margin: 6px 0;">‚úì A2L refrigerant properties and hazards</div>
                                    <div style="margin: 6px 0;">‚úì Canadian regulatory requirements (CSA B52, B149.1-25, TSSA)</div>
                                    <div style="margin: 6px 0;">‚úì Safe handling and installation practices</div>
                                </div>
                                <div>
                                    <div style="margin: 6px 0;">‚úì System design and maintenance procedures</div>
                                    <div style="margin: 6px 0;">‚úì Emergency response protocols</div>
                                    <div style="margin: 6px 0;">‚úì Code compliance and documentation</div>
                                </div>
                            </div>
                            <p style="margin-top: 20px; font-size: 0.9em;">This certificate demonstrates the holder's knowledge of safe practices for working with mildly flammable A2L refrigerants in accordance with Canadian codes and standards.</p>
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 20px; padding-top: 15px; border-top: 2px solid #e9ecef;">
                            <div style="text-align: center;">
                                <div style="border-top: 2px solid #2a5298; width: 200px; margin-bottom: 5px;"></div>
                                <div style="font-family: 'Brush Script MT', cursive, 'Dancing Script', cursive; font-size: 1.4em; color: #2a5298; margin-bottom: 3px;">Michael J Kapin</div>
                                <div style="font-weight: bold; color: #1e3c72; font-size: 0.9em;">LARK Labs</div>
                                <div style="font-size: 0.8em; color: #666;">Professional HVAC Training Provider</div>
                            </div>
                            <div style="text-align: center; font-size: 0.85em; color: #666;">
                                <div><strong>Course Duration:</strong> 6-8 hours</div>
                                <div><strong>Passing Score:</strong> 80%</div>
                                <div><strong>Your Score:</strong> <span id="certificateScore"></span>%</div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin-top: 20px; display: flex; gap: 15px; justify-content: center;">
                            <button class="download-certificate" onclick="printCertificate()">üñ®Ô∏è Print Certificate</button>
                            <button class="download-certificate" onclick="downloadCertificate()">üìÑ Download PDF</button>
                        </div>
                    </div>
                </div>

                <div id="startAssessment">
                    <div style="text-align: center; margin: 40px 0;">
                        <h3>Ready to Begin Your Final Assessment?</h3>
                        <p>Make sure you've completed all previous modules before starting.</p>
                        <button class="nav-button" onclick="startFinalAssessment()" style="font-size: 1.2em; padding: 20px 40px;">üöÄ Start Assessment</button>
                    </div>
                </div>

                <div class="navigation">
                    <button class="nav-button" onclick="previousModule()">‚Üê Previous Module</button>
                    <button class="nav-button" disabled>Assessment Complete</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Course state management
        let currentModule = 1;
        let moduleProgress = {1: false, 2: false, 3: false, 4: false, 5: false, 6: false, 7: false, 8: false};
        let assessmentQuestions = [];
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let assessmentScore = 0;

        // Initialize course
        document.addEventListener('DOMContentLoaded', function() {
            initializeModuleNavigation();
            updateProgress();
            setupInteractiveElements();
            generateAssessmentQuestions();
        });

        function initializeModuleNavigation() {
            const moduleNavGrid = document.getElementById('moduleNavGrid');
            const modules = [
                {title: 'Introduction to A2L', icon: '1'},
                {title: 'Regulatory Requirements', icon: '2'},
                {title: 'Properties & Hazards', icon: '3'},
                {title: 'System Design', icon: '4'},
                {title: 'Safe Work Practices', icon: '5'},
                {title: 'Servicing & Maintenance', icon: '6'},
                {title: 'Case Studies', icon: '7'},
                {title: 'Final Assessment', icon: '8'}
            ];

            modules.forEach((module, index) => {
                const moduleItem = document.createElement('div');
                moduleItem.className = 'module-nav-item';
                if (index + 1 === currentModule) moduleItem.classList.add('current');
                
                moduleItem.innerHTML = `
                    <div class="module-icon">${module.icon}</div>
                    <div>
                        <div style="font-weight: 600;">${module.title}</div>
                        <div style="font-size: 0.9em; color: #666;">Module ${index + 1}</div>
                    </div>
                `;
                
                moduleItem.onclick = () => goToModule(index + 1);
                moduleNavGrid.appendChild(moduleItem);
            });
        }

        function goToModule(moduleNumber) {
            // Hide current module
            document.getElementById(`module${currentModule}`).classList.remove('active');
            
            // Show new module
            currentModule = moduleNumber;
            document.getElementById(`module${currentModule}`).classList.add('active');
            
            // Update navigation
            updateModuleNavigation();
            updateProgress();
            
            // Scroll to top
            window.scrollTo(0, 0);
        }

        function nextModule() {
            if (currentModule < 8) {
                moduleProgress[currentModule] = true;
                goToModule(currentModule + 1);
            }
        }

        function previousModule() {
            if (currentModule > 1) {
                goToModule(currentModule - 1);
            }
        }

        function updateModuleNavigation() {
            const navItems = document.querySelectorAll('.module-nav-item');
            navItems.forEach((item, index) => {
                item.classList.remove('current', 'completed');
                if (index + 1 === currentModule) {
                    item.classList.add('current');
                } else if (moduleProgress[index + 1]) {
                    item.classList.add('completed');
                    item.querySelector('.module-icon').textContent = '‚úì';
                }
            });
        }

        function updateProgress() {
            const completedModules = Object.values(moduleProgress).filter(Boolean).length;
            const progressPercent = (completedModules / 8) * 100;
            
            document.getElementById('progressFill').style.width = progressPercent + '%';
            document.getElementById('progressText').textContent = 
                `Module ${currentModule} of 8 - ${Math.round(progressPercent)}% Complete`;
        }

        function setupInteractiveElements() {
            // Quiz option click handlers
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('quiz-option')) {
                    // Prevent double-clicking issues
                    if (e.target.classList.contains('correct') || e.target.classList.contains('incorrect')) {
                        return;
                    }
                    handleQuizAnswer(e.target);
                }
                
                if (e.target.classList.contains('hotspot-area')) {
                    handleHotspotClick(e.target);
                }
            });

            // Drag and drop setup
            setupDragAndDrop();
            
            // Input field handlers
            const roomVolumeInput = document.getElementById('roomVolume');
            if (roomVolumeInput) {
                roomVolumeInput.addEventListener('input', function() {
                    if (this.value) {
                        calculateCharge();
                    }
                });
            }
        }

        function handleQuizAnswer(option) {
            const container = option.closest('.quiz-container');
            if (!container) return;
            
            const options = container.querySelectorAll('.quiz-option');
            const feedback = container.querySelector('.quiz-feedback');
            
            // Clear previous selections
            options.forEach(opt => opt.classList.remove('selected', 'correct', 'incorrect'));
            
            // Mark selection
            option.classList.add('selected');
            
            // Define correct answers for each quiz
            const correctAnswerMap = {
                // Module 1
                'Which of these is an A2L refrigerant?': 'c',
                // Module 2
                'code sections must you reference': 'c',
                // Module 3
                'A2L refrigerants can be stored in the same area': 'false',
                // Module 4
                'Which of the following connection methods is NOT permitted': 'a',
                'What is the maximum allowable R-32 charge': 'calculation',
                // Module 5
                'You detect an A2L leak in a mechanical room': 'b',
                // Module 6
                'Only recovery machines rated for A2L refrigerants': 'true',
                // Module 7
                'what should be your FIRST action upon arrival': 'c'
            };
            
            // Get the question text to determine correct answer
            const questionElement = container.querySelector('.quiz-question');
            if (!questionElement) return;
            
            const questionText = questionElement.textContent;
            let correctAnswer = null;
            
            // Find matching question
            for (const [key, value] of Object.entries(correctAnswerMap)) {
                if (questionText.includes(key)) {
                    correctAnswer = value;
                    break;
                }
            }
            
            // Determine if answer is correct
            const isCorrect = option.dataset.answer === correctAnswer;
            
            if (feedback) {
                if (isCorrect) {
                    option.classList.add('correct');
                    feedback.classList.add('show', 'correct');
                } else {
                    option.classList.add('incorrect');
                    feedback.classList.add('show', 'incorrect');
                    // Update incorrect feedback if it exists
                    const incorrectText = feedback.querySelector('p');
                    if (incorrectText && incorrectText.textContent.includes('Correct!')) {
                        feedback.innerHTML = '<p><strong>Incorrect.</strong> Please review the material and try again.</p>';
                        feedback.classList.remove('correct');
                        feedback.classList.add('incorrect');
                    }
                }
            }
        }

        function handleHotspotClick(area) {
            const isCorrect = area.dataset.correct === 'true';
            const feedback = document.getElementById('hotspotFeedback');
            
            if (!feedback) return; // Safety check
            
            if (isCorrect) {
                area.style.borderColor = '#28a745';
                area.style.backgroundColor = '#d4edda';
                feedback.innerHTML = '<p><strong>Correct!</strong> This is the proper storage area - well ventilated and away from ignition sources.</p>';
                feedback.classList.remove('incorrect');
                feedback.classList.add('show', 'correct');
            } else {
                area.style.borderColor = '#dc3545';
                area.style.backgroundColor = '#f8d7da';
                feedback.innerHTML = '<p><strong>Incorrect.</strong> A2L cylinders should not be stored near heat sources.</p>';
                feedback.classList.remove('correct');
                feedback.classList.add('show', 'incorrect');
            }
        }

        function setupDragAndDrop() {
            const dragItems = document.querySelectorAll('.drag-item');
            const dropZones = document.querySelectorAll('.drop-zone');

            dragItems.forEach(item => {
                item.addEventListener('dragstart', function(e) {
                    e.dataTransfer.setData('text/plain', e.target.dataset.value);
                });
            });

            dropZones.forEach(zone => {
                zone.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    zone.classList.add('drag-over');
                });

                zone.addEventListener('dragleave', function(e) {
                    zone.classList.remove('drag-over');
                });

                zone.addEventListener('drop', function(e) {
                    e.preventDefault();
                    const data = e.dataTransfer.getData('text/plain');
                    const target = zone.dataset.target;
                    
                    // Simple matching logic (would be enhanced in production)
                    const matches = {
                        'R-32': 'A2L',
                        'R-410A': 'A1',
                        'R-290': 'A3',
                        'Safety glasses': 'Eye injury',
                        'Chemical gloves': 'Chemical exposure',
                        'Flame-resistant clothing': 'Fire hazard'
                    };
                    
                    if (matches[data] && target.includes(matches[data])) {
                        zone.textContent = data;
                        zone.classList.add('filled');
                        zone.classList.remove('drag-over');
                        
                        // Hide the dragged item
                        const draggedItem = Array.from(dragItems).find(item => item.dataset.value === data);
                        if (draggedItem) draggedItem.style.display = 'none';
                    } else {
                        zone.classList.remove('drag-over');
                    }
                });
            });
        }

        function calculateCharge() {
            const volume = parseFloat(document.getElementById('roomVolume').value);
            if (volume && volume > 0) {
                const maxCharge = volume * 0.307;
                document.getElementById('chargeResult').textContent = maxCharge.toFixed(2) + ' kg';
                document.getElementById('chargeExplanation').textContent = 
                    `For a ${volume} m¬≥ room, the maximum R-32 charge is ${maxCharge.toFixed(2)} kg without additional safety measures.`;
            }
        }

        function calculateEnhancedCharge() {
            const volume = parseFloat(document.getElementById('roomVolume').value);
            const refrigerant = document.getElementById('chargeRefrigerant').value;
            
            if (!volume || volume <= 0) {
                alert('Please enter a valid room volume');
                return;
            }
            
            const chargeLimits = {
                'R-32': 0.307,
                'R-454B': 0.320,
                'R-1234yf': 0.290,
                'R-452B': 0.315
            };
            
            const limit = chargeLimits[refrigerant];
            const maxCharge = volume * limit;
            
            document.getElementById('chargeResult').textContent = maxCharge.toFixed(2) + ' kg';
            document.getElementById('chargeExplanation').innerHTML = 
                `<strong>Analysis:</strong> For a ${volume} m¬≥ room with ${refrigerant}, the maximum charge is ${maxCharge.toFixed(2)} kg.<br>
                <strong>Note:</strong> Exceeding this limit requires enhanced ventilation and leak detection per CSA B52-22.`;
        }

        function calculateCalibration() {
            const refrigerant = document.getElementById('calibRefrigerant').value;
            const detectionLevel = parseFloat(document.getElementById('detectionLevel').value);
            
            const lflData = {
                'R-32': { lfl: 14.4, ignitionEnergy: '15-20 mJ' },
                'R-454B': { lfl: 15.2, ignitionEnergy: '18-25 mJ' },
                'R-1234yf': { lfl: 6.2, ignitionEnergy: '3-5 mJ' },
                'R-452B': { lfl: 16.1, ignitionEnergy: '12-18 mJ' }
            };
            
            const data = lflData[refrigerant];
            const calibrationGas = (data.lfl * detectionLevel / 100).toFixed(2);
            
            document.getElementById('calibrationResult').style.display = 'block';
            document.getElementById('calibrationDetails').innerHTML = `
                <div><strong>Refrigerant:</strong> ${refrigerant}</div>
                <div><strong>LFL:</strong> ${data.lfl}% by volume</div>
                <div><strong>Detection Level:</strong> ${detectionLevel}% of LFL</div>
                <div><strong>Calibration Gas Concentration:</strong> ${calibrationGas}% by volume</div>
                <div><strong>Ignition Energy:</strong> ${data.ignitionEnergy}</div>
                <div style="margin-top: 10px; color: #d63384;"><strong>‚ö†Ô∏è Safety Note:</strong> Calibrate detectors monthly and before each use with A2L refrigerants.</div>
            `;
        }

        function calculatePT() {
            const refrigerant = document.getElementById('ptRefrigerant').value;
            const knownValue = document.querySelector('input[name="knownValue"]:checked').value;
            const inputValue = parseFloat(document.getElementById('ptInput').value);
            
            if (!inputValue && inputValue !== 0) {
                alert('Please enter a value');
                return;
            }
            
            // Simplified Antoine equation coefficients for saturation pressure/temperature
            const coefficients = {
                'R-32': { A: 8.3617, B: 1101.4, C: -42.45 },
                'R-454B': { A: 8.1234, B: 1205.8, C: -35.22 },
                'R-1234yf': { A: 8.0156, B: 1182.5, C: -38.15 },
                'R-452B': { A: 8.2145, B: 1198.2, C: -36.8 }
            };
            
            const operatingRanges = {
                'R-32': 'Low: 4-8 bar, High: 18-28 bar',
                'R-454B': 'Low: 3-7 bar, High: 16-24 bar',
                'R-1234yf': 'Low: 2-5 bar, High: 12-20 bar',
                'R-452B': 'Low: 4-8 bar, High: 19-26 bar'
            };
            
            const coeff = coefficients[refrigerant];
            let resultTemp, resultPressure;
            
            if (knownValue === 'temperature') {
                // Calculate pressure from temperature using Antoine equation
                const tempK = inputValue + 273.15;
                resultPressure = Math.exp(coeff.A - coeff.B / (tempK + coeff.C));
                resultTemp = inputValue;
            } else {
                // Calculate temperature from pressure
                const tempK = coeff.B / (coeff.A - Math.log(inputValue)) - coeff.C;
                resultTemp = tempK - 273.15;
                resultPressure = inputValue;
            }
            
            document.getElementById('ptResult').style.display = 'block';
            document.getElementById('ptDetails').innerHTML = `
                <div><strong>Refrigerant:</strong> ${refrigerant}</div>
                <div><strong>Saturation Temperature:</strong> ${resultTemp.toFixed(1)}¬∞C</div>
                <div><strong>Saturation Pressure:</strong> ${resultPressure.toFixed(2)} bar</div>
            `;
            
            document.getElementById('operatingPressures').innerHTML = `
                <div>${refrigerant}: ${operatingRanges[refrigerant]}</div>
            `;
        }

        function calculateLeakRate() {
            const systemCharge = parseFloat(document.getElementById('systemCharge').value);
            const refrigerant = document.getElementById('leakRefrigerant').value;
            const applicationType = document.getElementById('applicationType').value;
            const measuredLeak = parseFloat(document.getElementById('measuredLeak').value);
            
            if (!systemCharge || !measuredLeak) {
                alert('Please enter system charge and measured leak rate');
                return;
            }
            
            // Acceptable leak rates by application type (% per year)
            const acceptableRates = {
                'residential': 3,    // 3% per year for residential
                'commercial': 5,     // 5% per year for commercial
                'industrial': 10,    // 10% per year for industrial
                'automotive': 15     // 15% per year for automotive
            };
            
            const maxAcceptableLeak = (systemCharge * 1000 * acceptableRates[applicationType] / 100); // Convert to grams
            const leakPercentage = (measuredLeak / (systemCharge * 1000)) * 100;
            const isCompliant = measuredLeak <= maxAcceptableLeak;
            
            document.getElementById('leakResult').style.display = 'block';
            document.getElementById('leakDetails').innerHTML = `
                <div><strong>System Charge:</strong> ${systemCharge} kg</div>
                <div><strong>Measured Leak Rate:</strong> ${measuredLeak} g/year (${leakPercentage.toFixed(2)}%/year)</div>
                <div><strong>Application Type:</strong> ${applicationType}</div>
                <div><strong>Maximum Acceptable:</strong> ${maxAcceptableLeak.toFixed(0)} g/year (${acceptableRates[applicationType]}%/year)</div>
            `;
            
            const complianceDiv = document.getElementById('leakCompliance');
            if (isCompliant) {
                complianceDiv.style.background = '#d4edda';
                complianceDiv.style.color = '#155724';
                complianceDiv.innerHTML = '‚úÖ <strong>COMPLIANT:</strong> Leak rate is within acceptable limits';
            } else {
                complianceDiv.style.background = '#f8d7da';
                complianceDiv.style.color = '#721c24';
                complianceDiv.innerHTML = '‚ùå <strong>NON-COMPLIANT:</strong> Leak rate exceeds acceptable limits';
            }
            
            let actions = '';
            if (isCompliant) {
                actions = `
                    <ul style="margin-left: 20px;">
                        <li>Continue regular monitoring</li>
                        <li>Document leak rate in service log</li>
                        <li>Schedule next leak check per manufacturer guidelines</li>
                    </ul>
                `;
            } else {
                actions = `
                    <ul style="margin-left: 20px;">
                        <li><strong>Immediate:</strong> Locate and repair leak source</li>
                        <li><strong>Required:</strong> Recover refrigerant using A2L-rated equipment</li>
                        <li><strong>Safety:</strong> Ensure adequate ventilation during repair</li>
                        <li><strong>Compliance:</strong> Report to authorities if required</li>
                        <li><strong>Follow-up:</strong> Re-test after repairs</li>
                    </ul>
                `;
            }
            
            document.getElementById('leakActions').innerHTML = actions;
        }

        function diagnoseSystem() {
            const outdoorTemp = parseFloat(document.getElementById('outdoorTemp').value);
            const indoorTemp = parseFloat(document.getElementById('indoorTemp').value);
            const refrigerant = document.getElementById('diagnosticRefrigerant').value;
            const suctionPressure = parseFloat(document.getElementById('suctionPressure').value);
            const dischargePressure = parseFloat(document.getElementById('dischargePressure').value);
            
            if (!outdoorTemp || !indoorTemp || !suctionPressure || !dischargePressure) {
                alert('Please enter all operating conditions and pressures');
                return;
            }
            
            // Expected pressure ranges based on typical conditions
            const expectedRanges = {
                'R-32': {
                    lowSide: { min: 4, max: 8, ideal: 6 },
                    highSide: { min: 18, max: 28, ideal: 22 }
                },
                'R-454B': {
                    lowSide: { min: 3, max: 7, ideal: 5 },
                    highSide: { min: 16, max: 24, ideal: 20 }
                },
                'R-1234yf': {
                    lowSide: { min: 2, max: 5, ideal: 3.5 },
                    highSide: { min: 12, max: 20, ideal: 16 }
                },
                'R-452B': {
                    lowSide: { min: 4, max: 8, ideal: 6 },
                    highSide: { min: 19, max: 26, ideal: 22 }
                }
            };
            
            const expected = expectedRanges[refrigerant];
            
            // Adjust expected values based on outdoor temperature
            const tempFactor = (outdoorTemp - 25) * 0.1; // Rough adjustment factor
            const expectedLow = expected.lowSide.ideal + tempFactor;
            const expectedHigh = expected.highSide.ideal + tempFactor * 2;
            
            // Analyze pressures
            let lowSideStatus = 'Normal';
            let highSideStatus = 'Normal';
            let overallStatus = 'Normal';
            let statusColor = '#28a745';
            
            if (suctionPressure < expected.lowSide.min) {
                lowSideStatus = 'Low';
                overallStatus = 'Attention Required';
                statusColor = '#ffc107';
            } else if (suctionPressure > expected.lowSide.max) {
                lowSideStatus = 'High';
                overallStatus = 'Attention Required';
                statusColor = '#ffc107';
            }
            
            if (dischargePressure < expected.highSide.min) {
                highSideStatus = 'Low';
                overallStatus = 'Issue Detected';
                statusColor = '#dc3545';
            } else if (dischargePressure > expected.highSide.max) {
                highSideStatus = 'High';
                overallStatus = 'Issue Detected';
                statusColor = '#dc3545';
            }
            
            document.getElementById('diagnosticResult').style.display = 'block';
            
            const summaryDiv = document.getElementById('diagnosticSummary');
            summaryDiv.style.background = statusColor === '#28a745' ? '#d4edda' : statusColor === '#ffc107' ? '#fff3cd' : '#f8d7da';
            summaryDiv.style.color = statusColor === '#28a745' ? '#155724' : statusColor === '#ffc107' ? '#856404' : '#721c24';
            summaryDiv.innerHTML = `<strong>System Status: ${overallStatus}</strong>`;
            
            document.getElementById('comparisonTable').innerHTML = `
                <table style="width: 100%; border-collapse: collapse; font-size: 0.9em;">
                    <tr style="background: #f8f9fa;">
                        <th style="padding: 8px; border: 1px solid #dee2e6;">Parameter</th>
                        <th style="padding: 8px; border: 1px solid #dee2e6;">Expected</th>
                        <th style="padding: 8px; border: 1px solid #dee2e6;">Actual</th>
                        <th style="padding: 8px; border: 1px solid #dee2e6;">Status</th>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #dee2e6;">Suction Pressure</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6;">${expectedLow.toFixed(1)} bar</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6;">${suctionPressure} bar</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; color: ${lowSideStatus === 'Normal' ? '#28a745' : '#dc3545'};">${lowSideStatus}</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #dee2e6;">Discharge Pressure</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6;">${expectedHigh.toFixed(1)} bar</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6;">${dischargePressure} bar</td>
                        <td style="padding: 8px; border: 1px solid #dee2e6; color: ${highSideStatus === 'Normal' ? '#28a745' : '#dc3545'};">${highSideStatus}</td>
                    </tr>
                </table>
            `;
            
            // Generate recommendations
            let recommendations = [];
            
            if (lowSideStatus === 'Low' && highSideStatus === 'Low') {
                recommendations.push('Possible refrigerant undercharge - check for leaks');
                recommendations.push('Verify expansion valve operation');
            } else if (lowSideStatus === 'High' && highSideStatus === 'High') {
                recommendations.push('Possible refrigerant overcharge');
                recommendations.push('Check for restricted airflow across condenser');
            } else if (lowSideStatus === 'Low' && highSideStatus === 'High') {
                recommendations.push('Possible restriction in system');
                recommendations.push('Check expansion valve and filter drier');
            } else if (lowSideStatus === 'High' && highSideStatus === 'Low') {
                recommendations.push('Possible compressor efficiency issues');
                recommendations.push('Check compressor performance');
            } else {
                recommendations.push('System pressures within normal range');
                recommendations.push('Continue monitoring during operation');
            }
            
            document.getElementById('recommendationsList').innerHTML = `
                <ul style="margin-left: 20px;">
                    ${recommendations.map(rec => `<li>${rec}</li>`).join('')}
                </ul>
            `;
            
            document.getElementById('safetyNotes').innerHTML = `
                <ul style="margin-left: 20px; font-size: 0.9em;">
                    <li>Use only A2L-rated recovery equipment for service</li>
                    <li>Ensure adequate ventilation before opening system</li>
                    <li>Monitor for leaks with A2L-rated detectors</li>
                    <li>Follow lockout/tagout procedures</li>
                    <li>Keep fire extinguisher readily available</li>
                </ul>
            `;
        }

        function checkFillBlank(inputId, correctAnswer) {
            const input = document.getElementById(inputId);
            const feedback = document.getElementById(inputId + 'Feedback');
            
            if (!input || !feedback) {
                console.error('Missing input or feedback element:', inputId);
                return;
            }
            
            const userAnswer = input.value.toLowerCase().trim();
            
            feedback.classList.remove('show', 'correct', 'incorrect'); // Reset classes
            
            if (userAnswer.includes('flammable')) {
                feedback.innerHTML = '<p><strong>Correct!</strong> A2L systems require flammable refrigerant warning labels.</p>';
                feedback.classList.add('show', 'correct');
            } else {
                feedback.innerHTML = '<p><strong>Incorrect.</strong> The answer is "flammable refrigerant".</p>';
                feedback.classList.add('show', 'incorrect');
            }
        }

        function checkCalculation(inputId, correctAnswer) {
            const input = document.getElementById(inputId);
            const feedback = document.getElementById(inputId + 'Feedback');
            
            if (!input || !feedback) {
                console.error('Missing input or feedback element:', inputId);
                return;
            }
            
            const userAnswer = parseFloat(input.value);
            
            feedback.classList.remove('show', 'correct', 'incorrect'); // Reset classes
            
            if (!isNaN(userAnswer) && Math.abs(userAnswer - correctAnswer) < 0.1) {
                feedback.innerHTML = '<p><strong>Correct!</strong> 40 m¬≥ √ó 0.307 kg/m¬≥ = 12.28 kg</p>';
                feedback.classList.add('show', 'correct');
            } else {
                feedback.innerHTML = '<p><strong>Incorrect.</strong> Remember: Volume √ó 0.307 kg/m¬≥. The correct answer is 12.28 kg.</p>';
                feedback.classList.add('show', 'incorrect');
            }
        }

        function checkShortAnswer() {
            const answer = document.getElementById('shortAnswer1');
            const feedback = document.getElementById('shortAnswerFeedback');
            
            if (!answer || !feedback) {
                console.error('Missing answer or feedback element');
                return;
            }
            
            const answerText = answer.value.trim();
            
            feedback.classList.remove('show', 'correct', 'incorrect'); // Reset classes
            
            if (answerText.length > 20) {
                feedback.innerHTML = '<p><strong>Good!</strong> Sample answer: 1) Evacuate area, 2) Shut down ignition sources, 3) Ventilate and investigate leak source.</p>';
                feedback.classList.add('show', 'correct');
            } else {
                feedback.innerHTML = '<p><strong>Please provide a more detailed answer.</strong> Consider safety steps, ventilation, and investigation procedures.</p>';
                feedback.classList.add('show', 'incorrect');
            }
        }

        function generateAssessmentQuestions() {
            assessmentQuestions = [
                {
                    question: "What does the '2L' designation mean in A2L refrigerant classification?",
                    options: ["Low toxicity", "Mildly flammable", "Low pressure", "Light weight"],
                    correct: 1,
                    explanation: "The '2L' indicates mildly flammable characteristics."
                },
                {
                    question: "Which Canadian code covers A2L refrigerant installation requirements?",
                    options: ["CSA B51", "CSA B52", "CSA B149.2", "CSA B365"],
                    correct: 1,
                    explanation: "CSA B52 is the Mechanical Refrigeration Code that covers A2L requirements."
                },
                {
                    question: "What is the maximum R-32 charge for a 30 m¬≥ occupied space without additional safety measures?",
                    options: ["9.21 kg", "12.28 kg", "15.35 kg", "18.42 kg"],
                    correct: 0,
                    explanation: "30 m¬≥ √ó 0.307 kg/m¬≥ = 9.21 kg maximum charge."
                },
                {
                    question: "Which connection method is NOT permitted for A2L refrigerants?",
                    options: ["Brazed joints", "Soldered joints", "Mechanical fittings", "Flared connections"],
                    correct: 1,
                    explanation: "Soldered joints are not permitted due to their lower melting point."
                },
                {
                    question: "What should be your first action when detecting an A2L leak?",
                    options: ["Find the leak source", "Shut down ignition sources", "Continue working", "Call supervisor"],
                    correct: 1,
                    explanation: "Safety first - eliminate ignition sources to prevent fire hazard."
                }
                // Add more questions as needed
            ];
        }

        function startFinalAssessment() {
            document.getElementById('startAssessment').style.display = 'none';
            document.getElementById('assessmentContainer').style.display = 'block';
            currentQuestionIndex = 0;
            userAnswers = [];
            displayAssessmentQuestion();
        }

        function displayAssessmentQuestion() {
            const question = assessmentQuestions[currentQuestionIndex];
            document.getElementById('questionCounter').textContent = `Question ${currentQuestionIndex + 1} of ${assessmentQuestions.length}`;
            document.getElementById('assessmentQuestion').textContent = question.question;
            
            const optionsContainer = document.getElementById('assessmentOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'quiz-option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => selectAssessmentAnswer(index);
                optionsContainer.appendChild(optionDiv);
            });

            // Update navigation buttons
            document.getElementById('prevQuestion').disabled = currentQuestionIndex === 0;
            document.getElementById('nextQuestion').textContent = 
                currentQuestionIndex === assessmentQuestions.length - 1 ? 'Finish Assessment' : 'Next ‚Üí';
        }

        function selectAssessmentAnswer(answerIndex) {
            userAnswers[currentQuestionIndex] = answerIndex;
            
            // Visual feedback
            const options = document.querySelectorAll('#assessmentOptions .quiz-option');
            options.forEach((opt, idx) => {
                opt.classList.remove('selected');
                if (idx === answerIndex) opt.classList.add('selected');
            });
        }

        function nextQuestion() {
            if (currentQuestionIndex < assessmentQuestions.length - 1) {
                currentQuestionIndex++;
                displayAssessmentQuestion();
            } else {
                finishAssessment();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayAssessmentQuestion();
            }
        }

        function finishAssessment() {
            // Calculate score
            assessmentScore = 0;
            assessmentQuestions.forEach((question, index) => {
                if (userAnswers[index] === question.correct) {
                    assessmentScore++;
                }
            });

            const percentage = Math.round((assessmentScore / assessmentQuestions.length) * 100);
            const passed = percentage >= 80;

            // Hide assessment, show results
            document.getElementById('assessmentContainer').style.display = 'none';
            document.getElementById('assessmentResults').style.display = 'block';
            
            document.getElementById('scoreDisplay').innerHTML = 
                `<h4>Your Score: ${assessmentScore}/${assessmentQuestions.length} (${percentage}%)</h4>`;
            
            if (passed) {
                document.getElementById('passFailMessage').innerHTML = 
                    '<p style="color: #28a745; font-weight: bold;">üéâ Congratulations! You have passed the assessment.</p>';
                document.getElementById('nameInputSection').style.display = 'block';
            } else {
                document.getElementById('passFailMessage').innerHTML = 
                    '<p style="color: #dc3545; font-weight: bold;">You need 80% to pass. Please review the material and try again.</p>';
            }
        }

        function generatePersonalizedCertificate() {
            const nameInput = document.getElementById('certificateName');
            const studentName = nameInput.value.trim();
            
            if (!studentName || studentName.length < 2) {
                alert('Please enter your full name to generate the certificate.');
                return;
            }
            
            // Hide name input section and show certificate
            document.getElementById('nameInputSection').style.display = 'none';
            document.getElementById('certificateSection').style.display = 'block';
            
            // Generate certificate with user's name
            generateCertificate(studentName);
        }

        function generateCertificate(studentName = 'Course Participant') {
            const today = new Date();
            const certificateId = 'A2L-' + today.getFullYear() + '-' + Math.random().toString(36).substr(2, 9).toUpperCase();
            const percentage = Math.round((assessmentScore / assessmentQuestions.length) * 100);
            
            document.getElementById('completionDate').textContent = today.toLocaleDateString('en-CA');
            document.getElementById('certificateId').textContent = certificateId;
            document.getElementById('studentName').textContent = studentName;
            document.getElementById('certificateScore').textContent = percentage;
        }

        function printCertificate() {
            // Create a new window for printing
            const printWindow = window.open('', '_blank');
            const certificateHTML = document.getElementById('certificateContainer').innerHTML;
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>A2L Refrigerant Safety Certificate</title>
                    <style>
                        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&display=swap');
                        
                        @page {
                            size: letter;
                            margin: 0.5in;
                        }
                        
                        body {
                            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                            margin: 0;
                            padding: 0;
                            background: white;
                            width: 100%;
                            height: 100vh;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                        }
                        
                        .certificate-container {
                            background: linear-gradient(135deg, #fff, #f8f9fa);
                            border: 3px solid #2a5298;
                            border-radius: 15px;
                            padding: 25px;
                            text-align: center;
                            width: 7.5in;
                            max-width: 7.5in;
                            height: auto;
                            max-height: 10in;
                            box-shadow: none;
                        }
                        
                        .certificate-header {
                            color: #1e3c72;
                            font-size: 1.6em;
                            margin-bottom: 15px;
                            font-weight: bold;
                        }
                        
                        .certificate-body {
                            font-size: 1em;
                            line-height: 1.4;
                            margin: 15px 0;
                        }
                        
                        .download-certificate {
                            display: none !important;
                        }
                        
                        h2 {
                            color: #2a5298;
                            border-bottom: 3px solid #2a5298;
                            display: inline-block;
                            padding-bottom: 6px;
                            margin: 15px 0;
                            font-size: 1.8em;
                        }
                        
                        h3 {
                            color: #1e3c72;
                            margin-bottom: 15px;
                            font-size: 1.3em;
                        }
                        
                        /* Cursive signature styling */
                        .signature-name {
                            font-family: 'Dancing Script', 'Brush Script MT', cursive !important;
                            font-size: 1.4em !important;
                            color: #2a5298 !important;
                            margin-bottom: 3px !important;
                        }
                        
                        @media print {
                            body { 
                                margin: 0; 
                                padding: 0;
                                -webkit-print-color-adjust: exact;
                                print-color-adjust: exact;
                            }
                            .certificate-container { 
                                margin: 0; 
                                box-shadow: none; 
                                page-break-inside: avoid;
                            }
                        }
                    </style>
                </head>
                <body>
                    <div class="certificate-container">
                        ${certificateHTML.replace(/style="font-family: 'Brush Script MT', cursive, 'Dancing Script', cursive;/g, 'class="signature-name" style="')}
                    </div>
                </body>
                </html>
            `);
            
            printWindow.document.close();
            printWindow.focus();
            
            // Small delay to ensure content and fonts are loaded before printing
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 500);
        }

        function downloadCertificate() {
            // Create a simplified HTML version for download
            const studentName = document.getElementById('studentName').textContent;
            const completionDate = document.getElementById('completionDate').textContent;
            const certificateId = document.getElementById('certificateId').textContent;
            const score = document.getElementById('certificateScore').textContent;
            
            const certificateHTML = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>A2L Refrigerant Safety Certificate - ${studentName}</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600;700&display=swap');
        
        @page {
            size: letter;
            margin: 0.5in;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .certificate-container {
            background: linear-gradient(135deg, #fff, #f8f9fa);
            border: 3px solid #2a5298;
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            margin: 20px auto;
            max-width: 750px;
            width: 100%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            height: auto;
            min-height: 600px;
            max-height: 700px;
        }
        
        .header-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .logo-section {
            text-align: left;
        }
        
        .logo-text {
            font-size: 18px;
            font-weight: bold;
            color: #1e3c72;
        }
        
        .logo-subtitle {
            font-size: 12px;
            color: #2a5298;
        }
        
        .cert-info {
            text-align: right;
            font-size: 0.8em;
            color: #666;
        }
        
        .certificate-header {
            color: #1e3c72;
            font-size: 1.6em;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .certificate-title {
            color: #1e3c72;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .student-name {
            color: #2a5298;
            border-bottom: 3px solid #2a5298;
            display: inline-block;
            padding-bottom: 6px;
            margin: 15px 0;
            font-size: 1.8em;
            font-weight: bold;
        }
        
        .competencies {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin: 18px 0;
            text-align: left;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            font-size: 0.9em;
        }
        
        .competency {
            margin: 6px 0;
            color: #333;
        }
        
        .footer-section {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 2px solid #e9ecef;
        }
        
        .signature-section {
            text-align: center;
        }
        
        .signature-line {
            border-top: 2px solid #2a5298;
            width: 200px;
            margin-bottom: 5px;
        }
        
        .signature-name {
            font-family: 'Dancing Script', 'Brush Script MT', cursive;
            font-size: 1.4em;
            color: #2a5298;
            margin-bottom: 3px;
            font-weight: 600;
        }
        
        .score-section {
            text-align: center;
            font-size: 0.85em;
            color: #666;
        }
        
        @media print {
            body { 
                background: white; 
                padding: 0;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .certificate-container { 
                box-shadow: none; 
                margin: 0;
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="certificate-container">
        <div class="header-section">
            <div class="logo-section">
                <div class="logo-text">LARK Labs</div>
                <div class="logo-subtitle">Professional HVAC Training</div>
            </div>
            <div class="cert-info">
                <div>Certificate ID: ${certificateId}</div>
                <div>Issued: ${completionDate}</div>
            </div>
        </div>
        
        <div class="certificate-header">üèÜ Certificate of Completion</div>
        <h3 class="certificate-title">Canadian A2L Refrigerant Safety Certificate</h3>
        <p style="font-size: 1em; margin-bottom: 8px;">This is to certify that</p>
        <div class="student-name">${studentName}</div>
        <p style="font-size: 1em; margin-bottom: 15px;">has successfully completed the Canadian A2L Refrigerant Safety Certificate Course<br>
        with a passing score and demonstrated competency in:</p>
        
        <div class="competencies">
            <div>
                <div class="competency">‚úì A2L refrigerant properties and hazards</div>
                <div class="competency">‚úì Canadian regulatory requirements (CSA B52, B149.1-25, TSSA)</div>
                <div class="competency">‚úì Safe handling and installation practices</div>
            </div>
            <div>
                <div class="competency">‚úì System design and maintenance procedures</div>
                <div class="competency">‚úì Emergency response protocols</div>
                <div class="competency">‚úì Code compliance and documentation</div>
            </div>
        </div>
        
        <p style="margin-top: 20px; font-size: 0.9em;">This certificate demonstrates the holder's knowledge of safe practices for working with mildly flammable A2L refrigerants in accordance with Canadian codes and standards.</p>
        
        <div class="footer-section">
            <div class="signature-section">
                <div class="signature-line"></div>
                <div class="signature-name">Michael J Kapin</div>
                <div style="font-weight: bold; color: #1e3c72; font-size: 0.9em;">LARK Labs</div>
                <div style="font-size: 0.8em; color: #666;">Professional HVAC Training Provider</div>
            </div>
            <div class="score-section">
                <div><strong>Course Duration:</strong> 6-8 hours</div>
                <div><strong>Passing Score:</strong> 80%</div>
                <div><strong>Your Score:</strong> ${score}%</div>
            </div>
        </div>
    </div>
</body>
</html>`;

            // Create and download the file
            const blob = new Blob([certificateHTML], { type: 'text/html' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = `A2L_Certificate_${studentName.replace(/\s+/g, '_')}_${certificateId}.html`;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
            
            // Show success message
            alert('Certificate downloaded successfully! Open the HTML file in any web browser and use Print ‚Üí Save as PDF for a professional PDF certificate that fits perfectly on 8.5" x 11" paper.');
        }
    </script>
</body>
</html>
