<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canadian Gas Piping Sizing Calculator - CSA B149.1:25</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Professional CSA B149.1:25 compliant gas piping sizing calculator for natural gas and propane systems">
    <meta name="theme-color" content="#1e3c72">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Gas Pipe Calc">
    
    <!-- PWA Icons -->
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512.png">
    <link rel="shortcut icon" href="icons/icon-192.png">
    <link rel="manifest" href="gas-pipe-calc-manifest.json">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        .input-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            border: 1px solid #e9ecef;
        }

        .results-section {
            background: #fff;
            padding: 25px;
            border-radius: 12px;
            border: 2px solid #28a745;
        }

        .section-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #34495e;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .appliance-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            margin-bottom: 15px;
            position: relative;
        }

        .remove-appliance {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-size: 14px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
            transform: translateY(-2px);
        }

        .btn-success {
            background: #27ae60;
            color: white;
        }

        .btn-success:hover {
            background: #229954;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #95a5a6;
            color: white;
        }

        .btn-secondary:hover {
            background: #7f8c8d;
            transform: translateY(-2px);
        }

        .total-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }

        .total-display h3 {
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        .result-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #28a745;
        }

        .result-item h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .calculation-details {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .disclaimer {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                border-radius: 10px;
            }
            
            .main-content {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .header {
                padding: 15px 20px;
            }
            
            .header h1 {
                font-size: 1.8rem;
                line-height: 1.2;
            }
            
            .header p {
                font-size: 0.9rem;
            }
            
            .input-section, .results-section {
                padding: 20px 15px;
            }
            
            .section-title {
                font-size: 1.2rem;
                margin-bottom: 15px;
            }
            
            .form-group {
                margin-bottom: 15px;
            }
            
            input, select {
                padding: 14px 12px;
                font-size: 16px; /* Prevents zoom on iOS */
            }
            
            .btn {
                width: 100%;
                margin: 5px 0;
                padding: 14px;
                font-size: 1rem;
            }
            
            .btn:not(:first-child) {
                margin-left: 0;
            }
            
            .appliance-item {
                padding: 15px;
                margin-bottom: 15px;
            }
            
            .remove-appliance {
                right: 10px;
                top: 10px;
                width: 30px;
                height: 30px;
                font-size: 18px;
            }
            
            .total-display {
                padding: 15px;
                margin: 15px 0;
            }
            
            .total-display h3 {
                font-size: 1.1rem;
            }
            
            .total-display div {
                font-size: 1.3rem;
            }
            
            .result-item {
                padding: 15px;
                margin-bottom: 15px;
            }
            
            .result-item h4 {
                font-size: 1.1rem;
                margin-bottom: 10px;
            }
            
            .calculation-details {
                font-size: 0.9rem;
                padding: 12px;
                margin: 10px 0;
            }
            
            .warning {
                font-size: 0.9rem;
                padding: 12px;
                margin: 10px 0;
            }
            
            /* Make branch sizing table mobile-friendly */
            .result-item div[style*="grid-template-columns"] {
                display: block !important;
                border-bottom: 1px solid #eee;
                padding: 10px 0;
            }
            
            .result-item div[style*="grid-template-columns"] div {
                display: block;
                text-align: left !important;
                padding: 2px 0;
            }
            
            .result-item div[style*="grid-template-columns"] div:first-child {
                font-weight: bold;
                color: #2c3e50;
            }
            
            .result-item div[style*="grid-template-columns"] div:nth-child(2):before {
                content: "Capacity: ";
                font-weight: bold;
                color: #666;
            }
            
            .result-item div[style*="grid-template-columns"] div:nth-child(3):before {
                content: "Min. Pipe Size: ";
                font-weight: bold;
                color: #666;
            }
            
            .result-item div[style*="grid-template-columns"] div:nth-child(4):before {
                content: "Available: ";
                font-weight: bold;
                color: #666;
            }
        }
        
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5rem;
            }
            
            .header p {
                font-size: 0.8rem;
            }
            
            .input-section, .results-section {
                padding: 15px 10px;
            }
            
            .appliance-item {
                padding: 12px;
            }
            
            input, select {
                padding: 12px 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Canadian Gas Piping Sizing Calculator</h1>
            <p>Based on CSA B149.1:25 Natural Gas and Propane Installation Code - Annex A</p>
        </div>

        <div class="main-content">
            <div class="input-section">
                <h2 class="section-title">System Parameters</h2>
                
                <div class="form-group">
                    <label for="gasType">Type of Gas:</label>
                    <select id="gasType">
                        <option value="natural">Natural Gas (0.6 Relative Density)</option>
                        <option value="propane">Propane / LP Gas (1.5 Relative Density)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="pipeType">Pipe/Tubing Type:</label>
                    <select id="pipeType">
                        <option value="schedule40">Schedule 40 Black Iron Pipe</option>
                        <option value="copper">Type K Copper Tubing</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="pressure">Operating Pressure:</label>
                    <select id="pressure">
                        <option value="low">Less than 7" w.c. (1.7 kPa)</option>
                        <option value="medium">7" to 14" w.c. (1.7 to 3.5 kPa)</option>
                        <option value="2">2 psig (13.8 kPa)</option>
                        <option value="5">5 psig (34.5 kPa)</option>
                        <option value="10">10 psig (69 kPa)</option>
                        <option value="20">20 psig (138 kPa)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="lmr">Longest Measured Run (LMR) in feet:</label>
                    <input type="number" id="lmr" placeholder="Enter LMR in feet" min="1" value="50">
                </div>

                <div class="form-group">
                    <label for="gasRelativeDensity">Gas Relative Density (optional):</label>
                    <input type="number" id="gasRelativeDensity" placeholder="Leave blank for standard density" min="0.35" max="2.10" step="0.01">
                    <small class="form-text text-muted">Standard: Natural Gas 0.6, Propane 1.5. Enter actual gas density if different.</small>
                </div>

                <h3 style="margin-top: 30px; margin-bottom: 15px; color: #2c3e50;">Appliances</h3>
                <div id="appliancesList">
                    <div class="appliance-item">
                        <label>Appliance Name:</label>
                        <input type="text" class="appliance-name" placeholder="e.g., Furnace">
                        <label style="margin-top: 10px;">Capacity (Btu/h):</label>
                        <input type="number" class="appliance-btuh" placeholder="Enter Btu/h" min="1">
                    </div>
                </div>

                <button class="btn btn-primary" onclick="addAppliance()">+ Add Appliance</button>
                <button class="btn btn-success" onclick="calculatePipeSize()" style="margin-left: 10px;">Calculate Pipe Size</button>
                <button class="btn btn-secondary" onclick="clearAll()" style="margin-left: 10px;">Clear All</button>

                <div class="total-display">
                    <h3>Total System Load</h3>
                    <div id="totalBtuh">0 Btu/h</div>
                </div>
            </div>

            <div class="results-section">
                <h2 class="section-title">Sizing Results</h2>
                <div id="results">
                    <p style="color: #6c757d; text-align: center; margin-top: 50px;">
                        Enter appliance data and click "Calculate Pipe Size" to see results
                    </p>
                </div>
            </div>
        </div>

        <div class="disclaimer">
            <strong>IMPORTANT DISCLAIMER:</strong> This calculator is for reference purposes only. All gas piping installations must be performed by licensed gas technicians in accordance with local codes and regulations. The CSA B149.1:25 code and local authority having jurisdiction take precedence. Always consult with qualified professionals and obtain proper permits before installation.
        </div>
    </div>

    <script>
        // Natural Gas Capacity Tables (from CSA B149.1:25 Annex A)
        const naturalGasTables = {
            schedule40: {
                "0.5": { // 0.5 in w.c.
                    10: {size: "1/2", capacity: 156},
                    20: {size: "1/2", capacity: 107},
                    30: {size: "1/2", capacity: 86},
                    40: {size: "1/2", capacity: 74},
                    50: {size: "1/2", capacity: 65},
                    60: {size: "1/2", capacity: 59},
                    70: {size: "1/2", capacity: 54},
                    80: {size: "1/2", capacity: 51},
                    90: {size: "1/2", capacity: 48},
                    100: {size: "1/2", capacity: 45},
                    125: {size: "1/2", capacity: 40},
                    150: {size: "1/2", capacity: 36},
                    175: {size: "1/2", capacity: 33},
                    200: {size: "1/2", capacity: 31},
                    250: {size: "1/2", capacity: 27},
                    300: {size: "1/2", capacity: 25},
                    350: {size: "1/2", capacity: 23},
                    400: {size: "1/2", capacity: 21},
                    450: {size: "1/2", capacity: 20},
                    500: {size: "1/2", capacity: 19}
                }
            },
            copper: {
                "0.5": { // 0.5 in w.c.
                    10: {size: "1/2", capacity: 46},
                    20: {size: "1/2", capacity: 32},
                    30: {size: "1/2", capacity: 25},
                    40: {size: "1/2", capacity: 22},
                    50: {size: "1/2", capacity: 19},
                    60: {size: "1/2", capacity: 18},
                    70: {size: "1/2", capacity: 16},
                    80: {size: "1/2", capacity: 15},
                    90: {size: "1/2", capacity: 14},
                    100: {size: "1/2", capacity: 13},
                    125: {size: "1/2", capacity: 12},
                    150: {size: "1/2", capacity: 11},
                    175: {size: "1/2", capacity: 10},
                    200: {size: "1/2", capacity: 9},
                    250: {size: "1/2", capacity: 8},
                    300: {size: "1/2", capacity: 8},
                    350: {size: "1/2", capacity: 7},
                    400: {size: "1/2", capacity: 7},
                    450: {size: "1/2", capacity: 6},
                    500: {size: "1/2", capacity: 6}
                }
            }
        };

        // Table A.15: Multipliers for gas relative density (CSA B149.1:25)
        const gasRelativeDensityMultipliers = {
            0.35: 1.31, 0.40: 1.23, 0.45: 1.16, 0.50: 1.10, 0.55: 1.04, 0.60: 1.00,
            0.65: 0.962, 0.70: 0.926, 0.75: 0.895, 0.80: 0.867, 0.85: 0.841, 0.90: 0.817,
            1.00: 0.775, 1.10: 0.740, 1.20: 0.707, 1.30: 0.680, 1.80: 0.577, 1.90: 0.565,
            2.00: 0.547, 2.10: 0.535
        };

        function getRelativeDensityMultiplier(relativeDensity) {
            if (!relativeDensity) return 1.0;
            
            // Find exact match or interpolate
            const densities = Object.keys(gasRelativeDensityMultipliers).map(parseFloat).sort((a, b) => a - b);
            
            if (gasRelativeDensityMultipliers[relativeDensity]) {
                return gasRelativeDensityMultipliers[relativeDensity];
            }
            
            // Find bounding values for interpolation
            let lowerDensity = null, upperDensity = null;
            for (let density of densities) {
                if (density <= relativeDensity) {
                    lowerDensity = density;
                } else {
                    upperDensity = density;
                    break;
                }
            }
            
            if (!lowerDensity) return gasRelativeDensityMultipliers[densities[0]];
            if (!upperDensity) return gasRelativeDensityMultipliers[densities[densities.length - 1]];
            
            // Linear interpolation
            const lowerMultiplier = gasRelativeDensityMultipliers[lowerDensity];
            const upperMultiplier = gasRelativeDensityMultipliers[upperDensity];
            const ratio = (relativeDensity - lowerDensity) / (upperDensity - lowerDensity);
            
            return lowerMultiplier + (upperMultiplier - lowerMultiplier) * ratio;
        }

        // Extended capacity tables for different pipe sizes
        const extendedCapacityTables = {
            schedule40: {
                "0.5": {
                    "1/2": [
                        {length: 10, capacity: 156},
                        {length: 20, capacity: 107},
                        {length: 30, capacity: 86},
                        {length: 40, capacity: 74},
                        {length: 50, capacity: 65},
                        {length: 60, capacity: 59},
                        {length: 70, capacity: 54},
                        {length: 80, capacity: 51},
                        {length: 90, capacity: 48},
                        {length: 100, capacity: 45},
                        {length: 125, capacity: 40},
                        {length: 150, capacity: 36},
                        {length: 175, capacity: 33},
                        {length: 200, capacity: 31},
                        {length: 250, capacity: 27},
                        {length: 300, capacity: 25},
                        {length: 350, capacity: 23},
                        {length: 400, capacity: 21},
                        {length: 450, capacity: 20},
                        {length: 500, capacity: 19}
                    ],
                    "3/4": [
                        {length: 10, capacity: 324},
                        {length: 20, capacity: 220},
                        {length: 30, capacity: 180},
                        {length: 40, capacity: 154},
                        {length: 50, capacity: 137},
                        {length: 60, capacity: 124},
                        {length: 70, capacity: 114},
                        {length: 80, capacity: 106},
                        {length: 90, capacity: 99},
                        {length: 100, capacity: 94},
                        {length: 125, capacity: 83},
                        {length: 150, capacity: 75},
                        {length: 175, capacity: 69},
                        {length: 200, capacity: 64},
                        {length: 250, capacity: 57},
                        {length: 300, capacity: 52},
                        {length: 350, capacity: 48},
                        {length: 400, capacity: 44},
                        {length: 450, capacity: 42},
                        {length: 500, capacity: 39}
                    ],
                    "1": [
                        {length: 10, capacity: 614},
                        {length: 20, capacity: 422},
                        {length: 30, capacity: 339},
                        {length: 40, capacity: 290},
                        {length: 50, capacity: 257},
                        {length: 60, capacity: 233},
                        {length: 70, capacity: 214},
                        {length: 80, capacity: 199},
                        {length: 90, capacity: 187},
                        {length: 100, capacity: 177},
                        {length: 125, capacity: 157},
                        {length: 150, capacity: 142},
                        {length: 175, capacity: 131},
                        {length: 200, capacity: 121},
                        {length: 250, capacity: 108},
                        {length: 300, capacity: 98},
                        {length: 350, capacity: 90},
                        {length: 400, capacity: 83},
                        {length: 450, capacity: 78},
                        {length: 500, capacity: 74}
                    ],
                    "1-1/4": [
                        {length: 10, capacity: 1261},
                        {length: 20, capacity: 867},
                        {length: 30, capacity: 696},
                        {length: 40, capacity: 596},
                        {length: 50, capacity: 528},
                        {length: 60, capacity: 478},
                        {length: 70, capacity: 440},
                        {length: 80, capacity: 409},
                        {length: 90, capacity: 384},
                        {length: 100, capacity: 363},
                        {length: 125, capacity: 322},
                        {length: 150, capacity: 291},
                        {length: 175, capacity: 268},
                        {length: 200, capacity: 249},
                        {length: 250, capacity: 221},
                        {length: 300, capacity: 200},
                        {length: 350, capacity: 184},
                        {length: 400, capacity: 171},
                        {length: 450, capacity: 161},
                        {length: 500, capacity: 152}
                    ],
                    "1-1/2": [
                        {length: 10, capacity: 1890},
                        {length: 20, capacity: 1299},
                        {length: 30, capacity: 1043},
                        {length: 40, capacity: 893},
                        {length: 50, capacity: 791},
                        {length: 60, capacity: 717},
                        {length: 70, capacity: 659},
                        {length: 80, capacity: 613},
                        {length: 90, capacity: 576},
                        {length: 100, capacity: 544},
                        {length: 125, capacity: 482},
                        {length: 150, capacity: 437},
                        {length: 175, capacity: 402},
                        {length: 200, capacity: 374},
                        {length: 250, capacity: 331},
                        {length: 300, capacity: 300},
                        {length: 350, capacity: 276},
                        {length: 400, capacity: 257},
                        {length: 450, capacity: 241},
                        {length: 500, capacity: 228}
                    ],
                    "2": [
                        {length: 10, capacity: 3473},
                        {length: 20, capacity: 2386},
                        {length: 30, capacity: 1916},
                        {length: 40, capacity: 1641},
                        {length: 50, capacity: 1453},
                        {length: 60, capacity: 1317},
                        {length: 70, capacity: 1211},
                        {length: 80, capacity: 1125},
                        {length: 90, capacity: 1056},
                        {length: 100, capacity: 999},
                        {length: 125, capacity: 884},
                        {length: 150, capacity: 801},
                        {length: 175, capacity: 737},
                        {length: 200, capacity: 686},
                        {length: 250, capacity: 608},
                        {length: 300, capacity: 551},
                        {length: 350, capacity: 507},
                        {length: 400, capacity: 471},
                        {length: 450, capacity: 442},
                        {length: 500, capacity: 417}
                    ]
                },
                "A2": {
                    "1/2": [
                        {length: 10, capacity: 222},
                        {length: 20, capacity: 156},
                        {length: 30, capacity: 125},
                        {length: 40, capacity: 107},
                        {length: 50, capacity: 95},
                        {length: 60, capacity: 86},
                        {length: 70, capacity: 79},
                        {length: 80, capacity: 74},
                        {length: 90, capacity: 69},
                        {length: 100, capacity: 65},
                        {length: 125, capacity: 58},
                        {length: 150, capacity: 52},
                        {length: 175, capacity: 48},
                        {length: 200, capacity: 45},
                        {length: 250, capacity: 40},
                        {length: 300, capacity: 36},
                        {length: 350, capacity: 33},
                        {length: 400, capacity: 31},
                        {length: 450, capacity: 29},
                        {length: 500, capacity: 27}
                    ],
                    "3/4": [
                        {length: 10, capacity: 472},
                        {length: 20, capacity: 324},
                        {length: 30, capacity: 262},
                        {length: 40, capacity: 224},
                        {length: 50, capacity: 199},
                        {length: 60, capacity: 180},
                        {length: 70, capacity: 166},
                        {length: 80, capacity: 154},
                        {length: 90, capacity: 145},
                        {length: 100, capacity: 137},
                        {length: 125, capacity: 121},
                        {length: 150, capacity: 110},
                        {length: 175, capacity: 101},
                        {length: 200, capacity: 94},
                        {length: 250, capacity: 83},
                        {length: 300, capacity: 75},
                        {length: 350, capacity: 69},
                        {length: 400, capacity: 64},
                        {length: 450, capacity: 61},
                        {length: 500, capacity: 57}
                    ],
                    "1": [
                        {length: 10, capacity: 894},
                        {length: 20, capacity: 614},
                        {length: 30, capacity: 493},
                        {length: 40, capacity: 422},
                        {length: 50, capacity: 374},
                        {length: 60, capacity: 339},
                        {length: 70, capacity: 312},
                        {length: 80, capacity: 290},
                        {length: 90, capacity: 272},
                        {length: 100, capacity: 257},
                        {length: 125, capacity: 228},
                        {length: 150, capacity: 207},
                        {length: 175, capacity: 190},
                        {length: 200, capacity: 177},
                        {length: 250, capacity: 157},
                        {length: 300, capacity: 142},
                        {length: 350, capacity: 131},
                        {length: 400, capacity: 121},
                        {length: 450, capacity: 114},
                        {length: 500, capacity: 108}
                    ],
                    "1-1/4": [
                        {length: 10, capacity: 1890},
                        {length: 20, capacity: 1299},
                        {length: 30, capacity: 1043},
                        {length: 40, capacity: 893},
                        {length: 50, capacity: 791},
                        {length: 60, capacity: 717},
                        {length: 70, capacity: 659},
                        {length: 80, capacity: 613},
                        {length: 90, capacity: 576},
                        {length: 100, capacity: 544},
                        {length: 125, capacity: 482},
                        {length: 150, capacity: 437},
                        {length: 175, capacity: 402},
                        {length: 200, capacity: 374},
                        {length: 250, capacity: 331},
                        {length: 300, capacity: 300},
                        {length: 350, capacity: 276},
                        {length: 400, capacity: 257},
                        {length: 450, capacity: 241},
                        {length: 500, capacity: 228}
                    ],
                    "1-1/2": [
                        {length: 10, capacity: 2749},
                        {length: 20, capacity: 1890},
                        {length: 30, capacity: 1517},
                        {length: 40, capacity: 1299},
                        {length: 50, capacity: 1151},
                        {length: 60, capacity: 1043},
                        {length: 70, capacity: 959},
                        {length: 80, capacity: 893},
                        {length: 90, capacity: 837},
                        {length: 100, capacity: 791},
                        {length: 125, capacity: 701},
                        {length: 150, capacity: 635},
                        {length: 175, capacity: 584},
                        {length: 200, capacity: 544},
                        {length: 250, capacity: 482},
                        {length: 300, capacity: 437},
                        {length: 350, capacity: 402},
                        {length: 400, capacity: 374},
                        {length: 450, capacity: 351},
                        {length: 500, capacity: 331}
                    ]
                },
                "2": {
                    "1/2": [
                        {length: 10, capacity: 329},
                        {length: 20, capacity: 226},
                        {length: 30, capacity: 181},
                        {length: 40, capacity: 155},
                        {length: 50, capacity: 137},
                        {length: 60, capacity: 124},
                        {length: 70, capacity: 114},
                        {length: 80, capacity: 106},
                        {length: 90, capacity: 99},
                        {length: 100, capacity: 94},
                        {length: 125, capacity: 83},
                        {length: 150, capacity: 75},
                        {length: 175, capacity: 69},
                        {length: 200, capacity: 64},
                        {length: 250, capacity: 57},
                        {length: 300, capacity: 52},
                        {length: 350, capacity: 48},
                        {length: 400, capacity: 44},
                        {length: 450, capacity: 42},
                        {length: 500, capacity: 39}
                    ],
                    "3/4": [
                        {length: 10, capacity: 689},
                        {length: 20, capacity: 473},
                        {length: 30, capacity: 380},
                        {length: 40, capacity: 326},
                        {length: 50, capacity: 288},
                        {length: 60, capacity: 261},
                        {length: 70, capacity: 240},
                        {length: 80, capacity: 223},
                        {length: 90, capacity: 209},
                        {length: 100, capacity: 197},
                        {length: 125, capacity: 175},
                        {length: 150, capacity: 158},
                        {length: 175, capacity: 146},
                        {length: 200, capacity: 135},
                        {length: 250, capacity: 120},
                        {length: 300, capacity: 109},
                        {length: 350, capacity: 100},
                        {length: 400, capacity: 93},
                        {length: 450, capacity: 87},
                        {length: 500, capacity: 82}
                    ],
                    "1": [
                        {length: 10, capacity: 1409},
                        {length: 20, capacity: 968},
                        {length: 30, capacity: 777},
                        {length: 40, capacity: 666},
                        {length: 50, capacity: 590},
                        {length: 60, capacity: 535},
                        {length: 70, capacity: 492},
                        {length: 80, capacity: 457},
                        {length: 90, capacity: 429},
                        {length: 100, capacity: 405},
                        {length: 125, capacity: 358},
                        {length: 150, capacity: 325},
                        {length: 175, capacity: 299},
                        {length: 200, capacity: 278},
                        {length: 250, capacity: 246},
                        {length: 300, capacity: 223},
                        {length: 350, capacity: 205},
                        {length: 400, capacity: 191},
                        {length: 450, capacity: 179},
                        {length: 500, capacity: 169}
                    ],
                    "1-1/4": [
                        {length: 10, capacity: 2903},
                        {length: 20, capacity: 1996},
                        {length: 30, capacity: 1602},
                        {length: 40, capacity: 1372},
                        {length: 50, capacity: 1215},
                        {length: 60, capacity: 1100},
                        {length: 70, capacity: 1013},
                        {length: 80, capacity: 941},
                        {length: 90, capacity: 883},
                        {length: 100, capacity: 834},
                        {length: 125, capacity: 738},
                        {length: 150, capacity: 669},
                        {length: 175, capacity: 615},
                        {length: 200, capacity: 571},
                        {length: 250, capacity: 507},
                        {length: 300, capacity: 459},
                        {length: 350, capacity: 423},
                        {length: 400, capacity: 393},
                        {length: 450, capacity: 369},
                        {length: 500, capacity: 348}
                    ],
                    "1-1/2": [
                        {length: 10, capacity: 4356},
                        {length: 20, capacity: 2995},
                        {length: 30, capacity: 2405},
                        {length: 40, capacity: 2061},
                        {length: 50, capacity: 1825},
                        {length: 60, capacity: 1654},
                        {length: 70, capacity: 1523},
                        {length: 80, capacity: 1415},
                        {length: 90, capacity: 1328},
                        {length: 100, capacity: 1255},
                        {length: 125, capacity: 1110},
                        {length: 150, capacity: 1006},
                        {length: 175, capacity: 926},
                        {length: 200, capacity: 860},
                        {length: 250, capacity: 763},
                        {length: 300, capacity: 691},
                        {length: 350, capacity: 636},
                        {length: 400, capacity: 591},
                        {length: 450, capacity: 554},
                        {length: 500, capacity: 523}
                    ],
                    "2": [
                        {length: 10, capacity: 8008},
                        {length: 20, capacity: 5504},
                        {length: 30, capacity: 4419},
                        {length: 40, capacity: 3785},
                        {length: 50, capacity: 3353},
                        {length: 60, capacity: 3038},
                        {length: 70, capacity: 2796},
                        {length: 80, capacity: 2598},
                        {length: 90, capacity: 2437},
                        {length: 100, capacity: 2301},
                        {length: 125, capacity: 2035},
                        {length: 150, capacity: 1846},
                        {length: 175, capacity: 1699},
                        {length: 200, capacity: 1578},
                        {length: 250, capacity: 1399},
                        {length: 300, capacity: 1268},
                        {length: 350, capacity: 1167},
                        {length: 400, capacity: 1084},
                        {length: 450, capacity: 1017},
                        {length: 500, capacity: 960}
                    ]
                }
            },
            copper: {
                "0.5": {
                    "1/2": [
                        {length: 10, capacity: 46},
                        {length: 20, capacity: 32},
                        {length: 30, capacity: 25},
                        {length: 40, capacity: 22},
                        {length: 50, capacity: 19},
                        {length: 60, capacity: 18},
                        {length: 70, capacity: 16},
                        {length: 80, capacity: 15},
                        {length: 90, capacity: 14},
                        {length: 100, capacity: 13},
                        {length: 125, capacity: 12},
                        {length: 150, capacity: 11},
                        {length: 175, capacity: 10},
                        {length: 200, capacity: 9},
                        {length: 250, capacity: 8},
                        {length: 300, capacity: 8},
                        {length: 350, capacity: 7},
                        {length: 400, capacity: 7},
                        {length: 450, capacity: 6},
                        {length: 500, capacity: 6}
                    ],
                    "5/8": [
                        {length: 10, capacity: 101},
                        {length: 20, capacity: 69},
                        {length: 30, capacity: 56},
                        {length: 40, capacity: 48},
                        {length: 50, capacity: 42},
                        {length: 60, capacity: 38},
                        {length: 70, capacity: 35},
                        {length: 80, capacity: 33},
                        {length: 90, capacity: 31},
                        {length: 100, capacity: 29},
                        {length: 125, capacity: 26},
                        {length: 150, capacity: 23},
                        {length: 175, capacity: 21},
                        {length: 200, capacity: 20},
                        {length: 250, capacity: 18},
                        {length: 300, capacity: 16},
                        {length: 350, capacity: 15},
                        {length: 400, capacity: 14},
                        {length: 450, capacity: 13},
                        {length: 500, capacity: 12}
                    ],
                    "3/4": [
                        {length: 10, capacity: 176},
                        {length: 20, capacity: 121},
                        {length: 30, capacity: 97},
                        {length: 40, capacity: 83},
                        {length: 50, capacity: 74},
                        {length: 60, capacity: 67},
                        {length: 70, capacity: 62},
                        {length: 80, capacity: 57},
                        {length: 90, capacity: 54},
                        {length: 100, capacity: 51},
                        {length: 125, capacity: 45},
                        {length: 150, capacity: 41},
                        {length: 175, capacity: 38},
                        {length: 200, capacity: 35},
                        {length: 250, capacity: 31},
                        {length: 300, capacity: 28},
                        {length: 350, capacity: 26},
                        {length: 400, capacity: 24},
                        {length: 450, capacity: 23},
                        {length: 500, capacity: 21}
                    ],
                    "1": [
                        {length: 10, capacity: 321},
                        {length: 20, capacity: 220},
                        {length: 30, capacity: 177},
                        {length: 40, capacity: 152},
                        {length: 50, capacity: 134},
                        {length: 60, capacity: 122},
                        {length: 70, capacity: 112},
                        {length: 80, capacity: 104},
                        {length: 90, capacity: 98},
                        {length: 100, capacity: 92},
                        {length: 125, capacity: 82},
                        {length: 150, capacity: 74},
                        {length: 175, capacity: 68},
                        {length: 200, capacity: 63},
                        {length: 250, capacity: 56},
                        {length: 300, capacity: 51},
                        {length: 350, capacity: 47},
                        {length: 400, capacity: 44},
                        {length: 450, capacity: 41},
                        {length: 500, capacity: 39}
                    ],
                    "1-1/4": [
                        {length: 10, capacity: 628},
                        {length: 20, capacity: 431},
                        {length: 30, capacity: 346},
                        {length: 40, capacity: 297},
                        {length: 50, capacity: 263},
                        {length: 60, capacity: 238},
                        {length: 70, capacity: 219},
                        {length: 80, capacity: 204},
                        {length: 90, capacity: 191},
                        {length: 100, capacity: 181},
                        {length: 125, capacity: 160},
                        {length: 150, capacity: 145},
                        {length: 175, capacity: 134},
                        {length: 200, capacity: 124},
                        {length: 250, capacity: 110},
                        {length: 300, capacity: 100},
                        {length: 350, capacity: 92},
                        {length: 400, capacity: 86},
                        {length: 450, capacity: 80},
                        {length: 500, capacity: 76}
                    ],
                    "2-1/2": [
                        {length: 10, capacity: 639},
                        {length: 20, capacity: 439},
                        {length: 30, capacity: 352},
                        {length: 40, capacity: 302},
                        {length: 50, capacity: 268},
                        {length: 60, capacity: 243},
                        {length: 70, capacity: 223},
                        {length: 80, capacity: 207},
                        {length: 90, capacity: 194},
                        {length: 100, capacity: 184},
                        {length: 125, capacity: 162},
                        {length: 150, capacity: 147},
                        {length: 175, capacity: 135},
                        {length: 200, capacity: 125},
                        {length: 250, capacity: 111},
                        {length: 300, capacity: 100},
                        {length: 350, capacity: 92},
                        {length: 400, capacity: 86},
                        {length: 450, capacity: 80},
                        {length: 500, capacity: 76}
                    ],
                    "3": [
                        {length: 10, capacity: 1130},
                        {length: 20, capacity: 777},
                        {length: 30, capacity: 624},
                        {length: 40, capacity: 535},
                        {length: 50, capacity: 474},
                        {length: 60, capacity: 429},
                        {length: 70, capacity: 395},
                        {length: 80, capacity: 367},
                        {length: 90, capacity: 344},
                        {length: 100, capacity: 325},
                        {length: 125, capacity: 287},
                        {length: 150, capacity: 260},
                        {length: 175, capacity: 239},
                        {length: 200, capacity: 221},
                        {length: 250, capacity: 196},
                        {length: 300, capacity: 178},
                        {length: 350, capacity: 164},
                        {length: 400, capacity: 152},
                        {length: 450, capacity: 143},
                        {length: 500, capacity: 135}
                    ],
                    "4": [
                        {length: 10, capacity: 2305},
                        {length: 20, capacity: 1585},
                        {length: 30, capacity: 1272},
                        {length: 40, capacity: 1090},
                        {length: 50, capacity: 966},
                        {length: 60, capacity: 875},
                        {length: 70, capacity: 805},
                        {length: 80, capacity: 749},
                        {length: 90, capacity: 703},
                        {length: 100, capacity: 664},
                        {length: 125, capacity: 587},
                        {length: 150, capacity: 532},
                        {length: 175, capacity: 489},
                        {length: 200, capacity: 453},
                        {length: 250, capacity: 402},
                        {length: 300, capacity: 365},
                        {length: 350, capacity: 335},
                        {length: 400, capacity: 311},
                        {length: 450, capacity: 292},
                        {length: 500, capacity: 275}
                    ]
                },
                "2": {
                    "1/2": [
                        {length: 10, capacity: 82},
                        {length: 20, capacity: 56},
                        {length: 30, capacity: 45},
                        {length: 40, capacity: 39},
                        {length: 50, capacity: 34},
                        {length: 60, capacity: 31},
                        {length: 70, capacity: 29},
                        {length: 80, capacity: 27},
                        {length: 90, capacity: 25},
                        {length: 100, capacity: 24},
                        {length: 125, capacity: 21},
                        {length: 150, capacity: 19},
                        {length: 175, capacity: 18},
                        {length: 200, capacity: 16},
                        {length: 250, capacity: 15},
                        {length: 300, capacity: 13},
                        {length: 350, capacity: 12},
                        {length: 400, capacity: 12},
                        {length: 450, capacity: 11},
                        {length: 500, capacity: 10}
                    ],
                    "5/8": [
                        {length: 10, capacity: 179},
                        {length: 20, capacity: 123},
                        {length: 30, capacity: 99},
                        {length: 40, capacity: 85},
                        {length: 50, capacity: 75},
                        {length: 60, capacity: 68},
                        {length: 70, capacity: 63},
                        {length: 80, capacity: 58},
                        {length: 90, capacity: 55},
                        {length: 100, capacity: 51},
                        {length: 125, capacity: 46},
                        {length: 150, capacity: 41},
                        {length: 175, capacity: 38},
                        {length: 200, capacity: 35},
                        {length: 250, capacity: 31},
                        {length: 300, capacity: 28},
                        {length: 350, capacity: 26},
                        {length: 400, capacity: 24},
                        {length: 450, capacity: 23},
                        {length: 500, capacity: 21}
                    ],
                    "3/4": [
                        {length: 10, capacity: 313},
                        {length: 20, capacity: 215},
                        {length: 30, capacity: 173},
                        {length: 40, capacity: 148},
                        {length: 50, capacity: 131},
                        {length: 60, capacity: 119},
                        {length: 70, capacity: 109},
                        {length: 80, capacity: 102},
                        {length: 90, capacity: 95},
                        {length: 100, capacity: 90},
                        {length: 125, capacity: 80},
                        {length: 150, capacity: 72},
                        {length: 175, capacity: 67},
                        {length: 200, capacity: 62},
                        {length: 250, capacity: 55},
                        {length: 300, capacity: 50},
                        {length: 350, capacity: 46},
                        {length: 400, capacity: 43},
                        {length: 450, capacity: 40},
                        {length: 500, capacity: 38}
                    ],
                    "1": [
                        {length: 10, capacity: 570},
                        {length: 20, capacity: 392},
                        {length: 30, capacity: 314},
                        {length: 40, capacity: 270},
                        {length: 50, capacity: 239},
                        {length: 60, capacity: 217},
                        {length: 70, capacity: 199},
                        {length: 80, capacity: 185},
                        {length: 90, capacity: 174},
                        {length: 100, capacity: 164},
                        {length: 125, capacity: 145},
                        {length: 150, capacity: 132},
                        {length: 175, capacity: 121},
                        {length: 200, capacity: 113},
                        {length: 250, capacity: 100},
                        {length: 300, capacity: 90},
                        {length: 350, capacity: 83},
                        {length: 400, capacity: 77},
                        {length: 450, capacity: 72},
                        {length: 500, capacity: 68}
                    ],
                    "1-1/4": [
                        {length: 10, capacity: 1116},
                        {length: 20, capacity: 767},
                        {length: 30, capacity: 615},
                        {length: 40, capacity: 527},
                        {length: 50, capacity: 467},
                        {length: 60, capacity: 423},
                        {length: 70, capacity: 389},
                        {length: 80, capacity: 362},
                        {length: 90, capacity: 340},
                        {length: 100, capacity: 321},
                        {length: 125, capacity: 284},
                        {length: 150, capacity: 258},
                        {length: 175, capacity: 237},
                        {length: 200, capacity: 220},
                        {length: 250, capacity: 195},
                        {length: 300, capacity: 177},
                        {length: 350, capacity: 163},
                        {length: 400, capacity: 151},
                        {length: 450, capacity: 142},
                        {length: 500, capacity: 134}
                    ],
                    "2-1/2": [
                        {length: 10, capacity: 1718},
                        {length: 20, capacity: 1181},
                        {length: 30, capacity: 948},
                        {length: 40, capacity: 812},
                        {length: 50, capacity: 719},
                        {length: 60, capacity: 652},
                        {length: 70, capacity: 600},
                        {length: 80, capacity: 558},
                        {length: 90, capacity: 523},
                        {length: 100, capacity: 494},
                        {length: 125, capacity: 435},
                        {length: 150, capacity: 395},
                        {length: 175, capacity: 362},
                        {length: 200, capacity: 334},
                        {length: 250, capacity: 297},
                        {length: 300, capacity: 269},
                        {length: 350, capacity: 248},
                        {length: 400, capacity: 230},
                        {length: 450, capacity: 216},
                        {length: 500, capacity: 204}
                    ],
                    "3": [
                        {length: 10, capacity: 3038},
                        {length: 20, capacity: 2088},
                        {length: 30, capacity: 1677},
                        {length: 40, capacity: 1435},
                        {length: 50, capacity: 1272},
                        {length: 60, capacity: 1152},
                        {length: 70, capacity: 1060},
                        {length: 80, capacity: 985},
                        {length: 90, capacity: 925},
                        {length: 100, capacity: 874},
                        {length: 125, capacity: 771},
                        {length: 150, capacity: 700},
                        {length: 175, capacity: 643},
                        {length: 200, capacity: 595},
                        {length: 250, capacity: 528},
                        {length: 300, capacity: 479},
                        {length: 350, capacity: 441},
                        {length: 400, capacity: 409},
                        {length: 450, capacity: 384},
                        {length: 500, capacity: 362}
                    ],
                    "4": [
                        {length: 10, capacity: 6196},
                        {length: 20, capacity: 4259},
                        {length: 30, capacity: 3420},
                        {length: 40, capacity: 2927},
                        {length: 50, capacity: 2594},
                        {length: 60, capacity: 2350},
                        {length: 70, capacity: 2162},
                        {length: 80, capacity: 2012},
                        {length: 90, capacity: 1887},
                        {length: 100, capacity: 1783},
                        {length: 125, capacity: 1570},
                        {length: 150, capacity: 1426},
                        {length: 175, capacity: 1309},
                        {length: 200, capacity: 1212},
                        {length: 250, capacity: 1076},
                        {length: 300, capacity: 976},
                        {length: 350, capacity: 898},
                        {length: 400, capacity: 832},
                        {length: 450, capacity: 781},
                        {length: 500, capacity: 737}
                    ]
                }
            },
            propane: {
                schedule40: {
                    "0.5": {
                        "1/2": [
                            {length: 10, capacity: 97},
                            {length: 20, capacity: 67},
                            {length: 30, capacity: 54},
                            {length: 40, capacity: 46},
                            {length: 50, capacity: 41},
                            {length: 60, capacity: 37},
                            {length: 70, capacity: 34},
                            {length: 80, capacity: 32},
                            {length: 90, capacity: 30},
                            {length: 100, capacity: 28},
                            {length: 125, capacity: 25},
                            {length: 150, capacity: 23},
                            {length: 175, capacity: 21},
                            {length: 200, capacity: 19},
                            {length: 250, capacity: 17},
                            {length: 300, capacity: 16},
                            {length: 350, capacity: 14},
                            {length: 400, capacity: 13},
                            {length: 450, capacity: 13},
                            {length: 500, capacity: 12}
                        ],
                        "3/4": [
                            {length: 10, capacity: 202},
                            {length: 20, capacity: 138},
                            {length: 30, capacity: 111},
                            {length: 40, capacity: 96},
                            {length: 50, capacity: 85},
                            {length: 60, capacity: 77},
                            {length: 70, capacity: 71},
                            {length: 80, capacity: 66},
                            {length: 90, capacity: 62},
                            {length: 100, capacity: 59},
                            {length: 125, capacity: 52},
                            {length: 150, capacity: 47},
                            {length: 175, capacity: 43},
                            {length: 200, capacity: 40},
                            {length: 250, capacity: 36},
                            {length: 300, capacity: 32},
                            {length: 350, capacity: 30},
                            {length: 400, capacity: 28},
                            {length: 450, capacity: 26},
                            {length: 500, capacity: 24}
                        ],
                        "1": [
                            {length: 10, capacity: 382},
                            {length: 20, capacity: 263},
                            {length: 30, capacity: 211},
                            {length: 40, capacity: 181},
                            {length: 50, capacity: 160},
                            {length: 60, capacity: 145},
                            {length: 70, capacity: 133},
                            {length: 80, capacity: 124},
                            {length: 90, capacity: 116},
                            {length: 100, capacity: 110},
                            {length: 125, capacity: 97},
                            {length: 150, capacity: 88},
                            {length: 175, capacity: 81},
                            {length: 200, capacity: 76},
                            {length: 250, capacity: 67},
                            {length: 300, capacity: 61},
                            {length: 350, capacity: 56},
                            {length: 400, capacity: 52},
                            {length: 450, capacity: 49},
                            {length: 500, capacity: 46}
                        ],
                        "1-1/4": [
                            {length: 10, capacity: 784},
                            {length: 20, capacity: 539},
                            {length: 30, capacity: 433},
                            {length: 40, capacity: 371},
                            {length: 50, capacity: 328},
                            {length: 60, capacity: 298},
                            {length: 70, capacity: 274},
                            {length: 80, capacity: 254},
                            {length: 90, capacity: 239},
                            {length: 100, capacity: 226},
                            {length: 125, capacity: 200},
                            {length: 150, capacity: 181},
                            {length: 175, capacity: 167},
                            {length: 200, capacity: 155},
                            {length: 250, capacity: 137},
                            {length: 300, capacity: 124},
                            {length: 350, capacity: 115},
                            {length: 400, capacity: 107},
                            {length: 450, capacity: 100},
                            {length: 500, capacity: 95}
                        ],
                        "1-1/2": [
                            {length: 10, capacity: 1175},
                            {length: 20, capacity: 808},
                            {length: 30, capacity: 649},
                            {length: 40, capacity: 555},
                            {length: 50, capacity: 492},
                            {length: 60, capacity: 446},
                            {length: 70, capacity: 410},
                            {length: 80, capacity: 381},
                            {length: 90, capacity: 358},
                            {length: 100, capacity: 338},
                            {length: 125, capacity: 300},
                            {length: 150, capacity: 271},
                            {length: 175, capacity: 250},
                            {length: 200, capacity: 232},
                            {length: 250, capacity: 206},
                            {length: 300, capacity: 186},
                            {length: 350, capacity: 172},
                            {length: 400, capacity: 160},
                            {length: 450, capacity: 150},
                            {length: 500, capacity: 142}
                        ],
                        "2": [
                            {length: 10, capacity: 2160},
                            {length: 20, capacity: 1484},
                            {length: 30, capacity: 1192},
                            {length: 40, capacity: 1020},
                            {length: 50, capacity: 904},
                            {length: 60, capacity: 819},
                            {length: 70, capacity: 753},
                            {length: 80, capacity: 700},
                            {length: 90, capacity: 657},
                            {length: 100, capacity: 621},
                            {length: 125, capacity: 550},
                            {length: 150, capacity: 498},
                            {length: 175, capacity: 458},
                            {length: 200, capacity: 427},
                            {length: 250, capacity: 378},
                            {length: 300, capacity: 343},
                            {length: 350, capacity: 315},
                            {length: 400, capacity: 293},
                            {length: 450, capacity: 275},
                            {length: 500, capacity: 259}
                        ]
                    },
                    "2": {
                        "1/2": [
                            {length: 10, capacity: 172},
                            {length: 20, capacity: 118},
                            {length: 30, capacity: 95},
                            {length: 40, capacity: 81},
                            {length: 50, capacity: 72},
                            {length: 60, capacity: 65},
                            {length: 70, capacity: 60},
                            {length: 80, capacity: 56},
                            {length: 90, capacity: 53},
                            {length: 100, capacity: 50},
                            {length: 125, capacity: 44},
                            {length: 150, capacity: 40},
                            {length: 175, capacity: 37},
                            {length: 200, capacity: 34},
                            {length: 250, capacity: 31},
                            {length: 300, capacity: 28},
                            {length: 350, capacity: 26},
                            {length: 400, capacity: 24},
                            {length: 450, capacity: 22},
                            {length: 500, capacity: 21}
                        ],
                        "3/4": [
                            {length: 10, capacity: 357},
                            {length: 20, capacity: 245},
                            {length: 30, capacity: 197},
                            {length: 40, capacity: 169},
                            {length: 50, capacity: 149},
                            {length: 60, capacity: 135},
                            {length: 70, capacity: 125},
                            {length: 80, capacity: 116},
                            {length: 90, capacity: 109},
                            {length: 100, capacity: 103},
                            {length: 125, capacity: 91},
                            {length: 150, capacity: 83},
                            {length: 175, capacity: 76},
                            {length: 200, capacity: 71},
                            {length: 250, capacity: 63},
                            {length: 300, capacity: 57},
                            {length: 350, capacity: 52},
                            {length: 400, capacity: 49},
                            {length: 450, capacity: 46},
                            {length: 500, capacity: 43}
                        ],
                        "1": [
                            {length: 10, capacity: 679},
                            {length: 20, capacity: 466},
                            {length: 30, capacity: 374},
                            {length: 40, capacity: 320},
                            {length: 50, capacity: 284},
                            {length: 60, capacity: 257},
                            {length: 70, capacity: 237},
                            {length: 80, capacity: 220},
                            {length: 90, capacity: 207},
                            {length: 100, capacity: 195},
                            {length: 125, capacity: 173},
                            {length: 150, capacity: 157},
                            {length: 175, capacity: 144},
                            {length: 200, capacity: 134},
                            {length: 250, capacity: 119},
                            {length: 300, capacity: 108},
                            {length: 350, capacity: 99},
                            {length: 400, capacity: 92},
                            {length: 450, capacity: 86},
                            {length: 500, capacity: 81}
                        ]
                    }
                },
                copper: {
                    "0.5": {
                        "1/2": [
                            {length: 10, capacity: 29},
                            {length: 20, capacity: 20},
                            {length: 30, capacity: 16},
                            {length: 40, capacity: 14},
                            {length: 50, capacity: 12},
                            {length: 60, capacity: 11},
                            {length: 70, capacity: 10},
                            {length: 80, capacity: 9},
                            {length: 90, capacity: 9},
                            {length: 100, capacity: 8},
                            {length: 125, capacity: 7},
                            {length: 150, capacity: 7},
                            {length: 175, capacity: 6},
                            {length: 200, capacity: 6},
                            {length: 250, capacity: 5},
                            {length: 300, capacity: 5},
                            {length: 350, capacity: 4},
                            {length: 400, capacity: 4},
                            {length: 450, capacity: 4},
                            {length: 500, capacity: 4}
                        ],
                        "5/8": [
                            {length: 10, capacity: 63},
                            {length: 20, capacity: 43},
                            {length: 30, capacity: 35},
                            {length: 40, capacity: 30},
                            {length: 50, capacity: 26},
                            {length: 60, capacity: 24},
                            {length: 70, capacity: 22},
                            {length: 80, capacity: 20},
                            {length: 90, capacity: 19},
                            {length: 100, capacity: 18},
                            {length: 125, capacity: 16},
                            {length: 150, capacity: 14},
                            {length: 175, capacity: 13},
                            {length: 200, capacity: 12},
                            {length: 250, capacity: 11},
                            {length: 300, capacity: 10},
                            {length: 350, capacity: 9},
                            {length: 400, capacity: 9},
                            {length: 450, capacity: 8},
                            {length: 500, capacity: 8}
                        ],
                        "3/4": [
                            {length: 10, capacity: 110},
                            {length: 20, capacity: 75},
                            {length: 30, capacity: 60},
                            {length: 40, capacity: 52},
                            {length: 50, capacity: 46},
                            {length: 60, capacity: 42},
                            {length: 70, capacity: 38},
                            {length: 80, capacity: 36},
                            {length: 90, capacity: 34},
                            {length: 100, capacity: 32},
                            {length: 125, capacity: 28},
                            {length: 150, capacity: 26},
                            {length: 175, capacity: 24},
                            {length: 200, capacity: 22},
                            {length: 250, capacity: 19},
                            {length: 300, capacity: 18},
                            {length: 350, capacity: 16},
                            {length: 400, capacity: 15},
                            {length: 450, capacity: 14},
                            {length: 500, capacity: 13}
                        ],
                        "1": [
                            {length: 10, capacity: 200},
                            {length: 20, capacity: 137},
                            {length: 30, capacity: 110},
                            {length: 40, capacity: 94},
                            {length: 50, capacity: 83},
                            {length: 60, capacity: 76},
                            {length: 70, capacity: 70},
                            {length: 80, capacity: 65},
                            {length: 90, capacity: 61},
                            {length: 100, capacity: 57},
                            {length: 125, capacity: 51},
                            {length: 150, capacity: 46},
                            {length: 175, capacity: 42},
                            {length: 200, capacity: 39},
                            {length: 250, capacity: 35},
                            {length: 300, capacity: 32},
                            {length: 350, capacity: 29},
                            {length: 400, capacity: 27},
                            {length: 450, capacity: 26},
                            {length: 500, capacity: 24}
                        ],
                        "1-1/4": [
                            {length: 10, capacity: 391},
                            {length: 20, capacity: 268},
                            {length: 30, capacity: 215},
                            {length: 40, capacity: 184},
                            {length: 50, capacity: 163},
                            {length: 60, capacity: 148},
                            {length: 70, capacity: 136},
                            {length: 80, capacity: 127},
                            {length: 90, capacity: 119},
                            {length: 100, capacity: 112},
                            {length: 125, capacity: 100},
                            {length: 150, capacity: 90},
                            {length: 175, capacity: 83},
                            {length: 200, capacity: 77},
                            {length: 250, capacity: 69},
                            {length: 300, capacity: 62},
                            {length: 350, capacity: 57},
                            {length: 400, capacity: 53},
                            {length: 450, capacity: 50},
                            {length: 500, capacity: 47}
                        ]
                    },
                    "2": {
                        "1/2": [
                            {length: 10, capacity: 273},
                            {length: 20, capacity: 188},
                            {length: 30, capacity: 151},
                            {length: 40, capacity: 129},
                            {length: 50, capacity: 115},
                            {length: 60, capacity: 104},
                            {length: 70, capacity: 96},
                            {length: 80, capacity: 90},
                            {length: 90, capacity: 84},
                            {length: 100, capacity: 79},
                            {length: 125, capacity: 71},
                            {length: 150, capacity: 64},
                            {length: 175, capacity: 59},
                            {length: 200, capacity: 55},
                            {length: 250, capacity: 49},
                            {length: 300, capacity: 44},
                            {length: 350, capacity: 41},
                            {length: 400, capacity: 38},
                            {length: 450, capacity: 36},
                            {length: 500, capacity: 34}
                        ],
                        "3/4": [
                            {length: 10, capacity: 563},
                            {length: 20, capacity: 387},
                            {length: 30, capacity: 311},
                            {length: 40, capacity: 267},
                            {length: 50, capacity: 236},
                            {length: 60, capacity: 215},
                            {length: 70, capacity: 198},
                            {length: 80, capacity: 184},
                            {length: 90, capacity: 172},
                            {length: 100, capacity: 162},
                            {length: 125, capacity: 144},
                            {length: 150, capacity: 131},
                            {length: 175, capacity: 120},
                            {length: 200, capacity: 112},
                            {length: 250, capacity: 99},
                            {length: 300, capacity: 90},
                            {length: 350, capacity: 83},
                            {length: 400, capacity: 77},
                            {length: 450, capacity: 73},
                            {length: 500, capacity: 69}
                        ],
                        "1": [
                            {length: 10, capacity: 1100},
                            {length: 20, capacity: 757},
                            {length: 30, capacity: 608},
                            {length: 40, capacity: 521},
                            {length: 50, capacity: 462},
                            {length: 60, capacity: 420},
                            {length: 70, capacity: 386},
                            {length: 80, capacity: 359},
                            {length: 90, capacity: 336},
                            {length: 100, capacity: 317},
                            {length: 125, capacity: 281},
                            {length: 150, capacity: 255},
                            {length: 175, capacity: 234},
                            {length: 200, capacity: 218},
                            {length: 250, capacity: 193},
                            {length: 300, capacity: 175},
                            {length: 350, capacity: 162},
                            {length: 400, capacity: 150},
                            {length: 450, capacity: 141},
                            {length: 500, capacity: 133}
                        ],
                        "1-1/4": [
                            {length: 10, capacity: 2040},
                            {length: 20, capacity: 1403},
                            {length: 30, capacity: 1126},
                            {length: 40, capacity: 966},
                            {length: 50, capacity: 856},
                            {length: 60, capacity: 778},
                            {length: 70, capacity: 717},
                            {length: 80, capacity: 666},
                            {length: 90, capacity: 624},
                            {length: 100, capacity: 588},
                            {length: 125, capacity: 522},
                            {length: 150, capacity: 473},
                            {length: 175, capacity: 436},
                            {length: 200, capacity: 405},
                            {length: 250, capacity: 359},
                            {length: 300, capacity: 326},
                            {length: 350, capacity: 300},
                            {length: 400, capacity: 279},
                            {length: 450, capacity: 262},
                            {length: 500, capacity: 247}
                        ],
                        "1-1/2": [
                            {length: 10, capacity: 3390},
                            {length: 20, capacity: 2332},
                            {length: 30, capacity: 1872},
                            {length: 40, capacity: 1606},
                            {length: 50, capacity: 1424},
                            {length: 60, capacity: 1294},
                            {length: 70, capacity: 1192},
                            {length: 80, capacity: 1109},
                            {length: 90, capacity: 1038},
                            {length: 100, capacity: 979},
                            {length: 125, capacity: 870},
                            {length: 150, capacity: 788},
                            {length: 175, capacity: 726},
                            {length: 200, capacity: 675},
                            {length: 250, capacity: 599},
                            {length: 300, capacity: 543},
                            {length: 350, capacity: 500},
                            {length: 400, capacity: 465},
                            {length: 450, capacity: 436},
                            {length: 500, capacity: 412}
                        ],
                        "2": [
                            {length: 10, capacity: 6670},
                            {length: 20, capacity: 4588},
                            {length: 30, capacity: 3681},
                            {length: 40, capacity: 3158},
                            {length: 50, capacity: 2800},
                            {length: 60, capacity: 2544},
                            {length: 70, capacity: 2343},
                            {length: 80, capacity: 2180},
                            {length: 90, capacity: 2042},
                            {length: 100, capacity: 1925},
                            {length: 125, capacity: 1711},
                            {length: 150, capacity: 1551},
                            {length: 175, capacity: 1429},
                            {length: 200, capacity: 1329},
                            {length: 250, capacity: 1178},
                            {length: 300, capacity: 1068},
                            {length: 350, capacity: 984},
                            {length: 400, capacity: 915},
                            {length: 450, capacity: 859},
                            {length: 500, capacity: 811}
                        ],
                        "2-1/2": [
                            {length: 10, capacity: 10034},
                            {length: 20, capacity: 6903},
                            {length: 30, capacity: 5542},
                            {length: 40, capacity: 4751},
                            {length: 50, capacity: 4212},
                            {length: 60, capacity: 3827},
                            {length: 70, capacity: 3524},
                            {length: 80, capacity: 3279},
                            {length: 90, capacity: 3071},
                            {length: 100, capacity: 2897},
                            {length: 125, capacity: 2574},
                            {length: 150, capacity: 2333},
                            {length: 175, capacity: 2148},
                            {length: 200, capacity: 1998},
                            {length: 250, capacity: 1770},
                            {length: 300, capacity: 1605},
                            {length: 350, capacity: 1479},
                            {length: 400, capacity: 1375},
                            {length: 450, capacity: 1290},
                            {length: 500, capacity: 1220}
                        ],
                        "3": [
                            {length: 10, capacity: 16134},
                            {length: 20, capacity: 11097},
                            {length: 30, capacity: 8908},
                            {length: 40, capacity: 7638},
                            {length: 50, capacity: 6772},
                            {length: 60, capacity: 6157},
                            {length: 70, capacity: 5665},
                            {length: 80, capacity: 5270},
                            {length: 90, capacity: 4940},
                            {length: 100, capacity: 4661},
                            {length: 125, capacity: 4142},
                            {length: 150, capacity: 3755},
                            {length: 175, capacity: 3456},
                            {length: 200, capacity: 3216},
                            {length: 250, capacity: 2849},
                            {length: 300, capacity: 2584},
                            {length: 350, capacity: 2380},
                            {length: 400, capacity: 2213},
                            {length: 450, capacity: 2077},
                            {length: 500, capacity: 1961}
                        ],
                        "4": [
                            {length: 10, capacity: 34200},
                            {length: 20, capacity: 23524},
                            {length: 30, capacity: 18875},
                            {length: 40, capacity: 16180},
                            {length: 50, capacity: 14343},
                            {length: 60, capacity: 13034},
                            {length: 70, capacity: 11999},
                            {length: 80, capacity: 11156},
                            {length: 90, capacity: 10456},
                            {length: 100, capacity: 9866},
                            {length: 125, capacity: 8765},
                            {length: 150, capacity: 7950},
                            {length: 175, capacity: 7318},
                            {length: 200, capacity: 6808},
                            {length: 250, capacity: 6032},
                            {length: 300, capacity: 5470},
                            {length: 350, capacity: 5038},
                            {length: 400, capacity: 4687},
                            {length: 450, capacity: 4397},
                            {length: 500, capacity: 4153}
                        ]
                    }
                },
                copper: {
                    "0.5": {
                        "1/2": [
                            {length: 10, capacity: 46},
                            {length: 20, capacity: 32},
                            {length: 30, capacity: 25},
                            {length: 40, capacity: 22},
                            {length: 50, capacity: 19},
                            {length: 60, capacity: 18},
                            {length: 70, capacity: 16},
                            {length: 80, capacity: 15},
                            {length: 90, capacity: 14},
                            {length: 100, capacity: 13},
                            {length: 125, capacity: 12},
                            {length: 150, capacity: 11},
                            {length: 175, capacity: 10},
                            {length: 200, capacity: 9},
                            {length: 250, capacity: 8},
                            {length: 300, capacity: 8},
                            {length: 350, capacity: 7},
                            {length: 400, capacity: 7},
                            {length: 450, capacity: 6},
                            {length: 500, capacity: 6}
                        ],
                        "5/8": [
                            {length: 10, capacity: 101},
                            {length: 20, capacity: 69},
                            {length: 30, capacity: 56},
                            {length: 40, capacity: 48},
                            {length: 50, capacity: 42},
                            {length: 60, capacity: 39},
                            {length: 70, capacity: 36},
                            {length: 80, capacity: 33},
                            {length: 90, capacity: 31},
                            {length: 100, capacity: 29},
                            {length: 125, capacity: 26},
                            {length: 150, capacity: 24},
                            {length: 175, capacity: 22},
                            {length: 200, capacity: 20},
                            {length: 250, capacity: 18},
                            {length: 300, capacity: 16},
                            {length: 350, capacity: 15},
                            {length: 400, capacity: 14},
                            {length: 450, capacity: 13},
                            {length: 500, capacity: 13}
                        ],
                        "3/4": [
                            {length: 10, capacity: 173},
                            {length: 20, capacity: 119},
                            {length: 30, capacity: 95},
                            {length: 40, capacity: 82},
                            {length: 50, capacity: 72},
                            {length: 60, capacity: 66},
                            {length: 70, capacity: 61},
                            {length: 80, capacity: 57},
                            {length: 90, capacity: 53},
                            {length: 100, capacity: 50},
                            {length: 125, capacity: 44},
                            {length: 150, capacity: 40},
                            {length: 175, capacity: 37},
                            {length: 200, capacity: 35},
                            {length: 250, capacity: 31},
                            {length: 300, capacity: 28},
                            {length: 350, capacity: 26},
                            {length: 400, capacity: 24},
                            {length: 450, capacity: 23},
                            {length: 500, capacity: 22}
                        ],
                        "1": [
                            {length: 10, capacity: 333},
                            {length: 20, capacity: 229},
                            {length: 30, capacity: 184},
                            {length: 40, capacity: 158},
                            {length: 50, capacity: 140},
                            {length: 60, capacity: 127},
                            {length: 70, capacity: 117},
                            {length: 80, capacity: 109},
                            {length: 90, capacity: 102},
                            {length: 100, capacity: 96},
                            {length: 125, capacity: 86},
                            {length: 150, capacity: 78},
                            {length: 175, capacity: 71},
                            {length: 200, capacity: 66},
                            {length: 250, capacity: 59},
                            {length: 300, capacity: 54},
                            {length: 350, capacity: 50},
                            {length: 400, capacity: 46},
                            {length: 450, capacity: 44},
                            {length: 500, capacity: 41}
                        ],
                        "1-1/4": [
                            {length: 10, capacity: 725},
                            {length: 20, capacity: 498},
                            {length: 30, capacity: 400},
                            {length: 40, capacity: 343},
                            {length: 50, capacity: 304},
                            {length: 60, capacity: 276},
                            {length: 70, capacity: 254},
                            {length: 80, capacity: 236},
                            {length: 90, capacity: 221},
                            {length: 100, capacity: 208},
                            {length: 125, capacity: 185},
                            {length: 150, capacity: 168},
                            {length: 175, capacity: 154},
                            {length: 200, capacity: 143},
                            {length: 250, capacity: 127},
                            {length: 300, capacity: 115},
                            {length: 350, capacity: 106},
                            {length: 400, capacity: 99},
                            {length: 450, capacity: 93},
                            {length: 500, capacity: 88}
                        ],
                        "1-1/2": [
                            {length: 10, capacity: 1206},
                            {length: 20, capacity: 829},
                            {length: 30, capacity: 666},
                            {length: 40, capacity: 571},
                            {length: 50, capacity: 506},
                            {length: 60, capacity: 460},
                            {length: 70, capacity: 423},
                            {length: 80, capacity: 393},
                            {length: 90, capacity: 368},
                            {length: 100, capacity: 347},
                            {length: 125, capacity: 308},
                            {length: 150, capacity: 279},
                            {length: 175, capacity: 256},
                            {length: 200, capacity: 238},
                            {length: 250, capacity: 211},
                            {length: 300, capacity: 191},
                            {length: 350, capacity: 176},
                            {length: 400, capacity: 164},
                            {length: 450, capacity: 154},
                            {length: 500, capacity: 146}
                        ],
                        "2": [
                            {length: 10, capacity: 2367},
                            {length: 20, capacity: 1628},
                            {length: 30, capacity: 1307},
                            {length: 40, capacity: 1121},
                            {length: 50, capacity: 993},
                            {length: 60, capacity: 902},
                            {length: 70, capacity: 830},
                            {length: 80, capacity: 772},
                            {length: 90, capacity: 722},
                            {length: 100, capacity: 681},
                            {length: 125, capacity: 605},
                            {length: 150, capacity: 548},
                            {length: 175, capacity: 504},
                            {length: 200, capacity: 468},
                            {length: 250, capacity: 415},
                            {length: 300, capacity: 376},
                            {length: 350, capacity: 346},
                            {length: 400, capacity: 322},
                            {length: 450, capacity: 302},
                            {length: 500, capacity: 285}
                        ]
                    },
                    "2": {
                        "1/2": [
                            {length: 10, capacity: 99},
                            {length: 20, capacity: 68},
                            {length: 30, capacity: 55},
                            {length: 40, capacity: 47},
                            {length: 50, capacity: 42},
                            {length: 60, capacity: 38},
                            {length: 70, capacity: 35},
                            {length: 80, capacity: 33},
                            {length: 90, capacity: 31},
                            {length: 100, capacity: 29},
                            {length: 125, capacity: 26},
                            {length: 150, capacity: 24},
                            {length: 175, capacity: 22},
                            {length: 200, capacity: 20},
                            {length: 250, capacity: 18},
                            {length: 300, capacity: 16},
                            {length: 350, capacity: 15},
                            {length: 400, capacity: 14},
                            {length: 450, capacity: 13},
                            {length: 500, capacity: 12}
                        ],
                        "5/8": [
                            {length: 10, capacity: 217},
                            {length: 20, capacity: 149},
                            {length: 30, capacity: 120},
                            {length: 40, capacity: 103},
                            {length: 50, capacity: 91},
                            {length: 60, capacity: 83},
                            {length: 70, capacity: 76},
                            {length: 80, capacity: 71},
                            {length: 90, capacity: 67},
                            {length: 100, capacity: 63},
                            {length: 125, capacity: 56},
                            {length: 150, capacity: 51},
                            {length: 175, capacity: 47},
                            {length: 200, capacity: 43},
                            {length: 250, capacity: 39},
                            {length: 300, capacity: 35},
                            {length: 350, capacity: 32},
                            {length: 400, capacity: 30},
                            {length: 450, capacity: 28},
                            {length: 500, capacity: 27}
                        ],
                        "3/4": [
                            {length: 10, capacity: 372},
                            {length: 20, capacity: 256},
                            {length: 30, capacity: 205},
                            {length: 40, capacity: 176},
                            {length: 50, capacity: 156},
                            {length: 60, capacity: 142},
                            {length: 70, capacity: 131},
                            {length: 80, capacity: 122},
                            {length: 90, capacity: 114},
                            {length: 100, capacity: 107},
                            {length: 125, capacity: 96},
                            {length: 150, capacity: 87},
                            {length: 175, capacity: 80},
                            {length: 200, capacity: 74},
                            {length: 250, capacity: 66},
                            {length: 300, capacity: 60},
                            {length: 350, capacity: 55},
                            {length: 400, capacity: 51},
                            {length: 450, capacity: 48},
                            {length: 500, capacity: 46}
                        ],
                        "1": [
                            {length: 10, capacity: 716},
                            {length: 20, capacity: 492},
                            {length: 30, capacity: 395},
                            {length: 40, capacity: 339},
                            {length: 50, capacity: 301},
                            {length: 60, capacity: 273},
                            {length: 70, capacity: 252},
                            {length: 80, capacity: 234},
                            {length: 90, capacity: 219},
                            {length: 100, capacity: 206},
                            {length: 125, capacity: 184},
                            {length: 150, capacity: 166},
                            {length: 175, capacity: 153},
                            {length: 200, capacity: 142},
                            {length: 250, capacity: 126},
                            {length: 300, capacity: 114},
                            {length: 350, capacity: 105},
                            {length: 400, capacity: 98},
                            {length: 450, capacity: 92},
                            {length: 500, capacity: 87}
                        ],
                        "1-1/4": [
                            {length: 10, capacity: 1327},
                            {length: 20, capacity: 913},
                            {length: 30, capacity: 733},
                            {length: 40, capacity: 628},
                            {length: 50, capacity: 557},
                            {length: 60, capacity: 506},
                            {length: 70, capacity: 466},
                            {length: 80, capacity: 433},
                            {length: 90, capacity: 406},
                            {length: 100, capacity: 382},
                            {length: 125, capacity: 340},
                            {length: 150, capacity: 308},
                            {length: 175, capacity: 284},
                            {length: 200, capacity: 264},
                            {length: 250, capacity: 234},
                            {length: 300, capacity: 212},
                            {length: 350, capacity: 195},
                            {length: 400, capacity: 182},
                            {length: 450, capacity: 170},
                            {length: 500, capacity: 161}
                        ],
                        "1-1/2": [
                            {length: 10, capacity: 2205},
                            {length: 20, capacity: 1517},
                            {length: 30, capacity: 1218},
                            {length: 40, capacity: 1044},
                            {length: 50, capacity: 926},
                            {length: 60, capacity: 841},
                            {length: 70, capacity: 774},
                            {length: 80, capacity: 720},
                            {length: 90, capacity: 674},
                            {length: 100, capacity: 636},
                            {length: 125, capacity: 565},
                            {length: 150, capacity: 512},
                            {length: 175, capacity: 472},
                            {length: 200, capacity: 439},
                            {length: 250, capacity: 389},
                            {length: 300, capacity: 353},
                            {length: 350, capacity: 325},
                            {length: 400, capacity: 302},
                            {length: 450, capacity: 284},
                            {length: 500, capacity: 268}
                        ],
                        "2": [
                            {length: 10, capacity: 4329},
                            {length: 20, capacity: 2978},
                            {length: 30, capacity: 2390},
                            {length: 40, capacity: 2049},
                            {length: 50, capacity: 1817},
                            {length: 60, capacity: 1651},
                            {length: 70, capacity: 1520},
                            {length: 80, capacity: 1413},
                            {length: 90, capacity: 1323},
                            {length: 100, capacity: 1247},
                            {length: 125, capacity: 1108},
                            {length: 150, capacity: 1004},
                            {length: 175, capacity: 924},
                            {length: 200, capacity: 860},
                            {length: 250, capacity: 762},
                            {length: 300, capacity: 691},
                            {length: 350, capacity: 637},
                            {length: 400, capacity: 593},
                            {length: 450, capacity: 556},
                            {length: 500, capacity: 525}
                        ]
                    },
                    "5": {
                        "1/2": [
                            {length: 10, capacity: 80},
                            {length: 20, capacity: 55},
                            {length: 30, capacity: 44},
                            {length: 40, capacity: 38},
                            {length: 50, capacity: 34},
                            {length: 60, capacity: 31},
                            {length: 70, capacity: 28},
                            {length: 80, capacity: 26},
                            {length: 90, capacity: 25},
                            {length: 100, capacity: 23},
                            {length: 125, capacity: 21},
                            {length: 150, capacity: 19},
                            {length: 175, capacity: 17},
                            {length: 200, capacity: 16},
                            {length: 250, capacity: 14},
                            {length: 300, capacity: 13},
                            {length: 350, capacity: 12},
                            {length: 400, capacity: 11},
                            {length: 450, capacity: 11},
                            {length: 500, capacity: 10}
                        ],
                        "5/8": [
                            {length: 10, capacity: 175},
                            {length: 20, capacity: 120},
                            {length: 30, capacity: 97},
                            {length: 40, capacity: 83},
                            {length: 50, capacity: 74},
                            {length: 60, capacity: 67},
                            {length: 70, capacity: 62},
                            {length: 80, capacity: 57},
                            {length: 90, capacity: 54},
                            {length: 100, capacity: 51},
                            {length: 125, capacity: 45},
                            {length: 150, capacity: 41},
                            {length: 175, capacity: 38},
                            {length: 200, capacity: 35},
                            {length: 250, capacity: 31},
                            {length: 300, capacity: 28},
                            {length: 350, capacity: 26},
                            {length: 400, capacity: 24},
                            {length: 450, capacity: 23},
                            {length: 500, capacity: 21}
                        ],
                        "3/4": [
                            {length: 10, capacity: 305},
                            {length: 20, capacity: 210},
                            {length: 30, capacity: 169},
                            {length: 40, capacity: 145},
                            {length: 50, capacity: 128},
                            {length: 60, capacity: 116},
                            {length: 70, capacity: 107},
                            {length: 80, capacity: 99},
                            {length: 90, capacity: 93},
                            {length: 100, capacity: 88},
                            {length: 125, capacity: 78},
                            {length: 150, capacity: 71},
                            {length: 175, capacity: 65},
                            {length: 200, capacity: 61},
                            {length: 250, capacity: 54},
                            {length: 300, capacity: 49},
                            {length: 350, capacity: 45},
                            {length: 400, capacity: 42},
                            {length: 450, capacity: 39},
                            {length: 500, capacity: 37}
                        ],
                        "1": [
                            {length: 10, capacity: 580},
                            {length: 20, capacity: 399},
                            {length: 30, capacity: 320},
                            {length: 40, capacity: 274},
                            {length: 50, capacity: 243},
                            {length: 60, capacity: 220},
                            {length: 70, capacity: 203},
                            {length: 80, capacity: 188},
                            {length: 90, capacity: 177},
                            {length: 100, capacity: 167},
                            {length: 125, capacity: 148},
                            {length: 150, capacity: 134},
                            {length: 175, capacity: 123},
                            {length: 200, capacity: 115},
                            {length: 250, capacity: 102},
                            {length: 300, capacity: 92},
                            {length: 350, capacity: 85},
                            {length: 400, capacity: 79},
                            {length: 450, capacity: 74},
                            {length: 500, capacity: 70}
                        ],
                        "1-1/4": [
                            {length: 10, capacity: 1055},
                            {length: 20, capacity: 726},
                            {length: 30, capacity: 583},
                            {length: 40, capacity: 499},
                            {length: 50, capacity: 442},
                            {length: 60, capacity: 401},
                            {length: 70, capacity: 369},
                            {length: 80, capacity: 343},
                            {length: 90, capacity: 322},
                            {length: 100, capacity: 304},
                            {length: 125, capacity: 270},
                            {length: 150, capacity: 244},
                            {length: 175, capacity: 225},
                            {length: 200, capacity: 209},
                            {length: 250, capacity: 185},
                            {length: 300, capacity: 168},
                            {length: 350, capacity: 155},
                            {length: 400, capacity: 144},
                            {length: 450, capacity: 135},
                            {length: 500, capacity: 127}
                        ],
                        "1-1/2": [
                            {length: 10, capacity: 1752},
                            {length: 20, capacity: 1205},
                            {length: 30, capacity: 967},
                            {length: 40, capacity: 829},
                            {length: 50, capacity: 735},
                            {length: 60, capacity: 667},
                            {length: 70, capacity: 614},
                            {length: 80, capacity: 571},
                            {length: 90, capacity: 536},
                            {length: 100, capacity: 506},
                            {length: 125, capacity: 449},
                            {length: 150, capacity: 407},
                            {length: 175, capacity: 375},
                            {length: 200, capacity: 348},
                            {length: 250, capacity: 309},
                            {length: 300, capacity: 280},
                            {length: 350, capacity: 258},
                            {length: 400, capacity: 240},
                            {length: 450, capacity: 225},
                            {length: 500, capacity: 212}
                        ],
                        "2": [
                            {length: 10, capacity: 3225},
                            {length: 20, capacity: 2219},
                            {length: 30, capacity: 1781},
                            {length: 40, capacity: 1527},
                            {length: 50, capacity: 1353},
                            {length: 60, capacity: 1229},
                            {length: 70, capacity: 1131},
                            {length: 80, capacity: 1052},
                            {length: 90, capacity: 987},
                            {length: 100, capacity: 931},
                            {length: 125, capacity: 827},
                            {length: 150, capacity: 750},
                            {length: 175, capacity: 690},
                            {length: 200, capacity: 642},
                            {length: 250, capacity: 569},
                            {length: 300, capacity: 516},
                            {length: 350, capacity: 476},
                            {length: 400, capacity: 442},
                            {length: 450, capacity: 415},
                            {length: 500, capacity: 392}
                        ],
                        "2-1/2": [
                            {length: 10, capacity: 6370},
                            {length: 20, capacity: 4383},
                            {length: 30, capacity: 3517},
                            {length: 40, capacity: 3016},
                            {length: 50, capacity: 2675},
                            {length: 60, capacity: 2429},
                            {length: 70, capacity: 2237},
                            {length: 80, capacity: 2081},
                            {length: 90, capacity: 1952},
                            {length: 100, capacity: 1841},
                            {length: 125, capacity: 1636},
                            {length: 150, capacity: 1483},
                            {length: 175, capacity: 1365},
                            {length: 200, capacity: 1270},
                            {length: 250, capacity: 1125},
                            {length: 300, capacity: 1020},
                            {length: 350, capacity: 940},
                            {length: 400, capacity: 874},
                            {length: 450, capacity: 820},
                            {length: 500, capacity: 774}
                        ],
                        "3": [
                            {length: 10, capacity: 10245},
                            {length: 20, capacity: 7051},
                            {length: 30, capacity: 5661},
                            {length: 40, capacity: 4853},
                            {length: 50, capacity: 4303},
                            {length: 60, capacity: 3910},
                            {length: 70, capacity: 3600},
                            {length: 80, capacity: 3349},
                            {length: 90, capacity: 3141},
                            {length: 100, capacity: 2963},
                            {length: 125, capacity: 2632},
                            {length: 150, capacity: 2388},
                            {length: 175, capacity: 2197},
                            {length: 200, capacity: 2044},
                            {length: 250, capacity: 1811},
                            {length: 300, capacity: 1642},
                            {length: 350, capacity: 1513},
                            {length: 400, capacity: 1406},
                            {length: 450, capacity: 1319},
                            {length: 500, capacity: 1245}
                        ],
                        "4": [
                            {length: 10, capacity: 20905},
                            {length: 20, capacity: 14384},
                            {length: 30, capacity: 11543},
                            {length: 40, capacity: 9895},
                            {length: 50, capacity: 8775},
                            {length: 60, capacity: 7971},
                            {length: 70, capacity: 7339},
                            {length: 80, capacity: 6826},
                            {length: 90, capacity: 6403},
                            {length: 100, capacity: 6044},
                            {length: 125, capacity: 5371},
                            {length: 150, capacity: 4870},
                            {length: 175, capacity: 4483},
                            {length: 200, capacity: 4169},
                            {length: 250, capacity: 3694},
                            {length: 300, capacity: 3349},
                            {length: 350, capacity: 3087},
                            {length: 400, capacity: 2871},
                            {length: 450, capacity: 2692},
                            {length: 500, capacity: 2542}
                        ]
                    },
                    "10": {
                        "1/2": [
                            {length: 10, capacity: 116},
                            {length: 20, capacity: 80},
                            {length: 30, capacity: 64},
                            {length: 40, capacity: 55},
                            {length: 50, capacity: 49},
                            {length: 60, capacity: 44},
                            {length: 70, capacity: 41},
                            {length: 80, capacity: 38},
                            {length: 90, capacity: 36},
                            {length: 100, capacity: 34},
                            {length: 125, capacity: 30},
                            {length: 150, capacity: 27},
                            {length: 175, capacity: 25},
                            {length: 200, capacity: 23},
                            {length: 250, capacity: 21},
                            {length: 300, capacity: 19},
                            {length: 350, capacity: 17},
                            {length: 400, capacity: 16},
                            {length: 450, capacity: 15},
                            {length: 500, capacity: 15}
                        ],
                        "5/8": [
                            {length: 10, capacity: 254},
                            {length: 20, capacity: 175},
                            {length: 30, capacity: 140},
                            {length: 40, capacity: 120},
                            {length: 50, capacity: 107},
                            {length: 60, capacity: 97},
                            {length: 70, capacity: 89},
                            {length: 80, capacity: 83},
                            {length: 90, capacity: 78},
                            {length: 100, capacity: 74},
                            {length: 125, capacity: 65},
                            {length: 150, capacity: 59},
                            {length: 175, capacity: 54},
                            {length: 200, capacity: 51},
                            {length: 250, capacity: 45},
                            {length: 300, capacity: 41},
                            {length: 350, capacity: 38},
                            {length: 400, capacity: 35},
                            {length: 450, capacity: 33},
                            {length: 500, capacity: 31}
                        ],
                        "3/4": [
                            {length: 10, capacity: 443},
                            {length: 20, capacity: 305},
                            {length: 30, capacity: 245},
                            {length: 40, capacity: 210},
                            {length: 50, capacity: 186},
                            {length: 60, capacity: 169},
                            {length: 70, capacity: 156},
                            {length: 80, capacity: 145},
                            {length: 90, capacity: 136},
                            {length: 100, capacity: 128},
                            {length: 125, capacity: 114},
                            {length: 150, capacity: 103},
                            {length: 175, capacity: 95},
                            {length: 200, capacity: 88},
                            {length: 250, capacity: 78},
                            {length: 300, capacity: 71},
                            {length: 350, capacity: 65},
                            {length: 400, capacity: 61},
                            {length: 450, capacity: 57},
                            {length: 500, capacity: 54}
                        ],
                        "1": [
                            {length: 10, capacity: 842},
                            {length: 20, capacity: 580},
                            {length: 30, capacity: 465},
                            {length: 40, capacity: 399},
                            {length: 50, capacity: 353},
                            {length: 60, capacity: 321},
                            {length: 70, capacity: 295},
                            {length: 80, capacity: 274},
                            {length: 90, capacity: 257},
                            {length: 100, capacity: 243},
                            {length: 125, capacity: 216},
                            {length: 150, capacity: 195},
                            {length: 175, capacity: 180},
                            {length: 200, capacity: 167},
                            {length: 250, capacity: 148},
                            {length: 300, capacity: 134},
                            {length: 350, capacity: 124},
                            {length: 400, capacity: 115},
                            {length: 450, capacity: 108},
                            {length: 500, capacity: 102}
                        ],
                        "1-1/4": [
                            {length: 10, capacity: 1531},
                            {length: 20, capacity: 1053},
                            {length: 30, capacity: 846},
                            {length: 40, capacity: 725},
                            {length: 50, capacity: 642},
                            {length: 60, capacity: 583},
                            {length: 70, capacity: 537},
                            {length: 80, capacity: 499},
                            {length: 90, capacity: 468},
                            {length: 100, capacity: 442},
                            {length: 125, capacity: 392},
                            {length: 150, capacity: 356},
                            {length: 175, capacity: 327},
                            {length: 200, capacity: 304},
                            {length: 250, capacity: 270},
                            {length: 300, capacity: 245},
                            {length: 350, capacity: 225},
                            {length: 400, capacity: 209},
                            {length: 450, capacity: 196},
                            {length: 500, capacity: 185}
                        ],
                        "1-1/2": [
                            {length: 10, capacity: 2544},
                            {length: 20, capacity: 1751},
                            {length: 30, capacity: 1405},
                            {length: 40, capacity: 1205},
                            {length: 50, capacity: 1068},
                            {length: 60, capacity: 970},
                            {length: 70, capacity: 893},
                            {length: 80, capacity: 830},
                            {length: 90, capacity: 779},
                            {length: 100, capacity: 735},
                            {length: 125, capacity: 653},
                            {length: 150, capacity: 592},
                            {length: 175, capacity: 545},
                            {length: 200, capacity: 507},
                            {length: 250, capacity: 449},
                            {length: 300, capacity: 407},
                            {length: 350, capacity: 375},
                            {length: 400, capacity: 349},
                            {length: 450, capacity: 327},
                            {length: 500, capacity: 309}
                        ],
                        "2": [
                            {length: 10, capacity: 4684},
                            {length: 20, capacity: 3223},
                            {length: 30, capacity: 2587},
                            {length: 40, capacity: 2218},
                            {length: 50, capacity: 1965},
                            {length: 60, capacity: 1786},
                            {length: 70, capacity: 1645},
                            {length: 80, capacity: 1530},
                            {length: 90, capacity: 1434},
                            {length: 100, capacity: 1353},
                            {length: 125, capacity: 1203},
                            {length: 150, capacity: 1091},
                            {length: 175, capacity: 1004},
                            {length: 200, capacity: 934},
                            {length: 250, capacity: 827},
                            {length: 300, capacity: 750},
                            {length: 350, capacity: 691},
                            {length: 400, capacity: 642},
                            {length: 450, capacity: 602},
                            {length: 500, capacity: 569}
                        ],
                        "2-1/2": [
                            {length: 10, capacity: 9252},
                            {length: 20, capacity: 6367},
                            {length: 30, capacity: 5111},
                            {length: 40, capacity: 4382},
                            {length: 50, capacity: 3885},
                            {length: 60, capacity: 3528},
                            {length: 70, capacity: 3249},
                            {length: 80, capacity: 3023},
                            {length: 90, capacity: 2835},
                            {length: 100, capacity: 2675},
                            {length: 125, capacity: 2377},
                            {length: 150, capacity: 2155},
                            {length: 175, capacity: 1984},
                            {length: 200, capacity: 1847},
                            {length: 250, capacity: 1636},
                            {length: 300, capacity: 1483},
                            {length: 350, capacity: 1366},
                            {length: 400, capacity: 1270},
                            {length: 450, capacity: 1192},
                            {length: 500, capacity: 1125}
                        ],
                        "3": [
                            {length: 10, capacity: 14871},
                            {length: 20, capacity: 10236},
                            {length: 30, capacity: 8212},
                            {length: 40, capacity: 7038},
                            {length: 50, capacity: 6239},
                            {length: 60, capacity: 5667},
                            {length: 70, capacity: 5220},
                            {length: 80, capacity: 4855},
                            {length: 90, capacity: 4551},
                            {length: 100, capacity: 4294},
                            {length: 125, capacity: 3817},
                            {length: 150, capacity: 3463},
                            {length: 175, capacity: 3188},
                            {length: 200, capacity: 2965},
                            {length: 250, capacity: 2627},
                            {length: 300, capacity: 2383},
                            {length: 350, capacity: 2196},
                            {length: 400, capacity: 2042},
                            {length: 450, capacity: 1914},
                            {length: 500, capacity: 1808}
                        ],
                        "4": [
                            {length: 10, capacity: 30370},
                            {length: 20, capacity: 20902},
                            {length: 30, capacity: 16772},
                            {length: 40, capacity: 14381},
                            {length: 50, capacity: 12748},
                            {length: 60, capacity: 11583},
                            {length: 70, capacity: 10667},
                            {length: 80, capacity: 9926},
                            {length: 90, capacity: 9307},
                            {length: 100, capacity: 8779},
                            {length: 125, capacity: 7805},
                            {length: 150, capacity: 7078},
                            {length: 175, capacity: 6517},
                            {length: 200, capacity: 6062},
                            {length: 250, capacity: 5372},
                            {length: 300, capacity: 4871},
                            {length: 350, capacity: 4489},
                            {length: 400, capacity: 4172},
                            {length: 450, capacity: 3915},
                            {length: 500, capacity: 3696}
                        ]
                    },
                    "20": {
                        "1/2": [
                            {length: 10, capacity: 168},
                            {length: 20, capacity: 116},
                            {length: 30, capacity: 93},
                            {length: 40, capacity: 80},
                            {length: 50, capacity: 71},
                            {length: 60, capacity: 64},
                            {length: 70, capacity: 59},
                            {length: 80, capacity: 55},
                            {length: 90, capacity: 52},
                            {length: 100, capacity: 49},
                            {length: 125, capacity: 44},
                            {length: 150, capacity: 40},
                            {length: 175, capacity: 37},
                            {length: 200, capacity: 34},
                            {length: 250, capacity: 30},
                            {length: 300, capacity: 28},
                            {length: 350, capacity: 26},
                            {length: 400, capacity: 24},
                            {length: 450, capacity: 22},
                            {length: 500, capacity: 21}
                        ],
                        "5/8": [
                            {length: 10, capacity: 369},
                            {length: 20, capacity: 254},
                            {length: 30, capacity: 204},
                            {length: 40, capacity: 175},
                            {length: 50, capacity: 155},
                            {length: 60, capacity: 141},
                            {length: 70, capacity: 130},
                            {length: 80, capacity: 121},
                            {length: 90, capacity: 113},
                            {length: 100, capacity: 107},
                            {length: 125, capacity: 95},
                            {length: 150, capacity: 86},
                            {length: 175, capacity: 79},
                            {length: 200, capacity: 74},
                            {length: 250, capacity: 65},
                            {length: 300, capacity: 59},
                            {length: 350, capacity: 55},
                            {length: 400, capacity: 51},
                            {length: 450, capacity: 48},
                            {length: 500, capacity: 45}
                        ],
                        "3/4": [
                            {length: 10, capacity: 643},
                            {length: 20, capacity: 442},
                            {length: 30, capacity: 355},
                            {length: 40, capacity: 305},
                            {length: 50, capacity: 270},
                            {length: 60, capacity: 245},
                            {length: 70, capacity: 226},
                            {length: 80, capacity: 210},
                            {length: 90, capacity: 197},
                            {length: 100, capacity: 186},
                            {length: 125, capacity: 165},
                            {length: 150, capacity: 150},
                            {length: 175, capacity: 138},
                            {length: 200, capacity: 128},
                            {length: 250, capacity: 114},
                            {length: 300, capacity: 103},
                            {length: 350, capacity: 95},
                            {length: 400, capacity: 88},
                            {length: 450, capacity: 83},
                            {length: 500, capacity: 78}
                        ],
                        "1": [
                            {length: 10, capacity: 1222},
                            {length: 20, capacity: 841},
                            {length: 30, capacity: 675},
                            {length: 40, capacity: 579},
                            {length: 50, capacity: 513},
                            {length: 60, capacity: 466},
                            {length: 70, capacity: 429},
                            {length: 80, capacity: 399},
                            {length: 90, capacity: 374},
                            {length: 100, capacity: 353},
                            {length: 125, capacity: 314},
                            {length: 150, capacity: 285},
                            {length: 175, capacity: 262},
                            {length: 200, capacity: 243},
                            {length: 250, capacity: 215},
                            {length: 300, capacity: 195},
                            {length: 350, capacity: 180},
                            {length: 400, capacity: 167},
                            {length: 450, capacity: 157},
                            {length: 500, capacity: 148}
                        ],
                        "1-1/4": [
                            {length: 10, capacity: 2222},
                            {length: 20, capacity: 1529},
                            {length: 30, capacity: 1228},
                            {length: 40, capacity: 1053},
                            {length: 50, capacity: 933},
                            {length: 60, capacity: 848},
                            {length: 70, capacity: 781},
                            {length: 80, capacity: 726},
                            {length: 90, capacity: 681},
                            {length: 100, capacity: 642},
                            {length: 125, capacity: 571},
                            {length: 150, capacity: 518},
                            {length: 175, capacity: 477},
                            {length: 200, capacity: 443},
                            {length: 250, capacity: 393},
                            {length: 300, capacity: 356},
                            {length: 350, capacity: 328},
                            {length: 400, capacity: 305},
                            {length: 450, capacity: 286},
                            {length: 500, capacity: 270}
                        ],
                        "1-1/2": [
                            {length: 10, capacity: 3694},
                            {length: 20, capacity: 2543},
                            {length: 30, capacity: 2041},
                            {length: 40, capacity: 1750},
                            {length: 50, capacity: 1552},
                            {length: 60, capacity: 1410},
                            {length: 70, capacity: 1298},
                            {length: 80, capacity: 1207},
                            {length: 90, capacity: 1132},
                            {length: 100, capacity: 1068},
                            {length: 125, capacity: 950},
                            {length: 150, capacity: 861},
                            {length: 175, capacity: 793},
                            {length: 200, capacity: 737},
                            {length: 250, capacity: 653},
                            {length: 300, capacity: 592},
                            {length: 350, capacity: 546},
                            {length: 400, capacity: 507},
                            {length: 450, capacity: 476},
                            {length: 500, capacity: 449}
                        ],
                        "2": [
                            {length: 10, capacity: 6804},
                            {length: 20, capacity: 4684},
                            {length: 30, capacity: 3760},
                            {length: 40, capacity: 3223},
                            {length: 50, capacity: 2858},
                            {length: 60, capacity: 2596},
                            {length: 70, capacity: 2390},
                            {length: 80, capacity: 2222},
                            {length: 90, capacity: 2084},
                            {length: 100, capacity: 1966},
                            {length: 125, capacity: 1748},
                            {length: 150, capacity: 1585},
                            {length: 175, capacity: 1459},
                            {length: 200, capacity: 1357},
                            {length: 250, capacity: 1203},
                            {length: 300, capacity: 1091},
                            {length: 350, capacity: 1005},
                            {length: 400, capacity: 934},
                            {length: 450, capacity: 876},
                            {length: 500, capacity: 827}
                        ],
                        "2-1/2": [
                            {length: 10, capacity: 13440},
                            {length: 20, capacity: 9253},
                            {length: 30, capacity: 7429},
                            {length: 40, capacity: 6368},
                            {length: 50, capacity: 5649},
                            {length: 60, capacity: 5130},
                            {length: 70, capacity: 4725},
                            {length: 80, capacity: 4394},
                            {length: 90, capacity: 4122},
                            {length: 100, capacity: 3889},
                            {length: 125, capacity: 3458},
                            {length: 150, capacity: 3134},
                            {length: 175, capacity: 2886},
                            {length: 200, capacity: 2685},
                            {length: 250, capacity: 2379},
                            {length: 300, capacity: 2157},
                            {length: 350, capacity: 1988},
                            {length: 400, capacity: 1848},
                            {length: 450, capacity: 1733},
                            {length: 500, capacity: 1637}
                        ],
                        "3": [
                            {length: 10, capacity: 21608},
                            {length: 20, capacity: 14871},
                            {length: 30, capacity: 11937},
                            {length: 40, capacity: 10236},
                            {length: 50, capacity: 9075},
                            {length: 60, capacity: 8246},
                            {length: 70, capacity: 7595},
                            {length: 80, capacity: 7065},
                            {length: 90, capacity: 6623},
                            {length: 100, capacity: 6248},
                            {length: 125, capacity: 5553},
                            {length: 150, capacity: 5037},
                            {length: 175, capacity: 4637},
                            {length: 200, capacity: 4314},
                            {length: 250, capacity: 3824},
                            {length: 300, capacity: 3468},
                            {length: 350, capacity: 3196},
                            {length: 400, capacity: 2971},
                            {length: 450, capacity: 2786},
                            {length: 500, capacity: 2631}
                        ],
                        "4": [
                            {length: 10, capacity: 44140},
                            {length: 20, capacity: 30370},
                            {length: 30, capacity: 24384},
                            {length: 40, capacity: 20903},
                            {length: 50, capacity: 18537},
                            {length: 60, capacity: 16843},
                            {length: 70, capacity: 15515},
                            {length: 80, capacity: 14432},
                            {length: 90, capacity: 13534},
                            {length: 100, capacity: 12774},
                            {length: 125, capacity: 11355},
                            {length: 150, capacity: 10296},
                            {length: 175, capacity: 9484},
                            {length: 200, capacity: 8819},
                            {length: 250, capacity: 7815},
                            {length: 300, capacity: 7088},
                            {length: 350, capacity: 6532},
                            {length: 400, capacity: 6072},
                            {length: 450, capacity: 5695},
                            {length: 500, capacity: 5380}
                        ]
                    }
                }
            }
        };

        function addAppliance() {
            const appliancesList = document.getElementById('appliancesList');
            const applianceItem = document.createElement('div');
            applianceItem.className = 'appliance-item';
            applianceItem.innerHTML = `
                <button class="remove-appliance" onclick="removeAppliance(this)">×</button>
                <label>Appliance Name:</label>
                <input type="text" class="appliance-name" placeholder="e.g., Water Heater" maxlength="50">
                <label style="margin-top: 10px;">Capacity (Btu/h):</label>
                <input type="number" class="appliance-btuh" placeholder="Enter Btu/h" min="1" max="10000000" step="1">
                <div class="appliance-error" style="color: red; font-size: 12px; margin-top: 5px; display: none;"></div>
            `;
            appliancesList.appendChild(applianceItem);
            updateTotal();
            
            // Focus on the name field of the new appliance
            const nameInput = applianceItem.querySelector('.appliance-name');
            nameInput.focus();
        }

        function removeAppliance(button) {
            button.parentElement.remove();
            updateTotal();
            
            // Auto-recalculate after removing appliance if results are showing
            setTimeout(function() {
                const resultsDiv = document.getElementById('results');
                const totalResult = updateTotal();
                
                if (totalResult.isValid && resultsDiv.innerHTML.trim() !== '') {
                    calculatePipeSize();
                } else if (!totalResult.isValid && resultsDiv.innerHTML.trim() !== '') {
                    // Clear results if no valid appliances remain
                    resultsDiv.innerHTML = '';
                }
            }, 100);
        }

        function clearAll() {
            // Confirm with user before clearing
            if (confirm('Are you sure you want to clear all data and start fresh? This cannot be undone.')) {
                // Clear all appliances
                const appliancesList = document.getElementById('appliancesList');
                appliancesList.innerHTML = '';
                
                // Reset all input fields to defaults
                document.getElementById('lmr').value = '';
                document.getElementById('pipeType').value = 'schedule40';
                document.getElementById('pressure').value = 'low';
                document.getElementById('gasType').value = 'natural';
                document.getElementById('gasRelativeDensity').value = '';
                
                // Clear results
                document.getElementById('results').innerHTML = '';
                
                // Reset total display
                document.getElementById('totalBtuh').textContent = '0 Btu/h';
                document.getElementById('totalBtuh').style.color = '#1976d2';
                document.getElementById('totalBtuh').style.fontWeight = 'bold';
                
                // Add initial appliance
                addAppliance();
                
                // Clear any running timeouts
                if (window.autoCalcTimeout) clearTimeout(window.autoCalcTimeout);
                if (window.applianceCalcTimeout) clearTimeout(window.applianceCalcTimeout);
                
                console.log('Calculator cleared and reset to initial state');
            }
        }

        function validateAppliance(applianceItem) {
            if (!applianceItem) return false;
            
            const nameInput = applianceItem.querySelector('.appliance-name');
            const btuInput = applianceItem.querySelector('.appliance-btuh');
            const errorDiv = applianceItem.querySelector('.appliance-error');
            
            // Check if all required elements exist
            if (!nameInput || !btuInput || !errorDiv) {
                return false;
            }
            
            const name = nameInput.value.trim();
            const btuValue = parseFloat(btuInput.value);
            let errors = [];

            // Clear previous error styling
            nameInput.style.borderColor = '';
            btuInput.style.borderColor = '';
            errorDiv.style.display = 'none';

            // Validate name (warnings only - don't prevent calculation)
            if (!name) {
                // Just show border color but don't add to errors for calculation blocking
                nameInput.style.borderColor = 'orange';
            } else if (name.length < 2) {
                nameInput.style.borderColor = 'orange';
            } else {
                // Check for duplicate names (warning only)
                const allNames = Array.from(document.querySelectorAll('.appliance-name'))
                    .map(input => input.value.trim().toLowerCase())
                    .filter(n => n);
                const duplicateCount = allNames.filter(n => n === name.toLowerCase()).length;
                if (duplicateCount > 1) {
                    nameInput.style.borderColor = 'orange';
                }
            }

            // Validate Btu/h value
            if (!btuInput.value || isNaN(btuValue)) {
                errors.push('Valid Btu/h capacity is required');
                btuInput.style.borderColor = 'red';
            } else if (btuValue <= 0) {
                errors.push('Btu/h capacity must be greater than 0');
                btuInput.style.borderColor = 'red';
            } else if (btuValue > 10000000) {
                errors.push('Btu/h capacity cannot exceed 10,000,000');
                btuInput.style.borderColor = 'red';
            }

            if (errors.length > 0) {
                errorDiv.textContent = errors.join('. ');
                errorDiv.style.display = 'block';
                return false;
            }

            return true;
        }

        function updateTotal() {
            const applianceItems = document.querySelectorAll('.appliance-item');
            let total = 0;
            let allValid = true;

            applianceItems.forEach(item => {
                const btuInput = item.querySelector('.appliance-btuh');
                if (btuInput) {
                    const value = parseFloat(btuInput.value) || 0;
                    
                    // Add to total if value is positive, regardless of other validation
                    if (value > 0) {
                        total += value;
                    }
                }
                
                // Check validation separately
                const isValid = validateAppliance(item);
                if (!isValid) {
                    allValid = false;
                }
            });

            document.getElementById('totalBtuh').textContent = total.toLocaleString() + ' Btu/h';
            
            // Update total display styling based on validation
            const totalDisplay = document.getElementById('totalBtuh');
            if (!allValid && applianceItems.length > 0) {
                totalDisplay.style.color = '#d32f2f';
                totalDisplay.style.fontWeight = 'bold';
            } else if (total === 0 && applianceItems.length > 0) {
                totalDisplay.style.color = '#f57c00';
                totalDisplay.style.fontWeight = 'bold';
            } else {
                totalDisplay.style.color = '#1976d2';
                totalDisplay.style.fontWeight = 'bold';
            }

            return {
                isValid: total > 0, // Only require total > 0 for calculation
                total: total,
                allValid: allValid
            };
        }

        // Update total when appliance values change
        document.addEventListener('input', function(e) {
            if (e.target.classList.contains('appliance-btuh') || e.target.classList.contains('appliance-name')) {
                updateTotal();
                
                // Auto-recalculate if BTU value changed and results are showing
                if (e.target.classList.contains('appliance-btuh')) {
                    clearTimeout(window.applianceCalcTimeout);
                    window.applianceCalcTimeout = setTimeout(function() {
                        const resultsDiv = document.getElementById('results');
                        const totalResult = updateTotal();
                        
                        if (totalResult.isValid && resultsDiv.innerHTML.trim() !== '') {
                            calculatePipeSize();
                        }
                    }, 800); // Longer delay for appliance inputs to allow user to finish entering values
                }
            }
        });

        // Add validation on blur for immediate feedback
        document.addEventListener('blur', function(e) {
            if (e.target.classList.contains('appliance-btuh') || e.target.classList.contains('appliance-name')) {
                const applianceItem = e.target.closest('.appliance-item');
                if (applianceItem) {
                    validateAppliance(applianceItem);
                    updateTotal();
                }
            }
        }, true);

        // Auto-recalculate when any input changes
        document.addEventListener('change', function(e) {
            // Check if the changed element is one of the calculation inputs
            if (e.target.id === 'lmr' || 
                e.target.id === 'pipeType' || 
                e.target.id === 'pressure' || 
                e.target.id === 'gasType' || 
                e.target.id === 'gasRelativeDensity') {
                
                // Delay calculation slightly to allow for proper value updates
                setTimeout(function() {
                    // Only auto-calculate if we have appliances and results are currently showing
                    const resultsDiv = document.getElementById('results');
                    const totalResult = updateTotal();
                    
                    if (totalResult.isValid && resultsDiv.innerHTML.trim() !== '') {
                        calculatePipeSize();
                    }
                }, 100);
            }
        });

        // Auto-recalculate when LMR input changes (input event for real-time updates)
        document.addEventListener('input', function(e) {
            if (e.target.id === 'lmr' || e.target.id === 'gasRelativeDensity') {
                // Debounce the calculation to avoid excessive calculations during typing
                clearTimeout(window.autoCalcTimeout);
                window.autoCalcTimeout = setTimeout(function() {
                    const resultsDiv = document.getElementById('results');
                    const totalResult = updateTotal();
                    
                    if (totalResult.isValid && resultsDiv.innerHTML.trim() !== '') {
                        calculatePipeSize();
                    }
                }, 500); // Wait 500ms after user stops typing
            }
        });

        function interpolateCapacity(length, capacityData) {
            // Find the closest length values in the table
            let lowerBound = null;
            let upperBound = null;

            for (let i = 0; i < capacityData.length; i++) {
                if (capacityData[i].length <= length) {
                    lowerBound = capacityData[i];
                }
                if (capacityData[i].length >= length && !upperBound) {
                    upperBound = capacityData[i];
                    break;
                }
            }

            if (!lowerBound && upperBound) {
                return upperBound.capacity;
            }
            if (lowerBound && !upperBound) {
                return lowerBound.capacity;
            }
            if (lowerBound && upperBound && lowerBound.length === upperBound.length) {
                return lowerBound.capacity;
            }
            if (lowerBound && upperBound) {
                // Linear interpolation
                const ratio = (length - lowerBound.length) / (upperBound.length - lowerBound.length);
                return lowerBound.capacity + ratio * (upperBound.capacity - lowerBound.capacity);
            }

            return 0;
        }

        function findRequiredPipeSize(totalBtuh, lmr, pipeType, pressure, gasType = 'natural', customDensity = null) {
            // Convert BTU/h to Mbtu/h (capacity tables are in thousands of BTU/h)
            const totalMbtuh = totalBtuh / 1000;
            
            // Map UI pressure values to table keys
            const pressureMap = {
                'low': '0.5',    // Less than 7" w.c. - use Table A.1 (low pressure tables)
                'medium': 'A2',  // 7" to 14" w.c. - use Table A.2 
                '2': '2',        // 2 psig
                '5': '5',        // 5 psig
                '10': '10',      // 10 psig
                '20': '20'       // 20 psig
            };
            
            const mappedPressure = pressureMap[pressure] || '0.5';
            
            let tables;
            if (gasType === 'propane') {
                tables = extendedCapacityTables.propane[pipeType][mappedPressure];
            } else {
                tables = extendedCapacityTables[pipeType][mappedPressure];
            }
            
            if (!tables) {
                return null;
            }
            
            // Apply gas density adjustment if custom density is provided
            let densityMultiplier = 1.0;
            let actualDensity = null;
            
            if (customDensity && customDensity > 0) {
                actualDensity = customDensity;
                densityMultiplier = getRelativeDensityMultiplier(customDensity);
            } else {
                // Use standard densities
                actualDensity = gasType === 'propane' ? 1.5 : 0.6;
                densityMultiplier = getRelativeDensityMultiplier(actualDensity);
            }
            
            // Get pipe sizes and sort them to ensure we find the smallest adequate size
            const pipeSizes = Object.keys(tables).sort((a, b) => {
                // Convert fractions and decimals to numbers for proper sorting
                const parseSize = (size) => {
                    if (size.includes('/')) {
                        const [num, den] = size.split('/').map(Number);
                        return num / den;
                    }
                    if (size.includes('-')) {
                        const [whole, frac] = size.split('-');
                        const [num, den] = frac.split('/').map(Number);
                        return Number(whole) + (num / den);
                    }
                    return Number(size);
                };
                return parseSize(a) - parseSize(b);
            });
            
            for (let size of pipeSizes) {
                const baseCapacity = interpolateCapacity(lmr, tables[size]);
                const adjustedCapacity = baseCapacity * densityMultiplier;
                
                if (adjustedCapacity >= totalMbtuh) {
                    return {
                        size: size,
                        capacity: Math.round(adjustedCapacity * 1000), // Convert back to BTU/h for display
                        baseCapacity: Math.round(baseCapacity * 1000), // Convert back to BTU/h for display
                        available: Math.round((adjustedCapacity - totalMbtuh) * 1000), // Convert back to BTU/h for display
                        densityMultiplier: densityMultiplier,
                        actualDensity: actualDensity
                    };
                }
            }
            
            return null;
        }

        function generateApplianceBranchSizing(applianceItems, lmr, pipeType, pressure, gasType, customDensity) {
            if (applianceItems.length === 0) return '';
            
            let branchSizingHTML = `
                <div class="result-item">
                    <h4>Individual Appliance Branch Line Sizing</h4>
                    <p style="font-size: 14px; color: #666; margin-bottom: 15px;">
                        Each appliance's minimum pipe size requirement using system parameters: ${lmr} ft LMR
                    </p>
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 10px; align-items: center; font-weight: bold; border-bottom: 2px solid #ccc; padding-bottom: 5px; margin-bottom: 10px;">
                        <div>Appliance Name</div>
                        <div style="text-align: center;">Capacity (Btu/h)</div>
                        <div style="text-align: center;">Min. Pipe Size</div>
                        <div style="text-align: center;">Available (Btu/h)</div>
                    </div>`;
            
            applianceItems.forEach(item => {
                const nameInput = item.querySelector('.appliance-name');
                const btuInput = item.querySelector('.appliance-btuh');
                
                if (nameInput && btuInput) {
                    const name = nameInput.value.trim() || 'Unnamed Appliance';
                    const btuValue = parseFloat(btuInput.value) || 0;
                    
                    if (btuValue > 0) {
                        const branchResult = findRequiredPipeSize(btuValue, lmr, pipeType, pressure, gasType, customDensity);
                        
                        if (branchResult) {
                            branchSizingHTML += `
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 10px; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee;">
                                    <div style="font-weight: 500;">${name}</div>
                                    <div style="text-align: center;">${btuValue.toLocaleString()}</div>
                                    <div style="text-align: center; font-weight: bold; color: #1976d2;">${branchResult.size}"</div>
                                    <div style="text-align: center; color: #4caf50;">${branchResult.available.toLocaleString()}</div>
                                </div>`;
                        } else {
                            branchSizingHTML += `
                                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 10px; align-items: center; padding: 8px 0; border-bottom: 1px solid #eee;">
                                    <div style="font-weight: 500;">${name}</div>
                                    <div style="text-align: center;">${btuValue.toLocaleString()}</div>
                                    <div style="text-align: center; color: #d32f2f; font-weight: bold;">No Size</div>
                                    <div style="text-align: center; color: #d32f2f;">Exceeds Max</div>
                                </div>`;
                        }
                    }
                }
            });
            
            branchSizingHTML += `
                    <div style="margin-top: 15px; font-size: 12px; color: #666;">
                        <strong>Note:</strong> Branch sizes shown are minimum requirements for individual appliances. 
                        Actual installation may require larger sizes based on routing, fittings, and local codes.
                    </div>
                </div>`;
                
            return branchSizingHTML;
        }

        function calculatePipeSize() {
            // First validate all appliances
            const totalResult = updateTotal();
            const applianceItems = document.querySelectorAll('.appliance-item');
            
            if (applianceItems.length === 0) {
                document.getElementById('results').innerHTML = `
                    <div class="warning">
                        <strong>Warning:</strong> Please add at least one appliance before calculating pipe size.
                    </div>
                `;
                return;
            }

            if (!totalResult.isValid) {
                document.getElementById('results').innerHTML = `
                    <div class="warning">
                        <strong>Warning:</strong> Please fix appliance validation errors before calculating pipe size.
                    </div>
                `;
                return;
            }

            // Use the total from updateTotal result
            const totalBtuh = totalResult.total;
            
            const lmr = parseFloat(document.getElementById('lmr').value);
            const pipeType = document.getElementById('pipeType').value;
            const pressure = document.getElementById('pressure').value;
            const gasType = document.getElementById('gasType').value;
            const customDensity = parseFloat(document.getElementById('gasRelativeDensity').value) || null;

            if (!totalBtuh || totalBtuh <= 0) {
                document.getElementById('results').innerHTML = `
                    <div class="warning">
                        <strong>Warning:</strong> Please enter at least one appliance with a valid Btu/h rating.
                    </div>
                `;
                return;
            }

            if (!lmr || lmr <= 0) {
                document.getElementById('results').innerHTML = `
                    <div class="warning">
                        <strong>Warning:</strong> Please enter a valid Longest Measured Run (LMR) greater than 0.
                    </div>
                `;
                return;
            }

            if (lmr > 500) {
                document.getElementById('results').innerHTML = `
                    <div class="warning">
                        <strong>Warning:</strong> LMR of ${lmr} feet is unusually long. Please verify this is correct or consider intermediate pressure boosting.
                    </div>
                `;
                return;
            }

            // Validate custom gas density if provided
            if (customDensity !== null && (customDensity < 0.35 || customDensity > 2.10)) {
                document.getElementById('results').innerHTML = `
                    <div class="warning">
                        <strong>Warning:</strong> Gas relative density must be between 0.35 and 2.10.
                    </div>
                `;
                return;
            }

            const result = findRequiredPipeSize(totalBtuh, lmr, pipeType, pressure, gasType, customDensity);

            if (!result) {
                document.getElementById('results').innerHTML = `
                    <div class="warning">
                        <strong>Warning:</strong> The required capacity (${totalBtuh.toLocaleString()} Btu/h) exceeds the maximum capacity for available pipe sizes at ${lmr} feet. Consider reducing the load, shortening the run, or increasing the operating pressure.
                    </div>
                `;
                return;
            }

            const pipeTypeName = pipeType === 'schedule40' ? 'Schedule 40 Black Iron Pipe' : 'Type K Copper Tubing';
            const gasTypeName = gasType === 'propane' ? 'Propane (LP Gas)' : 'Natural Gas';
            const pressureText = {
                'low': 'Less than 7" w.c. (1.7 kPa)',
                'medium': '7" to 14" w.c. (1.7 to 3.5 kPa)',
                '2': '2 psig (13.8 kPa)', 
                '5': '5 psig (34.5 kPa)',
                '10': '10 psig (69 kPa)',
                '20': '20 psig (138 kPa)'
            }[pressure];

            // Gas density information
            const densityInfo = customDensity ? 
                `${result.actualDensity} (custom)` : 
                `${result.actualDensity} (standard)`;
            
            const densityAdjustmentInfo = result.densityMultiplier !== 1.0 ? 
                `<p><strong>Base Capacity (0.6 density):</strong> ${result.baseCapacity.toLocaleString()} Btu/h</p>
                 <p><strong>Density Multiplier:</strong> ${result.densityMultiplier.toFixed(3)}</p>` : '';

            document.getElementById('results').innerHTML = `
                <div class="result-item">
                    <h4>Recommended Pipe Size</h4>
                    <p><strong>Size:</strong> ${result.size}" ${pipeTypeName}</p>
                    <p><strong>Adjusted Capacity at ${lmr} ft:</strong> ${result.capacity.toLocaleString()} Btu/h</p>
                    ${densityAdjustmentInfo}
                    <p><strong>System Load:</strong> ${totalBtuh.toLocaleString()} Btu/h</p>
                    <p><strong>Available Capacity:</strong> ${result.available.toLocaleString()} Btu/h</p>
                    <p><strong>Utilization:</strong> ${Math.round((totalBtuh / result.capacity) * 100)}%</p>
                </div>

                <div class="result-item">
                    <h4>System Parameters</h4>
                    <p><strong>Gas Type:</strong> ${gasTypeName}</p>
                    <p><strong>Gas Relative Density:</strong> ${densityInfo}</p>
                    <p><strong>Operating Pressure:</strong> ${pressureText}</p>
                    <p><strong>Longest Measured Run:</strong> ${lmr} feet</p>
                    <p><strong>Pipe Material:</strong> ${pipeTypeName}</p>
                </div>

                <div class="calculation-details">
                    <strong>Calculation Method:</strong><br>
                    Based on CSA B149.1:25 ${gasType === 'propane' ? 'Annex B' : 'Annex A'} capacity tables<br>
                    ${result.densityMultiplier !== 1.0 ? 'Applied CSA Table A.15 density adjustment<br>' : ''}
                    Interpolated capacity for ${lmr} ft length<br>
                    Selected minimum pipe size meeting capacity requirement
                </div>

                ${generateApplianceBranchSizing(applianceItems, lmr, pipeType, pressure, gasType, customDensity)}

                <div class="warning">
                    <strong>Important:</strong> ${customDensity ? 'Custom gas density applied.' : 'Standard gas densities used (Natural Gas: 0.6, Propane: 1.5 relative density).'} Verify actual gas composition and adjust if necessary. Always consult local codes and qualified professionals.
                </div>
            `;
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            updateTotal();
        });

        // Register Service Worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('./sw.js').then(function(registration) {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, function(err) {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>
</body>
</html>