<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CSA Unit 11 - Pressure Regulators, Meters & Equipment</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 40px;
            max-width: 800px;
            width: 100%;
            text-align: center;
        }

        .logo {
            width: 120px;
            height: 80px;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .csa-logo {
            width: 100%;
            height: auto;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        .subtitle {
            color: #7f8c8d;
            margin-bottom: 40px;
            font-size: 1.1em;
        }

        .button-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .nav-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 20px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .nav-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .final-exam-button {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            grid-column: 1 / -1;
            font-size: 18px;
            padding: 25px;
        }

        .quiz-container {
            display: none;
        }

        .quiz-header {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }

        .quiz-title {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .question-card {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }

        .question-number {
            color: #667eea;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .question-text {
            color: #2c3e50;
            font-size: 18px;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .answer-option {
            display: block;
            width: 100%;
            text-align: left;
            padding: 15px 20px;
            margin-bottom: 10px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
        }

        .answer-option:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .answer-option.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .quiz-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .control-button {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .prev-button {
            background: #6c757d;
            color: white;
        }

        .next-button {
            background: #667eea;
            color: white;
        }

        .quit-button {
            background: #dc3545;
            color: white;
        }

        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .control-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .results-container {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            font-weight: bold;
            color: white;
        }

        .score-excellent { background: linear-gradient(135deg, #00b894, #00a085); }
        .score-good { background: linear-gradient(135deg, #fdcb6e, #e17055); }
        .score-fair { background: linear-gradient(135deg, #fd79a8, #e84393); }
        .score-poor { background: linear-gradient(135deg, #e17055, #d63031); }

        .results-title {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .results-details {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .answers-review {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e9ecef;
        }

        .review-header {
            color: #2c3e50;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        .question-review {
            border-bottom: 1px solid #e9ecef;
            padding: 15px 0;
            margin-bottom: 15px;
        }

        .question-review:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }

        .review-question-text {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .answer-comparison {
            display: grid;
            gap: 8px;
        }

        .answer-row {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 14px;
        }

        .user-answer {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }

        .user-answer.correct {
            background: #d4edda;
            border: 1px solid #74b816;
            color: #155724;
        }

        .user-answer.incorrect {
            background: #f8d7da;
            border: 1px solid #e74c3c;
            color: #721c24;
        }

        .correct-answer {
            background: #d1ecf1;
            border: 1px solid #74b816;
            color: #0c5460;
        }

        .answer-label {
            font-weight: 600;
            margin-right: 10px;
            min-width: 80px;
        }

        .answer-text {
            flex: 1;
        }

        .answer-icon {
            margin-left: 10px;
            font-weight: bold;
        }

        .toggle-review {
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 10px;
            padding: 10px 20px;
            font-size: 14px;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .toggle-review:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        .hidden {
            display: none;
        }

        .footer {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
            text-align: center;
            color: #6c757d;
            font-size: 14px;
        }

        .footer-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }

        .lark-logo {
            height: 30px;
            width: auto;
        }

        .created-by {
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Main Navigation -->
        <div id="mainMenu">
            <div class="logo">
                <svg class="csa-logo" viewBox="0 0 1024 600" xmlns="http://www.w3.org/2000/svg">
                    <!-- CSA Square Logo with curved design -->
                    <rect x="0" y="150" width="300" height="300" fill="#1565C0" rx="20"/>
                    <!-- Green curved element -->
                    <path d="M 50 250 Q 150 200 250 250 Q 200 300 100 280 Q 75 265 50 250" fill="#7CB342"/>
                    <!-- White curved swoosh -->
                    <path d="M 0 350 Q 100 300 200 350 Q 250 380 300 400 L 300 450 Q 200 420 100 450 Q 50 430 0 450 Z" fill="white"/>
                    
                    <!-- CSA Text -->
                    <text x="350" y="280" font-family="Arial, sans-serif" font-size="120" font-weight="bold" fill="#1565C0">CSA</text>
                    
                    <!-- STANDARDS Text -->
                    <text x="0" y="550" font-family="Arial, sans-serif" font-size="80" font-weight="bold" fill="#7CB342">STANDARDS</text>
                </svg>
            </div>
            <h1>Unit 11 - Pressure Regulators, Meters & Equipment</h1>
            <p class="subtitle">Gas Trade Training - Chapter Questions</p>
            
            <div class="button-grid">
                <button class="nav-button" onclick="startQuiz('chapter1')">
                    Chapter 1<br>
                    <small>Pressure Regulators</small>
                </button>
                <button class="nav-button" onclick="startQuiz('chapter2')">
                    Chapter 2<br>
                    <small>Overpressure Protection</small>
                </button>
                <button class="nav-button" onclick="startQuiz('chapter3')">
                    Chapter 3<br>
                    <small>Meters</small>
                </button>
                <button class="nav-button" onclick="startQuiz('chapter4')">
                    Chapter 4<br>
                    <small>Fuel Containers</small>
                </button>
                <button class="nav-button final-exam-button" onclick="startQuiz('finalExam')">
                    CSA Unit 11 Final Exam<br>
                    <small>Pressure Regulators, Meters & Equipment</small>
                </button>
            </div>
        </div>

        <!-- Quiz Container -->
        <div id="quizContainer" class="quiz-container">
            <div class="quiz-header">
                <h2 id="quizTitle" class="quiz-title"></h2>
                <div id="progressInfo"></div>
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill" style="width: 0%"></div>
                </div>
            </div>

            <div id="questionCard" class="question-card">
                <div id="questionNumber" class="question-number"></div>
                <div id="questionText" class="question-text"></div>
                <div id="answerOptions"></div>
            </div>

            <div class="quiz-controls">
                <button id="prevButton" class="control-button prev-button" onclick="previousQuestion()">Previous</button>
                <button id="quitButton" class="control-button quit-button">Quit Quiz</button>
                <button id="nextButton" class="control-button next-button" onclick="nextQuestion()">Next</button>
            </div>

            <!-- Footer for Quiz -->
            <div class="footer">
                <div class="footer-content">
                    <span class="created-by">Created by</span>
                    <svg class="lark-logo" viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg">
                        <!-- Bird -->
                        <ellipse cx="80" cy="80" rx="45" ry="30" fill="#4A90E2"/>
                        <ellipse cx="70" cy="70" rx="25" ry="18" fill="#357ABD"/>
                        <circle cx="60" cy="65" r="4" fill="white"/>
                        <circle cx="58" cy="64" r="2" fill="#2C5AA0"/>
                        <!-- Beak -->
                        <polygon points="30,75 15,80 30,85" fill="#FF6B6B"/>
                        <!-- Sound lines -->
                        <path d="M 5 65 Q 15 60 25 65" stroke="#FF6B6B" stroke-width="3" fill="none" stroke-linecap="round"/>
                        <path d="M 5 75 Q 15 70 25 75" stroke="#FF6B6B" stroke-width="3" fill="none" stroke-linecap="round"/>
                        <path d="M 5 85 Q 15 80 25 85" stroke="#FF6B6B" stroke-width="3" fill="none" stroke-linecap="round"/>
                        <!-- LARK text -->
                        <text x="180" y="90" font-family="Arial, sans-serif" font-size="48" font-weight="bold" fill="#2C5AA0">LARK</text>
                        <!-- LABS text -->
                        <text x="180" y="130" font-family="Arial, sans-serif" font-size="32" fill="#95A5A6">LABS</text>
                        <!-- Subtitle -->
                        <text x="180" y="155" font-family="Arial, sans-serif" font-size="16" fill="#BDC3C7">SOFTWARE DEVELOPMENT</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- Results Container -->
        <div id="resultsContainer" class="results-container">
            <div id="scoreCircle" class="score-circle">
                <span id="scorePercentage"></span>
            </div>
            <h2 class="results-title">Quiz Complete!</h2>
            <div class="results-details">
                <div class="detail-item">
                    <span>Total Questions:</span>
                    <span id="totalQuestions"></span>
                </div>
                <div class="detail-item">
                    <span>Correct Answers:</span>
                    <span id="correctAnswers"></span>
                </div>
                <div class="detail-item">
                    <span>Incorrect Answers:</span>
                    <span id="incorrectAnswers"></span>
                </div>
                <div class="detail-item">
                    <span>Final Score:</span>
                    <span id="finalScore"></span>
                </div>
            </div>
            
            <button class="toggle-review" onclick="toggleAnswerReview()">Show Answer Review</button>
            
            <div id="answersReview" class="answers-review" style="display: none;">
                <div class="review-header">Answer Review</div>
                <div id="reviewContent"></div>
            </div>
            
            <button class="control-button next-button" onclick="returnToMenu()">Return to Menu</button>

            <!-- Footer for Results -->
            <div class="footer">
                <div class="footer-content">
                    <span class="created-by">Created by</span>
                    <svg class="lark-logo" viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg">
                        <!-- Bird -->
                        <ellipse cx="80" cy="80" rx="45" ry="30" fill="#4A90E2"/>
                        <ellipse cx="70" cy="70" rx="25" ry="18" fill="#357ABD"/>
                        <circle cx="60" cy="65" r="4" fill="white"/>
                        <circle cx="58" cy="64" r="2" fill="#2C5AA0"/>
                        <!-- Beak -->
                        <polygon points="30,75 15,80 30,85" fill="#FF6B6B"/>
                        <!-- Sound lines -->
                        <path d="M 5 65 Q 15 60 25 65" stroke="#FF6B6B" stroke-width="3" fill="none" stroke-linecap="round"/>
                        <path d="M 5 75 Q 15 70 25 75" stroke="#FF6B6B" stroke-width="3" fill="none" stroke-linecap="round"/>
                        <path d="M 5 85 Q 15 80 25 85" stroke="#FF6B6B" stroke-width="3" fill="none" stroke-linecap="round"/>
                        <!-- LARK text -->
                        <text x="180" y="90" font-family="Arial, sans-serif" font-size="48" font-weight="bold" fill="#2C5AA0">LARK</text>
                        <!-- LABS text -->
                        <text x="180" y="130" font-family="Arial, sans-serif" font-size="32" fill="#95A5A6">LABS</text>
                        <!-- Subtitle -->
                        <text x="180" y="155" font-family="Arial, sans-serif" font-size="16" fill="#BDC3C7">SOFTWARE DEVELOPMENT</text>
                    </svg>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <div class="footer-content">
                <span class="created-by">Created by</span>
                <svg class="lark-logo" viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg">
                    <!-- Bird -->
                    <ellipse cx="80" cy="80" rx="45" ry="30" fill="#4A90E2"/>
                    <ellipse cx="70" cy="70" rx="25" ry="18" fill="#357ABD"/>
                    <circle cx="60" cy="65" r="4" fill="white"/>
                    <circle cx="58" cy="64" r="2" fill="#2C5AA0"/>
                    <!-- Beak -->
                    <polygon points="30,75 15,80 30,85" fill="#FF6B6B"/>
                    <!-- Sound lines -->
                    <path d="M 5 65 Q 15 60 25 65" stroke="#FF6B6B" stroke-width="3" fill="none" stroke-linecap="round"/>
                    <path d="M 5 75 Q 15 70 25 75" stroke="#FF6B6B" stroke-width="3" fill="none" stroke-linecap="round"/>
                    <path d="M 5 85 Q 15 80 25 85" stroke="#FF6B6B" stroke-width="3" fill="none" stroke-linecap="round"/>
                    <!-- LARK text -->
                    <text x="180" y="90" font-family="Arial, sans-serif" font-size="48" font-weight="bold" fill="#2C5AA0">LARK</text>
                    <!-- LABS text -->
                    <text x="180" y="130" font-family="Arial, sans-serif" font-size="32" fill="#95A5A6">LABS</text>
                    <!-- Subtitle -->
                    <text x="180" y="155" font-family="Arial, sans-serif" font-size="16" fill="#BDC3C7">SOFTWARE DEVELOPMENT</text>
                </svg>
            </div>
        </div>
    </div>

    <script>
        // Quiz data based on CSA Unit 11 materials
        const quizData = {
            chapter1: {
                title: "Chapter 1: Pressure Regulators",
                questions: [
                    {
                        question: "What is the restricting element of a regulator?",
                        options: [
                            "Spring",
                            "Valve disc",
                            "Diaphragm",
                            "Atmospheric vent"
                        ],
                        correct: 1
                    },
                    {
                        question: "What is the measuring element of a regulator?",
                        options: [
                            "Spring",
                            "Valve disc",
                            "Diaphragm",
                            "Atmospheric vent"
                        ],
                        correct: 2
                    },
                    {
                        question: "What is the loading element of a regulator?",
                        options: [
                            "Spring",
                            "Valve disc",
                            "Diaphragm",
                            "Atmospheric vent"
                        ],
                        correct: 0
                    },
                    {
                        question: "What would cause an appliance regulator to have too low of an outlet pressure?",
                        options: [
                            "Vent port plugged",
                            "Ruptured diaphragm",
                            "Sensing hole blocked",
                            "Inlet pressure too low"
                        ],
                        correct: 3
                    },
                    {
                        question: "The purpose of a gas pressure regulator is:",
                        options: [
                            "To keep the colour of the flame constant",
                            "To maintain even outlet heated air temperatures",
                            "To maintain a constant gas pressure at the gas valve inlet",
                            "To increase and maintain higher pressures as the load increases"
                        ],
                        correct: 2
                    },
                    {
                        question: "In a gas pressure regulator, the closing force is created by:",
                        options: [
                            "Decreased flow velocity",
                            "The inlet pressure to the regulator",
                            "The pressure under the diaphragm",
                            "The adjustable spring above the diaphragm"
                        ],
                        correct: 2
                    },
                    {
                        question: "In a gas pressure regulator, the opening force is created by:",
                        options: [
                            "Increased flow velocity",
                            "The inlet pressure to the regulator",
                            "The pressure under the diaphragm",
                            "The adjustable spring above the diaphragm"
                        ],
                        correct: 3
                    },
                    {
                        question: "To increase downstream pressure of the regulator:",
                        options: [
                            "The orifice size is changed",
                            "The adjusting screw is screwed out",
                            "The adjusting screw is screwed down",
                            "Replace the restricting disc and the spring"
                        ],
                        correct: 2
                    },
                    {
                        question: "What is the purpose of the atmospheric vent?",
                        options: [
                            "Allow gas to escape",
                            "Sense downstream pressure",
                            "Allow air above diaphragm to escape or enter",
                            "Allow a connection for a secondary pilot"
                        ],
                        correct: 2
                    },
                    {
                        question: "A pressure regulator is said to be in equilibrium when the:",
                        options: [
                            "Opening force of the diaphragm is equal to the closing force of the orifice",
                            "Opening force of the diaphragm is equal to the closing force of the spring",
                            "Opening force of the spring is equal to the closing force of the upstream pressure",
                            "Opening force of the spring is equal to the closing force of the downstream pressure"
                        ],
                        correct: 3
                    },
                    {
                        question: "What term describes the condition when the outlet pressure is lower than set point pressure during flow conditions?",
                        options: [
                            "Rise",
                            "Boost",
                            "Droop",
                            "Lockup"
                        ],
                        correct: 2
                    },
                    {
                        question: "If a regulator is installed backwards in a piping system, what is the most likely result?",
                        options: [
                            "The regulator will open completely",
                            "The regulator will close completely",
                            "Pressure downstream will rise above set point",
                            "No difference – they are non-directional valves"
                        ],
                        correct: 1
                    },
                    {
                        question: "The purpose of a pitot tube in a regulator is to:",
                        options: [
                            "Provide mechanical advantage for positive shut-off",
                            "Relieve unwanted gases when overpressure occurs",
                            "Increase upstream pressure during static conditions",
                            "Keep downstream pressure closer to set point during flow conditions"
                        ],
                        correct: 3
                    },
                    {
                        question: "When flow rate increases through a regulator, what happens to the downstream pressure?",
                        options: [
                            "It increases",
                            "It decreases",
                            "It cycles/hunts",
                            "It stays the same"
                        ],
                        correct: 1
                    },
                    {
                        question: "A line pressure regulator operating at 2 psig or less shall be exempt from the requirements of Clause 5.2.1.5 (B) when equipped with which of the following?",
                        options: [
                            "A vent leak-limiting system",
                            "An internal relief valve spring",
                            "A union on the downstream piping",
                            "A pitot tube and balancing diaphragm"
                        ],
                        correct: 0
                    }
                ]
            },
            chapter2: {
                title: "Chapter 2: Overpressure Protection",
                questions: [
                    {
                        question: "What is the maximum allowable pressure downstream of a pressure controlling device?",
                        options: [
                            "2 psig",
                            "5 psig",
                            "Lowest maximum pressure rating of any downstream components",
                            "Highest maximum pressure rating of any downstream components"
                        ],
                        correct: 2
                    },
                    {
                        question: "Of commonly used overprotection methods which gives the least obvious failure warning?",
                        options: [
                            "Pressure limiting",
                            "Automatic shut-off",
                            "Internal relief valve",
                            "External relief valves"
                        ],
                        correct: 0
                    },
                    {
                        question: "A relief valve will decrease a regulator's capacity.",
                        options: [
                            "True",
                            "False"
                        ],
                        correct: 1
                    },
                    {
                        question: "What measures the system pressure when using a direct operated relief valve?",
                        options: [
                            "Pitot tube",
                            "Diaphragm",
                            "Loading spring",
                            "Restricting element"
                        ],
                        correct: 1
                    },
                    {
                        question: "What types of overpressure protection incorporate a restricting element?",
                        options: [
                            "Relief valves",
                            "Series regulation",
                            "Slam shut devices",
                            "Monitor regulation"
                        ],
                        correct: 0
                    },
                    {
                        question: "An overpressure shut-off (OPSO) will automatically reset.",
                        options: [
                            "True",
                            "False"
                        ],
                        correct: 1
                    },
                    {
                        question: "What would happen if a regulator vent became blocked while the regulator was in the open position?",
                        options: [
                            "Regulator would close",
                            "Regulator would remain open",
                            "Regulator would operate normally",
                            "Regulator setpoint would slowly drop"
                        ],
                        correct: 1
                    },
                    {
                        question: "Which type of pressure limiting system has a regulator that is rarely exercised?",
                        options: [
                            "Pilot system",
                            "Series Regulation",
                            "Working monitors",
                            "Wide open monitoring"
                        ],
                        correct: 3
                    },
                    {
                        question: "What are the minimum and maximum allowed set pressures for a line relief device installed on a 2 psi piping system?",
                        options: [
                            "Minimum of 2 psi and a maximum of 4 psi",
                            "Minimum of 3 psi and a maximum of 4 psi",
                            "Minimum of 4 psi and a maximum of 6 psi",
                            "Minimum of 6 psi and a maximum of 10 psi"
                        ],
                        correct: 2
                    }
                ]
            },
            chapter3: {
                title: "Chapter 3: Meters",
                questions: [
                    {
                        question: "What is the most common type of meter used on residential installations?",
                        options: [
                            "Geared",
                            "Lobed",
                            "Orifice",
                            "Diaphragm"
                        ],
                        correct: 3
                    },
                    {
                        question: "Which meter corrects for temperature and pressure?",
                        options: [
                            "Bellows",
                            "Mechanical Rotary",
                            "Electronic Volume Corrector",
                            "Electronic Temperature Compensating Index"
                        ],
                        correct: 2
                    },
                    {
                        question: "For what purpose does a gas fitter clock a meter?",
                        options: [
                            "Solely used as a gas leak check",
                            "To see how long it takes the test dial to go around",
                            "To determine how much gas an appliance consumes per hour",
                            "To check how much gas is consumed in a month for billing purpose"
                        ],
                        correct: 2
                    },
                    {
                        question: "When do you need to use a pressure correction factor when clocking an appliance?",
                        options: [
                            "Appliance input is over 400MBH",
                            "Meter pressure greater than 0.5 psig",
                            "Meter pressures greater than 2 psig",
                            "Meter pressures greater than 5psig"
                        ],
                        correct: 1
                    },
                    {
                        question: "If a natural gas meter with 7 inches water column pressure is used to clock an appliance and it takes 24 seconds for one revolution of a 2 cubic foot test dial, what is the input of the appliance being fired?",
                        options: [
                            "300 MBH",
                            "3,000 MBH",
                            "30,000 MBH",
                            "300,000 MBH"
                        ],
                        correct: 0
                    },
                    {
                        question: "Rotary meters are very effective for leak testing a gas system.",
                        options: [
                            "True",
                            "False"
                        ],
                        correct: 1
                    },
                    {
                        question: "What procedure should be used to identify if the test dial has possibly moved back to its original position when conducting a working pressure leak test using a diaphragm meter?",
                        options: [
                            "Turn of the gas",
                            "Mark both test dials",
                            "Mark the position of the smallest test dial",
                            "Mark two positions on the smallest test dial"
                        ],
                        correct: 3
                    },
                    {
                        question: "If the temperature of a gas trapped in a container is increased, what happens to the pressure?",
                        options: [
                            "Increases",
                            "Decrease",
                            "Stays the same",
                            "It depends on the type of gas"
                        ],
                        correct: 0
                    },
                    {
                        question: "If the temperature of a gas decreases in a flexible container (such as the bellows of a diaphragm meter), what happens to the volume?",
                        options: [
                            "Increases",
                            "Decrease",
                            "Stays the same",
                            "It depends on the type of gas"
                        ],
                        correct: 1
                    },
                    {
                        question: "What is the temperature the gas heat values are based on?",
                        options: [
                            "-40°C",
                            "0°C",
                            "15°C",
                            "32°C"
                        ],
                        correct: 2
                    }
                ]
            },
            chapter4: {
                title: "Chapter 4: Fuel Containers",
                questions: [
                    {
                        question: "How long may a 100# propane cylinder be in use before it must be re-inspected and marked?",
                        options: [
                            "1 year",
                            "5 years",
                            "10 years",
                            "20 years"
                        ],
                        correct: 2
                    },
                    {
                        question: "The level of liquid propane in the cylinder has no effect on the vaporization rate.",
                        options: [
                            "True",
                            "False"
                        ],
                        correct: 1
                    },
                    {
                        question: "Assuming all of the propane cylinders are ¼ full which one will have the higher Btu/h vaporization rate?",
                        options: [
                            "20 #",
                            "40 #",
                            "200 #",
                            "300#"
                        ],
                        correct: 3
                    },
                    {
                        question: "The largest cylinder that is made has a capacity of 1000 lbs of water. What is the maximum allowable liquid propane capacity?",
                        options: [
                            "300 #",
                            "420 #",
                            "500 #",
                            "800#"
                        ],
                        correct: 1
                    },
                    {
                        question: "When calculating the effective load that an appliance will place on a propane container, which formula should be used?",
                        options: [
                            "Effective load = Btu/h of input",
                            "Effective load = input × load factor",
                            "Effective load = weight of propane × load factor",
                            "Effective load = gallons of liquid propane × 91,500"
                        ],
                        correct: 1
                    },
                    {
                        question: "Cylinders have a lower vaporization rate at higher humidity.",
                        options: [
                            "True",
                            "False"
                        ],
                        correct: 1
                    },
                    {
                        question: "When the demand of an appliance is too high for an average size container, what would be a practical solution?",
                        options: [
                            "Install an excess flow valve",
                            "Install a propane vapourizer",
                            "Install multiple smaller appliances",
                            "Install an auto change over manifold"
                        ],
                        correct: 1
                    },
                    {
                        question: "What units of measurement are used to rate the fuel consumption of propane-fired stationary engines?",
                        options: [
                            "Btu/h",
                            "kW",
                            "gal/hr",
                            "gpm"
                        ],
                        correct: 2
                    },
                    {
                        question: "What will happen to the vapour pressure in a cylinder when the temperature of liquid propane is increased?",
                        options: [
                            "Not change",
                            "Increase",
                            "Decrease",
                            "Decrease only if the liquid content is 80%"
                        ],
                        correct: 1
                    },
                    {
                        question: "What surfaces on a propane storage container transfer heat and affect the vaporization rate?",
                        options: [
                            "The entire wetted surface of the container",
                            "The entire surface including the top and bottom",
                            "The entire surface not including the top or bottom",
                            "Only the surface that directly faces the sun and receives direct radiation"
                        ],
                        correct: 0
                    },
                    {
                        question: "What is the pressure in the propane container is directly related to?",
                        options: [
                            "Temperature of the liquid propane",
                            "Temperature of the propane gas",
                            "Volume of propane left in the cylinder",
                            "Size of the propane container"
                        ],
                        correct: 0
                    },
                    {
                        question: "What is indicated by a white fog or mist emitting from the liquid level gauge?",
                        options: [
                            "LP-gas is contaminated",
                            "Cylinder or tank is damaged",
                            "Liquid level gauge is defective",
                            "Maximum permitted filling level is reached"
                        ],
                        correct: 3
                    },
                    {
                        question: "What is the relief valve setting of a propane cylinder?",
                        options: [
                            "250 psig",
                            "312 psig",
                            "375 psig",
                            "420 psig"
                        ],
                        correct: 2
                    },
                    {
                        question: "What is the purpose of an excess flow valve?",
                        options: [
                            "Prevent liquid withdrawal from a tank",
                            "Prevent the tank from being filled too quickly",
                            "Prevent the tank from being over pressurized",
                            "Prevent excessive discharge of vapour or liquid"
                        ],
                        correct: 3
                    },
                    {
                        question: "What is the purpose of a filler valve on a cylinder?",
                        options: [
                            "Used to fill a large stationary cylinder",
                            "Provide a large capacity relief opening",
                            "Act as a check valve to prevent excess flow",
                            "Prevent the cylinder or tank from rupturing"
                        ],
                        correct: 0
                    }
                ]
            },
            finalExam: {
                title: "CSA Unit 11 Final Exam - Pressure Regulators, Meters & Equipment",
                questions: [
                    {
                        question: "What is the restricting element of a regulator?",
                        options: [
                            "Spring",
                            "Valve disc",
                            "Diaphragm",
                            "Atmospheric vent"
                        ],
                        correct: 1
                    },
                    {
                        question: "The purpose of a gas pressure regulator is:",
                        options: [
                            "To keep the colour of the flame constant",
                            "To maintain even outlet heated air temperatures",
                            "To maintain a constant gas pressure at the gas valve inlet",
                            "To increase and maintain higher pressures as the load increases"
                        ],
                        correct: 2
                    },
                    {
                        question: "What is the maximum allowable pressure downstream of a pressure controlling device?",
                        options: [
                            "2 psig",
                            "5 psig",
                            "Lowest maximum pressure rating of any downstream components",
                            "Highest maximum pressure rating of any downstream components"
                        ],
                        correct: 2
                    },
                    {
                        question: "An overpressure shut-off (OPSO) will automatically reset.",
                        options: [
                            "True",
                            "False"
                        ],
                        correct: 1
                    },
                    {
                        question: "What is the most common type of meter used on residential installations?",
                        options: [
                            "Geared",
                            "Lobed",
                            "Orifice",
                            "Diaphragm"
                        ],
                        correct: 3
                    },
                    {
                        question: "For what purpose does a gas fitter clock a meter?",
                        options: [
                            "Solely used as a gas leak check",
                            "To see how long it takes the test dial to go around",
                            "To determine how much gas an appliance consumes per hour",
                            "To check how much gas is consumed in a month for billing purpose"
                        ],
                        correct: 2
                    },
                    {
                        question: "The largest cylinder that is made has a capacity of 1000 lbs of water. What is the maximum allowable liquid propane capacity?",
                        options: [
                            "300 #",
                            "420 #",
                            "500 #",
                            "800#"
                        ],
                        correct: 1
                    },
                    {
                        question: "What is the relief valve setting of a propane cylinder?",
                        options: [
                            "250 psig",
                            "312 psig",
                            "375 psig",
                            "420 psig"
                        ],
                        correct: 2
                    },
                    {
                        question: "What term describes the condition when the outlet pressure is lower than set point pressure during flow conditions?",
                        options: [
                            "Rise",
                            "Boost",
                            "Droop",
                            "Lockup"
                        ],
                        correct: 2
                    },
                    {
                        question: "A relief valve will decrease a regulator's capacity.",
                        options: [
                            "True",
                            "False"
                        ],
                        correct: 1
                    },
                    {
                        question: "Which meter corrects for temperature and pressure?",
                        options: [
                            "Bellows",
                            "Mechanical Rotary",
                            "Electronic Volume Corrector",
                            "Electronic Temperature Compensating Index"
                        ],
                        correct: 2
                    },
                    {
                        question: "The level of liquid propane in the cylinder has no effect on the vaporization rate.",
                        options: [
                            "True",
                            "False"
                        ],
                        correct: 1
                    },
                    {
                        question: "To increase downstream pressure of the regulator:",
                        options: [
                            "The orifice size is changed",
                            "The adjusting screw is screwed out",
                            "The adjusting screw is screwed down",
                            "Replace the restricting disc and the spring"
                        ],
                        correct: 2
                    },
                    {
                        question: "What would happen if a regulator vent became blocked while the regulator was in the open position?",
                        options: [
                            "Regulator would close",
                            "Regulator would remain open",
                            "Regulator would operate normally",
                            "Regulator setpoint would slowly drop"
                        ],
                        correct: 1
                    },
                    {
                        question: "Rotary meters are very effective for leak testing a gas system.",
                        options: [
                            "True",
                            "False"
                        ],
                        correct: 1
                    },
                    {
                        question: "What is the purpose of an excess flow valve?",
                        options: [
                            "Prevent liquid withdrawal from a tank",
                            "Prevent the tank from being filled too quickly",
                            "Prevent the tank from being over pressurized",
                            "Prevent excessive discharge of vapour or liquid"
                        ],
                        correct: 3
                    },
                    {
                        question: "In a gas pressure regulator, the closing force is created by:",
                        options: [
                            "Decreased flow velocity",
                            "The inlet pressure to the regulator",
                            "The pressure under the diaphragm",
                            "The adjustable spring above the diaphragm"
                        ],
                        correct: 2
                    },
                    {
                        question: "What are the minimum and maximum allowed set pressures for a line relief device installed on a 2 psi piping system?",
                        options: [
                            "Minimum of 2 psi and a maximum of 4 psi",
                            "Minimum of 3 psi and a maximum of 4 psi",
                            "Minimum of 4 psi and a maximum of 6 psi",
                            "Minimum of 6 psi and a maximum of 10 psi"
                        ],
                        correct: 2
                    },
                    {
                        question: "If the temperature of a gas trapped in a container is increased, what happens to the pressure?",
                        options: [
                            "Increases",
                            "Decrease",
                            "Stays the same",
                            "It depends on the type of gas"
                        ],
                        correct: 0
                    },
                    {
                        question: "What will happen to the vapour pressure in a cylinder when the temperature of liquid propane is increased?",
                        options: [
                            "Not change",
                            "Increase",
                            "Decrease",
                            "Decrease only if the liquid content is 80%"
                        ],
                        correct: 1
                    }
                ]
            }
        };

        // Quiz state
        let currentQuiz = null;
        let currentQuestionIndex = 0;
        let userAnswers = [];
        let score = 0;

        function startQuiz(quizType) {
            currentQuiz = quizData[quizType];
            currentQuestionIndex = 0;
            userAnswers = [];
            score = 0;

            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('quizContainer').style.display = 'block';
            document.getElementById('resultsContainer').style.display = 'none';

            document.getElementById('quizTitle').textContent = currentQuiz.title;
            
            // Set up quit button event listener
            const quitButton = document.getElementById('quitButton');
            if (quitButton) {
                quitButton.onclick = function() {
                    returnToMenu();
                };
            }
            
            showQuestion();
        }

        function showQuestion() {
            const question = currentQuiz.questions[currentQuestionIndex];
            const totalQuestions = currentQuiz.questions.length;
            
            // Update progress
            const progress = ((currentQuestionIndex + 1) / totalQuestions) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('progressInfo').textContent = `Question ${currentQuestionIndex + 1} of ${totalQuestions}`;
            
            // Show question
            document.getElementById('questionNumber').textContent = `Question ${currentQuestionIndex + 1}`;
            document.getElementById('questionText').textContent = question.question;
            
            // Show options
            const optionsContainer = document.getElementById('answerOptions');
            optionsContainer.innerHTML = '';
            
            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'answer-option';
                button.textContent = `${String.fromCharCode(65 + index)}) ${option}`;
                button.onclick = () => selectAnswer(index);
                
                // Restore previous selection
                if (userAnswers[currentQuestionIndex] === index) {
                    button.classList.add('selected');
                }
                
                optionsContainer.appendChild(button);
            });
            
            // Update navigation buttons
            document.getElementById('prevButton').disabled = currentQuestionIndex === 0;
            document.getElementById('nextButton').textContent = 
                currentQuestionIndex === totalQuestions - 1 ? 'Finish Quiz' : 'Next';
        }

        function selectAnswer(answerIndex) {
            // Remove previous selection
            document.querySelectorAll('.answer-option').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Add selection to clicked option
            event.target.classList.add('selected');
            
            // Store answer
            userAnswers[currentQuestionIndex] = answerIndex;
        }

        function nextQuestion() {
            if (currentQuestionIndex < currentQuiz.questions.length - 1) {
                currentQuestionIndex++;
                showQuestion();
            } else {
                finishQuiz();
            }
        }

        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                showQuestion();
            }
        }

        function finishQuiz() {
            // Calculate score
            score = 0;
            for (let i = 0; i < currentQuiz.questions.length; i++) {
                if (userAnswers[i] === currentQuiz.questions[i].correct) {
                    score++;
                }
            }
            
            showResults();
        }

        function showResults() {
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('resultsContainer').style.display = 'block';
            
            const totalQuestions = currentQuiz.questions.length;
            const percentage = Math.round((score / totalQuestions) * 100);
            
            // Update results display
            document.getElementById('scorePercentage').textContent = percentage + '%';
            document.getElementById('totalQuestions').textContent = totalQuestions;
            document.getElementById('correctAnswers').textContent = score;
            document.getElementById('incorrectAnswers').textContent = totalQuestions - score;
            document.getElementById('finalScore').textContent = percentage + '%';
            
            // Set score circle color based on performance
            const scoreCircle = document.getElementById('scoreCircle');
            scoreCircle.className = 'score-circle';
            if (percentage >= 90) {
                scoreCircle.classList.add('score-excellent');
            } else if (percentage >= 80) {
                scoreCircle.classList.add('score-good');
            } else if (percentage >= 70) {
                scoreCircle.classList.add('score-fair');
            } else {
                scoreCircle.classList.add('score-poor');
            }
            
            // Generate answer review
            generateAnswerReview();
        }

        function generateAnswerReview() {
            const reviewContent = document.getElementById('reviewContent');
            reviewContent.innerHTML = '';
            
            currentQuiz.questions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-review';
                
                const userAnswerIndex = userAnswers[index];
                const correctAnswerIndex = question.correct;
                const isCorrect = userAnswerIndex === correctAnswerIndex;
                
                // Question text
                const questionText = document.createElement('div');
                questionText.className = 'review-question-text';
                questionText.textContent = `${index + 1}. ${question.question}`;
                questionDiv.appendChild(questionText);
                
                // Answer comparison
                const answerComparison = document.createElement('div');
                answerComparison.className = 'answer-comparison';
                
                // User's answer
                const userAnswerDiv = document.createElement('div');
                userAnswerDiv.className = `answer-row user-answer ${isCorrect ? 'correct' : 'incorrect'}`;
                
                const userAnswerLabel = document.createElement('span');
                userAnswerLabel.className = 'answer-label';
                userAnswerLabel.textContent = 'Your answer:';
                
                const userAnswerText = document.createElement('span');
                userAnswerText.className = 'answer-text';
                
                if (userAnswerIndex !== undefined) {
                    const optionLetter = String.fromCharCode(65 + userAnswerIndex);
                    userAnswerText.textContent = `${optionLetter}) ${question.options[userAnswerIndex]}`;
                } else {
                    userAnswerText.textContent = 'No answer selected';
                }
                
                const userAnswerIcon = document.createElement('span');
                userAnswerIcon.className = 'answer-icon';
                userAnswerIcon.textContent = isCorrect ? '✓' : '✗';
                
                userAnswerDiv.appendChild(userAnswerLabel);
                userAnswerDiv.appendChild(userAnswerText);
                userAnswerDiv.appendChild(userAnswerIcon);
                
                // Correct answer (only show if user was wrong)
                if (!isCorrect) {
                    const correctAnswerDiv = document.createElement('div');
                    correctAnswerDiv.className = 'answer-row correct-answer';
                    
                    const correctAnswerLabel = document.createElement('span');
                    correctAnswerLabel.className = 'answer-label';
                    correctAnswerLabel.textContent = 'Correct:';
                    
                    const correctAnswerText = document.createElement('span');
                    correctAnswerText.className = 'answer-text';
                    const correctOptionLetter = String.fromCharCode(65 + correctAnswerIndex);
                    correctAnswerText.textContent = `${correctOptionLetter}) ${question.options[correctAnswerIndex]}`;
                    
                    const correctAnswerIcon = document.createElement('span');
                    correctAnswerIcon.className = 'answer-icon';
                    correctAnswerIcon.textContent = '✓';
                    
                    correctAnswerDiv.appendChild(correctAnswerLabel);
                    correctAnswerDiv.appendChild(correctAnswerText);
                    correctAnswerDiv.appendChild(correctAnswerIcon);
                    
                    answerComparison.appendChild(userAnswerDiv);
                    answerComparison.appendChild(correctAnswerDiv);
                } else {
                    answerComparison.appendChild(userAnswerDiv);
                }
                
                questionDiv.appendChild(answerComparison);
                reviewContent.appendChild(questionDiv);
            });
        }

        function toggleAnswerReview() {
            const reviewDiv = document.getElementById('answersReview');
            const button = document.querySelector('.toggle-review');
            
            if (reviewDiv.style.display === 'none') {
                reviewDiv.style.display = 'block';
                button.textContent = 'Hide Answer Review';
            } else {
                reviewDiv.style.display = 'none';
                button.textContent = 'Show Answer Review';
            }
        }

        function returnToMenu() {
            // Hide all containers
            const quizContainer = document.getElementById('quizContainer');
            const resultsContainer = document.getElementById('resultsContainer');
            const mainMenu = document.getElementById('mainMenu');
            
            if (quizContainer) {
                quizContainer.style.display = 'none';
            }
            if (resultsContainer) {
                resultsContainer.style.display = 'none';
            }
            // Show main menu
            if (mainMenu) {
                mainMenu.style.display = 'block';
            }
            
            // Reset quiz state
            currentQuiz = null;
            currentQuestionIndex = 0;
            userAnswers = [];
            score = 0;
            
            // Reset the answer review toggle
            const reviewDiv = document.getElementById('answersReview');
            const toggleButton = document.querySelector('.toggle-review');
            if (reviewDiv) {
                reviewDiv.style.display = 'none';
            }
            if (toggleButton) {
                toggleButton.textContent = 'Show Answer Review';
            }
        }
    </script>
</body>
</html>