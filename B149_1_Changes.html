<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B149.1:25 Overview of Changes - Interactive Learning Module</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .module-header {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }

        .lark-logo {
            width: 80px;
            height: 40px;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .slide {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: none;
            animation: slideIn 0.5s ease-in-out;
        }

        .slide.active {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            color: #0066cc;
            font-size: 2.5em;
            margin-bottom: 20px;
        }

        h2 {
            color: #0066cc;
            font-size: 2em;
            margin-bottom: 20px;
            border-bottom: 3px solid #0066cc;
            padding-bottom: 10px;
        }

        h3 {
            color: #333;
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .key-points {
            background: #f8f9fa;
            border-left: 5px solid #0066cc;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .knowledge-check {
            background: #e3f2fd;
            border: 2px solid #2196f3;
            border-radius: 10px;
            padding: 25px;
            margin: 30px 0;
        }

        .knowledge-check h3 {
            color: #1976d2;
            margin-bottom: 15px;
        }

        .question {
            margin-bottom: 20px;
        }

        .options {
            list-style: none;
            padding: 0;
        }

        .options li {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .options li:hover {
            background: #f0f8ff;
            border-color: #2196f3;
        }

        .options li.selected {
            background: #2196f3;
            color: white;
        }

        .options li.correct {
            background: #4caf50;
            color: white;
        }

        .options li.incorrect {
            background: #f44336;
            color: white;
        }

        .feedback {
            margin-top: 15px;
            padding: 15px;
            border-radius: 5px;
            display: none;
        }

        .feedback.correct {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .feedback.incorrect {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
        }

        .nav-btn {
            background: #0066cc;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,102,204,0.3);
        }

        .nav-btn:hover {
            background: #0052a3;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,102,204,0.4);
        }

        .nav-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #8bc34a);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .slide-counter {
            text-align: center;
            color: #666;
            font-size: 14px;
        }

        .definition-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .safety-alert {
            background: #f8d7da;
            border: 2px solid #f5c6cb;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            color: #721c24;
        }

        .safety-alert::before {
            content: "⚠️ ";
            font-size: 1.2em;
        }

        .change-item {
            background: #f8f9fa;
            border-left: 4px solid #28a745;
            padding: 15px;
            margin: 10px 0;
            border-radius: 0 5px 5px 0;
        }

        .quiz-container {
            background: #fff;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .quiz-question {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
        }

        .quiz-score {
            text-align: center;
            font-size: 1.5em;
            margin: 30px 0;
            padding: 20px;
            background: #e8f5e8;
            border-radius: 10px;
        }

        .expandable {
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 10px 0;
        }

        .expandable-header {
            background: #f5f5f5;
            padding: 15px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .expandable-content {
            padding: 15px;
            display: none;
        }

        .expandable.open .expandable-content {
            display: block;
        }

        .expandable-header::after {
            content: "+";
            font-size: 1.2em;
        }

        .footer {
            background: #333;
            color: white;
            text-align: center;
            padding: 30px;
            margin-top: 50px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .footer h3 {
            color: #4caf50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .footer p {
            margin: 10px 0;
            line-height: 1.6;
        }

        .footer .copyright {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #555;
            font-size: 0.9em;
            color: #ccc;
        }
        .expandable.open .expandable-header::after {
            content: "-";
        }

        .certificate-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            margin: 30px 0;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: none;
        }

        .certificate-section.show {
            display: block;
        }

        .name-input-section {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .name-input {
            padding: 12px 20px;
            font-size: 16px;
            border: 2px solid #0066cc;
            border-radius: 5px;
            margin: 10px;
            min-width: 300px;
        }

        .generate-cert-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: all 0.3s ease;
        }

        .generate-cert-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .certificate {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border: 8px solid #0066cc;
            border-radius: 15px;
            padding: 60px 40px;
            margin: 30px auto;
            max-width: 800px;
            text-align: center;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            font-family: 'Times New Roman', serif;
            position: relative;
            display: none;
        }

        .certificate.show {
            display: block;
        }

        .certificate::before {
            content: "";
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            border: 2px solid #gold;
            border-radius: 8px;
        }

        .certificate-header {
            margin-bottom: 30px;
        }

        .certificate-title {
            font-size: 2.5em;
            color: #0066cc;
            font-weight: bold;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .certificate-subtitle {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 30px;
        }

        .certificate-body {
            margin: 40px 0;
            line-height: 1.8;
        }

        .certificate-name {
            font-size: 2em;
            color: #0066cc;
            font-weight: bold;
            margin: 20px 0;
            padding: 10px;
            border-bottom: 2px solid #0066cc;
            display: inline-block;
        }

        .certificate-course {
            font-size: 1.3em;
            color: #333;
            margin: 20px 0;
            font-weight: bold;
        }

        .certificate-details {
            font-size: 1.1em;
            color: #555;
            margin: 15px 0;
        }

        .certificate-signatures {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-top: 60px;
            padding-top: 20px;
        }

        .signature-block {
            text-align: center;
            flex: 1;
        }

        .signature-line {
            border-bottom: 2px solid #333;
            margin-bottom: 10px;
            height: 60px;
            position: relative;
        }

        .signature-name {
            font-family: 'Brush Script MT', cursive;
            font-size: 1.8em;
            color: #0066cc;
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
        }

        .signature-title {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }

        .certificate-number {
            position: absolute;
            bottom: 20px;
            right: 40px;
            font-size: 0.9em;
            color: #666;
        }

        .certificate-date {
            position: absolute;
            bottom: 20px;
            left: 40px;
            font-size: 0.9em;
            color: #666;
        }

        .print-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px 10px;
            transition: all 0.3s ease;
        }

        .print-btn:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }

        @media print {
            body * {
                visibility: hidden;
            }
            .certificate, .certificate * {
                visibility: visible;
            }
            .certificate {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: 100vh;
                margin: 0;
                box-shadow: none;
            }
            .print-btn {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="module-header">
            <svg class="lark-logo" viewBox="0 0 400 200" xmlns="http://www.w3.org/2000/svg">
                <!-- HVAC Unit Main Body -->
                <rect x="20" y="30" width="140" height="100" fill="#2E4A6B" rx="8"/>
                
                <!-- Fan/Blower Circle -->
                <circle cx="90" cy="80" r="35" fill="none" stroke="white" stroke-width="4"/>
                <circle cx="90" cy="80" r="28" fill="none" stroke="white" stroke-width="2"/>
                <circle cx="90" cy="80" r="20" fill="none" stroke="white" stroke-width="2"/>
                
                <!-- Fan Blades -->
                <g transform="translate(90,80)">
                    <path d="M -15,0 Q -8,-12 0,-15 Q 8,-12 15,0 Q 8,12 0,15 Q -8,12 -15,0" fill="white" opacity="0.8"/>
                    <path d="M 0,-15 Q 12,-8 15,0 Q 12,8 0,15 Q -12,8 -15,0 Q -12,-8 0,-15" fill="white" opacity="0.6"/>
                </g>
                
                <!-- Control Panel Lines -->
                <rect x="125" y="45" width="25" height="3" fill="white" rx="1"/>
                <rect x="125" y="55" width="20" height="3" fill="white" rx="1"/>
                <rect x="125" y="65" width="25" height="3" fill="white" rx="1"/>
                <rect x="125" y="75" width="18" height="3" fill="white" rx="1"/>
                <rect x="125" y="85" width="22" height="3" fill="white" rx="1"/>
                <rect x="125" y="95" width="25" height="3" fill="white" rx="1"/>
                <rect x="125" y="105" width="20" height="3" fill="white" rx="1"/>
                
                <!-- Status Light -->
                <circle cx="135" cy="115" r="3" fill="#4CAF50"/>
                
                <!-- Unit Feet -->
                <rect x="35" y="130" width="8" height="6" fill="#2E4A6B" rx="2"/>
                <rect x="117" y="130" width="8" height="6" fill="#2E4A6B" rx="2"/>
                
                <!-- LARK text -->
                <text x="180" y="85" font-family="Arial, sans-serif" font-size="42" font-weight="bold" fill="#2E4A6B">LARK</text>
                <!-- LABS text -->
                <text x="180" y="115" font-family="Arial, sans-serif" font-size="28" fill="#5A7A9A">Labs</text>
                <!-- Subtitle -->
                <text x="180" y="140" font-family="Arial, sans-serif" font-size="14" fill="#7A8A9A">HVAC MOBILE TOOLS AND RESOURCES</text>
            </svg>
            <h1>B149.1:25 Overview of Changes</h1>
            <p><strong>Natural Gas and Propane Installation Code</strong></p>
            <p>Interactive Learning Module - February 2025 Edition</p>
            <p style="margin-top: 15px; font-size: 0.9em; color: #666;">Created by <strong>LARK Labs</strong></p>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="slide-counter">
                <span id="currentSlide">1</span> of <span id="totalSlides">12</span>
            </div>
        </div>

        <!-- Slide 1: Introduction -->
        <div class="slide active" data-slide="1">
            <h2>Welcome to CSA B149.1:25 Resource</h2>
            <div class="key-points">
                <h3>Course Overview</h3>
                <p>After completing this course, you will be able to:</p>
                <ul>
                    <li>Identify the top substantive changes in CSA B149.1:25</li>
                    <li>Explain how additions, revisions, and deletions impact industry professionals</li>
                    <li>Apply the new requirements in practical situations</li>
                    <li>Understand the safety implications of the updates</li>
                </ul>
            </div>

            <div class="safety-alert">
                <strong>Important:</strong> This is the seventeenth edition of CSA B149.1, introducing critical updates for enhanced safety and efficiency in natural gas and propane systems.
            </div>

            <div class="knowledge-check">
                <h3>Knowledge Check 1</h3>
                <div class="question">
                    <p><strong>What is the primary purpose of the CSA B149.1:25 updates?</strong></p>
                    <ul class="options" data-correct="0">
                        <li>Enhancing safety and efficiency in gas and propane systems</li>
                        <li>Reducing installation costs</li>
                        <li>Simplifying code requirements</li>
                        <li>Expanding market opportunities</li>
                    </ul>
                    <div class="feedback correct">
                        Correct! The updates aim to enhance safety and efficiency while addressing emerging safety concerns and incorporating technological advancements.
                    </div>
                    <div class="feedback incorrect">
                        Incorrect. The primary purpose is to enhance safety and efficiency in gas and propane systems installation and operation.
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 2: Code Scope Changes -->
        <div class="slide" data-slide="2">
            <h2>Code Scope Updates</h2>
            
            <div class="change-item">
                <h3>Key Change: Demarcation Point Between B149.1 and B149.2</h3>
                <p>Updated Code Scope inclusions to clarify the threshold for propane systems between CSA B149.1 and CSA B149.2 [Clause 1.1b)]</p>
            </div>

            <div class="definition-box">
                <strong>Demarcation Point:</strong> The specific boundary that determines which code applies to different propane system components and installations.
            </div>

            <div class="expandable">
                <div class="expandable-header">
                    Understanding the Scope Division
                </div>
                <div class="expandable-content">
                    <p><strong>CSA B149.1</strong> typically covers:</p>
                    <ul>
                        <li>Larger propane installations</li>
                        <li>Commercial and industrial applications</li>
                        <li>Complex piping systems</li>
                    </ul>
                    <p><strong>CSA B149.2</strong> typically covers:</p>
                    <ul>
                        <li>Smaller propane installations</li>
                        <li>Residential applications</li>
                        <li>Portable propane appliances</li>
                    </ul>
                </div>
            </div>

            <div class="knowledge-check">
                <h3>Knowledge Check 2</h3>
                <div class="question">
                    <p><strong>Which clause addresses the updated demarcation point between B149.1 and B149.2?</strong></p>
                    <ul class="options" data-correct="1">
                        <li>Clause 1.1a)</li>
                        <li>Clause 1.1b)</li>
                        <li>Clause 1.2g)</li>
                        <li>Clause 1.3</li>
                    </ul>
                    <div class="feedback correct">
                        Correct! Clause 1.1b) specifically addresses the updated Code Scope inclusions for propane systems.
                    </div>
                    <div class="feedback incorrect">
                        Incorrect. The correct answer is Clause 1.1b), which covers the demarcation point updates.
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 3: Terminology Updates -->
        <div class="slide" data-slide="3">
            <h2>Terminology and Definition Updates</h2>

            <div class="change-item">
                <h3>Vehicle-Fuelling Appliance</h3>
                <p>Corrected terminology to "vehicle-fuelling appliance" to align with other CSA standards [Clause 1.1c)]</p>
            </div>

            <div class="change-item">
                <h3>Updated Definitions (Clause 3)</h3>
                <ul>
                    <li><strong>High Pressure Regulator</strong> → <strong>Industrial Regulator</strong></li>
                    <li><strong>Line Pressure Regulator</strong> - Updated definition</li>
                    <li><strong>Manual Shut-off Valve</strong> - New definition added</li>
                    <li><strong>Vent Limiter</strong> - New definition with sub-definition "limiting orifice type"</li>
                </ul>
            </div>

            <div class="definition-box">
                <strong>Industrial Regulator:</strong> Previously known as "high pressure regulator," these devices are designed for higher flow rates and pressures beyond the scope of certified line pressure regulators.
            </div>

            <div class="safety-alert">
                Proper terminology is crucial for safety compliance and clear communication in the field.
            </div>

            <div class="knowledge-check">
                <h3>Knowledge Check 3</h3>
                <div class="question">
                    <p><strong>What was the "high pressure regulator" renamed to in the 2025 edition?</strong></p>
                    <ul class="options" data-correct="2">
                        <li>Line pressure regulator</li>
                        <li>Service regulator</li>
                        <li>Industrial regulator</li>
                        <li>Commercial regulator</li>
                    </ul>
                    <div class="feedback correct">
                        Correct! The term "high pressure regulator" has been updated to "industrial regulator" to better reflect its application.
                    </div>
                    <div class="feedback incorrect">
                        Incorrect. The "high pressure regulator" is now called "industrial regulator."
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 4: Hydrogen-Natural Gas Blends -->
        <div class="slide" data-slide="4">
            <h2>Hydrogen-Natural Gas Blends</h2>

            <div class="safety-alert">
                Major Addition: Hydrogen-natural gas blends are now included in the Code scope, representing a significant advancement in clean energy technology.
            </div>

            <div class="change-item">
                <h3>Key Updates for Hydrogen Blends</h3>
                <ul>
                    <li>Added to list of gases included in Code (Clause 1.3)</li>
                    <li>References added to multiple applicable clauses</li>
                    <li>Specific odorization or monitoring requirements</li>
                    <li>Updated rating plate requirements for maximum hydrogen percentage</li>
                    <li>Special sealant restrictions for larger pipe sizes</li>
                </ul>
            </div>

            <div class="expandable">
                <div class="expandable-header">
                    Affected Clauses for Hydrogen-Natural Gas Blends
                </div>
                <div class="expandable-content">
                    <ul>
                        <li>Clause 4.5.4 - Rating plate requirements</li>
                        <li>Clause 4.24.1 - Odorization/monitoring requirements</li>
                        <li>Clause 5.5.1.4 - Pressure regulation</li>
                        <li>Clause 6.2.3.1 & 6.2.3.2 - Piping materials</li>
                        <li>Clauses 6.3.2 to 6.3.5 - Installation requirements</li>
                        <li>Clause 6.3.8.1 - Special considerations</li>
                        <li>Clause 6.9.6 - Sealant restrictions</li>
                        <li>Tables 5.3 and 6.1 - Reference updates</li>
                    </ul>
                </div>
            </div>

            <div class="knowledge-check">
                <h3>Knowledge Check 4</h3>
                <div class="question">
                    <p><strong>What special requirement applies to sealants when using hydrogen-natural gas blends?</strong></p>
                    <ul class="options" data-correct="0">
                        <li>Prohibited use of tape as sealant for pipe sizes larger than NPS 1-1/2</li>
                        <li>Must use special hydrogen-rated tape</li>
                        <li>Requires double-wrap application</li>
                        <li>No special requirements apply</li>
                    </ul>
                    <div class="feedback correct">
                        Correct! Clause 6.9.6 prohibits the use of tape as a sealant for pipe sizes larger than NPS 1-1/2 when using hydrogen-natural gas blends.
                    </div>
                    <div class="feedback incorrect">
                        Incorrect. The code prohibits tape sealants for pipes larger than NPS 1-1/2 with hydrogen-natural gas blends.
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 5: Bonding and Electrical Updates -->
        <div class="slide" data-slide="5">
            <h2>Bonding and Electrical System Updates</h2>

            <div class="change-item">
                <h3>Bonding Requirements Alignment</h3>
                <p>Updated bonding requirements to align with the Canadian Electrical Code, Part I (Clauses 4.7.3, 4.7.4, and 4.7.5)</p>
            </div>

            <div class="change-item">
                <h3>Gas and Electrical System Separation</h3>
                <p>Added minimum separation requirements between gas systems and electrical systems sharing a common trench (Clause 6.15.15)</p>
            </div>

            <div class="safety-alert">
                Proper bonding of gas piping systems and appliances to electrical ground is critical for safety and must comply with current electrical code requirements.
            </div>

            <div class="expandable">
                <div class="expandable-header">
                    Why Bonding is Important
                </div>
                <div class="expandable-content">
                    <h4>Safety Functions of Proper Bonding:</h4>
                    <ul>
                        <li>Prevents dangerous voltage differences</li>
                        <li>Provides path for fault currents</li>
                        <li>Reduces risk of electrical shock</li>
                        <li>Protects against lightning damage</li>
                        <li>Ensures consistent electrical potential</li>
                    </ul>
                    <h4>Common Trench Considerations:</h4>
                    <ul>
                        <li>Maintain adequate separation distances</li>
                        <li>Use appropriate barrier materials</li>
                        <li>Follow proper installation sequence</li>
                        <li>Consider future maintenance access</li>
                    </ul>
                </div>
            </div>

            <div class="knowledge-check">
                <h3>Knowledge Check 5</h3>
                <div class="question">
                    <p><strong>Which electrical code do the updated bonding requirements align with?</strong></p>
                    <ul class="options" data-correct="1">
                        <li>National Electrical Code (NEC)</li>
                        <li>Canadian Electrical Code, Part I</li>
                        <li>International Electrical Code</li>
                        <li>CSA Electrical Standard C22.1</li>
                    </ul>
                    <div class="feedback correct">
                        Correct! The bonding requirements have been updated to align with the Canadian Electrical Code, Part I.
                    </div>
                    <div class="feedback incorrect">
                        Incorrect. The updated bonding requirements align with the Canadian Electrical Code, Part I.
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 6: Pressure Regulation Updates -->
        <div class="slide" data-slide="6">
            <h2>Pressure Regulation and Protection</h2>

            <div class="change-item">
                <h3>Industrial Regulator Applications</h3>
                <p>Added ability to use industrial regulators when flows/pressures are outside the scope of certified line pressure regulators, with mandatory interlocking to high/low gas pressure devices</p>
            </div>

            <div class="change-item">
                <h3>Overpressure Protection Requirements</h3>
                <p>Clarified that overpressure protection devices used with certified line pressure regulators must be factory pre-assembled and shipped as a unit</p>
            </div>

            <div class="definition-box">
                <strong>Overpressure Protection:</strong> Safety devices that prevent dangerous pressure levels by automatically venting or shutting off gas flow when predetermined pressure limits are exceeded.
            </div>

            <div class="expandable">
                <div class="expandable-header">
                    When to Use Industrial Regulators
                </div>
                <div class="expandable-content">
                    <h4>Industrial regulators are required when:</h4>
                    <ul>
                        <li>Flow rates exceed certified line pressure regulator capacity</li>
                        <li>Operating pressures are beyond standard regulator range</li>
                        <li>Special applications require non-standard pressure control</li>
                        <li>System demands exceed residential/commercial specifications</li>
                    </ul>
                    <h4>Safety Requirements:</h4>
                    <ul>
                        <li>Must be interlocked with high/low gas pressure devices</li>
                        <li>Pressure device must serve the same appliance</li>
                        <li>Proper installation and testing procedures required</li>
                        <li>Regular maintenance and inspection schedules</li>
                    </ul>
                </div>
            </div>

            <div class="knowledge-check">
                <h3>Knowledge Check 6</h3>
                <div class="question">
                    <p><strong>What is required when using industrial regulators?</strong></p>
                    <ul class="options" data-correct="2">
                        <li>Special CSA certification</li>
                        <li>Additional venting capacity</li>
                        <li>Interlocking with high/low gas pressure device serving same appliance</li>
                        <li>Double pressure monitoring systems</li>
                    </ul>
                    <div class="feedback correct">
                        Correct! Industrial regulators must be interlocked with a high/low gas pressure device that serves the same appliance.
                    </div>
                    <div class="feedback incorrect">
                        Incorrect. Industrial regulators must be interlocked with high/low gas pressure devices serving the same appliance.
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 7: Venting and Clearance Updates -->
        <div class="slide" data-slide="7">
            <h2>Venting and Clearance Requirements</h2>

            <div class="change-item">
                <h3>Gas Vent Termination Clearances</h3>
                <p>Updated clearances for gas vent terminations (Table 5.3), now based on relief capacity and aligned with CSA Z662:23 (Annex D)</p>
            </div>

            <div class="change-item">
                <h3>Consolidated Exemptions</h3>
                <p>Restructured Clause 5 to consolidate exemptions for outdoor gas vent terminations, accounting for vent limiters and indoor ventilated spaces</p>
            </div>

            <div class="safety-alert">
                Proper vent termination clearances are critical to prevent gas accumulation and ensure safe dispersion of vented gases.
            </div>

            <div class="expandable">
                <div class="expandable-header">
                    Understanding Relief Capacity-Based Clearances
                </div>
                <div class="expandable-content">
                    <h4>Why Relief Capacity Matters:</h4>
                    <ul>
                        <li>Higher relief capacity = greater clearance requirements</li>
                        <li>Ensures adequate gas dispersion</li>
                        <li>Prevents dangerous gas accumulation</li>
                        <li>Accounts for wind effects and building proximity</li>
                    </ul>
                    <h4>Factors Affecting Clearance Requirements:</h4>
                    <ul>
                        <li>Volume of gas being vented</li>
                        <li>Pressure of vented gas</li>
                        <li>Proximity to building openings</li>
                        <li>Adjacent structures and obstacles</li>
                        <li>Prevailing wind patterns</li>
                        <li>Type of vent limiter used</li>
                    </ul>
                </div>
            </div>

            <div class="knowledge-check">
                <h3>Knowledge Check 7</h3>
                <div class="question">
                    <p><strong>What is the new basis for gas vent termination clearances in Table 5.3?</strong></p>
                    <ul class="options" data-correct="0">
                        <li>Relief capacity</li>
                        <li>Pipe diameter</li>
                        <li>Building height</li>
                        <li>Wind speed</li>
                    </ul>
                    <div class="feedback correct">
                        Correct! The updated clearances are now based on relief capacity and aligned with CSA Z662:23.
                    </div>
                    <div class="feedback incorrect">
                        Incorrect. The new clearances in Table 5.3 are based on relief capacity.
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 8: Piping and Materials -->
        <div class="slide" data-slide="8">
            <h2>Piping and Materials Updates</h2>

            <div class="change-item">
                <h3>Press-Connect Fittings</h3>
                <p>Updated requirements to permit press-connect fittings certified to CSA/ANSI LC 4/CSA 6.32 for piping of NPS 2-1/2 to 4 (Clause 6.9.2)</p>
            </div>

            <div class="change-item">
                <h3>Liquid Propane System Restrictions</h3>
                <p>Prohibited the use of hoses certified to CSA 8.3 for liquid propane systems (Clause 6.2.12)</p>
            </div>

            <div class="change-item">
                <h3>Sleeve Requirements</h3>
                <p>Added sleeve requirements for piping or tubing that passes through exterior walls (Clauses 6.16.9 and 6.16.10)</p>
            </div>

            <div class="expandable">
                <div class="expandable-header">
                    Press-Connect Fitting Advantages
                </div>
                <div class="expandable-content">
                    <h4>Benefits of Press-Connect Fittings:</h4>
                    <ul>
                        <li>Faster installation compared to threaded connections</li>
                        <li>Consistent, reliable connections</li>
                        <li>Reduced labor costs</li>
                        <li>Less risk of installation errors</li>
                        <li>Suitable for larger pipe sizes (NPS 2-1/2 to 4)</li>
                    </ul>
                    <h4>Installation Considerations:</h4>
                    <ul>
                        <li>Proper pipe preparation required</li>
                        <li>Use correct pressing tools</li>
                        <li>Follow manufacturer specifications</li>
                        <li>Verify certification compliance</li>
                    </ul>
                </div>
            </div>

            <div class="knowledge-check">
                <h3>Knowledge Check 8</h3>
                <div class="question">
                    <p><strong>For which pipe sizes are press-connect fittings now permitted?</strong></p>
                    <ul class="options" data-correct="3">
                        <li>NPS 1/2 to 2</li>
                        <li>NPS 1 to 3</li>
                        <li>NPS 2 to 6</li>
                        <li>NPS 2-1/2 to 4</li>
                    </ul>
                    <div class="feedback correct">
                        Correct! Press-connect fittings certified to CSA/ANSI LC 4/CSA 6.32 are now permitted for NPS 2-1/2 to 4 piping.
                    </div>
                    <div class="feedback incorrect">
                        Incorrect. Press-connect fittings are permitted for NPS 2-1/2 to 4 piping.
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 9: Testing and Purging -->
        <div class="slide" data-slide="9">
            <h2>Testing and Purging Requirements</h2>

            <div class="change-item">
                <h3>Leakage Test Updates</h3>
                <p>Clarified leakage test requirements and allowable leakage rates (Clauses 6.22.2, 6.22.3, 6.22.4, and Annex K)</p>
            </div>

            <div class="change-item">
                <h3>Purging Monitoring</h3>
                <p>Added requirements for monitoring by combustible gas indicator during purging (Clauses 6.23.4 and 6.23.7)</p>
            </div>

            <div class="safety-alert">
                Proper testing and purging procedures are essential for system safety and must be performed by qualified personnel using appropriate equipment.
            </div>

            <div class="expandable">
                <div class="expandable-header">
                    Leakage Testing Best Practices
                </div>
                <div class="expandable-content">
                    <h4>Testing Procedures:</h4>
                    <ul>
                        <li>Use appropriate test pressures</li>
                        <li>Allow adequate test duration</li>
                        <li>Monitor pressure stability</li>
                        <li>Check all connections and joints</li>
                        <li>Document test results</li>
                    </ul>
                    <h4>Purging Safety:</h4>
                    <ul>
                        <li>Use combustible gas indicators</li>
                        <li>Ensure adequate ventilation</li>
                        <li>Follow proper purging sequence</li>
                        <li>Monitor gas concentrations continuously</li>
                        <li>Verify complete air removal</li>
                    </ul>
                </div>
            </div>

            <div class="knowledge-check">
                <h3>Knowledge Check 9</h3>
                <div class="question">
                    <p><strong>What new monitoring requirement was added for purging operations?</strong></p>
                    <ul class="options" data-correct="1">
                        <li>Pressure monitoring</li>
                        <li>Combustible gas indicator monitoring</li>
                        <li>Temperature monitoring</li>
                        <li>Flow rate monitoring</li>
                    </ul>
                    <div class="feedback correct">
                        Correct! Monitoring by combustible gas indicator is now required during purging operations.
                    </div>
                    <div class="feedback incorrect">
                        Incorrect. Combustible gas indicator monitoring is the new requirement for purging operations.
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 10: Appliance-Specific Updates -->
        <div class="slide" data-slide="10">
            <h2>Appliance-Specific Requirements</h2>

            <div class="change-item">
                <h3>Stationary Engine Generator Assemblies</h3>
                <p>Must be certified to ANSI/CAN UL/ULC 2200 (Clause 7.2.4.1)</p>
            </div>

            <div class="change-item">
                <h3>Commercial Clothes Dryers</h3>
                <p>Flexible foil noncombustible ducts must be certified to UL 2158A (Clause 7.4.3)</p>
            </div>

            <div class="change-item">
                <h3>Direct-Fired Makeup Air Heaters</h3>
                <p>Permitted approved engineering designs for installation where food preparation areas are interconnected to public areas (Clauses 7.20.14 and 7.21.13)</p>
            </div>

            <div class="expandable">
                <div class="expandable-header">
                    Engine Generator Safety Considerations
                </div>
                <div class="expandable-content">
                    <h4>Certification Benefits:</h4>
                    <ul>
                        <li>Ensures compliance with safety standards</li>
                        <li>Reduces fire and explosion risks</li>
                        <li>Improves reliability and performance</li>
                        <li>Provides manufacturer accountability</li>
                    </ul>
                    <h4>Installation Requirements:</h4>
                    <ul>
                        <li>Proper ventilation design</li>
                        <li>Adequate clearances from combustibles</li>
                        <li>Appropriate fuel train protection</li>
                        <li>Emergency shutdown systems</li>
                    </ul>
                </div>
            </div>

            <div class="knowledge-check">
                <h3>Knowledge Check 10</h3>
                <div class="question">
                    <p><strong>What certification is required for stationary engine generator assemblies?</strong></p>
                    <ul class="options" data-correct="0">
                        <li>ANSI/CAN UL/ULC 2200</li>
                        <li>CSA B149.1</li>
                        <li>NFPA 37</li>
                        <li>UL 2158A</li>
                    </ul>
                    <div class="feedback correct">
                        Correct! Stationary engine generator assemblies must be certified to ANSI/CAN UL/ULC 2200.
                    </div>
                    <div class="feedback incorrect">
                        Incorrect. The required certification is ANSI/CAN UL/ULC 2200.
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 11: Summary and Key Takeaways -->
        <div class="slide" data-slide="11">
            <h2>Summary of Major Changes</h2>

            <div class="key-points">
                <h3>Critical Updates to Remember</h3>
                <ul>
                    <li><strong>Scope Clarification:</strong> Better demarcation between B149.1 and B149.2</li>
                    <li><strong>Hydrogen Integration:</strong> Support for hydrogen-natural gas blends</li>
                    <li><strong>Electrical Alignment:</strong> Updated bonding requirements with electrical code</li>
                    <li><strong>Enhanced Safety:</strong> Improved testing, purging, and monitoring requirements</li>
                    <li><strong>Material Updates:</strong> New provisions for press-connect fittings and restrictions</li>
                    <li><strong>Industrial Applications:</strong> Expanded options for industrial regulators</li>
                </ul>
            </div>

            <div class="safety-alert">
                These changes represent significant improvements in safety standards and must be implemented in all new installations and applicable retrofits.
            </div>

            <div class="expandable">
                <div class="expandable-header">
                    Implementation Timeline and Compliance
                </div>
                <div class="expandable-content">
                    <h4>Effective Date:</h4>
                    <p>CSA B149.1:25 becomes effective as adopted by jurisdictional authorities. Check with your local authority having jurisdiction for specific implementation dates.</p>
                    
                    <h4>Transition Considerations:</h4>
                    <ul>
                        <li>Existing installations may be grandfathered under previous codes</li>
                        <li>Major modifications may trigger compliance with new requirements</li>
                        <li>Resources and certification updates may be required</li>
                        <li>Documentation and record-keeping procedures should be updated</li>
                    </ul>
                </div>
            </div>

            <div class="knowledge-check">
                <h3>Knowledge Check 11</h3>
                <div class="question">
                    <p><strong>Which of the following represents the most significant new addition to the code?</strong></p>
                    <ul class="options" data-correct="2">
                        <li>Press-connect fittings for larger pipes</li>
                        <li>Updated bonding requirements</li>
                        <li>Inclusion of hydrogen-natural gas blends</li>
                        <li>Industrial regulator applications</li>
                    </ul>
                    <div class="feedback correct">
                        Correct! The inclusion of hydrogen-natural gas blends represents the most significant new addition, reflecting the advancement toward clean energy technology.
                    </div>
                    <div class="feedback incorrect">
                        Incorrect. The inclusion of hydrogen-natural gas blends is the most significant new addition to the code.
                    </div>
                </div>
            </div>
        </div>

        <!-- Slide 12: Final Quiz -->
        <div class="slide" data-slide="12">
            <div class="quiz-container">
                <h2>Final Assessment Quiz</h2>
                <p>Complete this quiz to test your understanding of CSA B149.1:25 changes. You need 80% to pass.</p>

                <div class="quiz-question">
                    <p><strong>1. What is the new term for "high pressure regulator"?</strong></p>
                    <ul class="quiz-options" data-correct="2">
                        <li>Service regulator</li>
                        <li>Line pressure regulator</li>
                        <li>Industrial regulator</li>
                        <li>Commercial regulator</li>
                    </ul>
                </div>

                <div class="quiz-question">
                    <p><strong>2. Hydrogen-natural gas blends must be:</strong></p>
                    <ul class="quiz-options" data-correct="0">
                        <li>Odorized or monitored by a detection system</li>
                        <li>Used only in residential applications</li>
                        <li>Limited to 5% hydrogen content</li>
                        <li>Installed with special purple piping</li>
                    </ul>
                </div>

                <div class="quiz-question">
                    <p><strong>3. Press-connect fittings are now permitted for which pipe sizes?</strong></p>
                    <ul class="quiz-options" data-correct="3">
                        <li>NPS 1/2 to 2</li>
                        <li>NPS 1 to 3</li>
                        <li>NPS 2 to 6</li>
                        <li>NPS 2-1/2 to 4</li>
                    </ul>
                </div>

                <div class="quiz-question">
                    <p><strong>4. During purging operations, what monitoring is required?</strong></p>
                    <ul class="quiz-options" data-correct="1">
                        <li>Pressure monitoring only</li>
                        <li>Combustible gas indicator monitoring</li>
                        <li>Temperature monitoring</li>
                        <li>No monitoring required</li>
                    </ul>
                </div>

                <div class="quiz-question">
                    <p><strong>5. Gas vent termination clearances are now based on:</strong></p>
                    <ul class="quiz-options" data-correct="0">
                        <li>Relief capacity</li>
                        <li>Pipe diameter</li>
                        <li>Building height</li>
                        <li>Wind speed</li>
                    </ul>
                </div>

                <button class="nav-btn" onclick="calculateQuizScore()">Submit Quiz</button>
                
                <div id="quizResults" style="display: none;">
                    <div class="quiz-score">
                        <h3>Quiz Results</h3>
                        <p>Your Score: <span id="finalScore"></span></p>
                        <p id="passMessage"></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Certificate Section -->
        <div class="certificate-section" id="certificateSection">
            <h2>Certificate of Completion</h2>
            <p>Congratulations on successfully completing the CSA B149.1:25 Overview of Changes resource module!</p>
            
            <div class="name-input-section">
                <h3>Generate Your Certificate</h3>
                <p>Please enter your full name as you would like it to appear on your certificate:</p>
                <input type="text" id="participantName" class="name-input" placeholder="Enter your full name" maxlength="50">
                <br>
                <button class="generate-cert-btn" onclick="generateCertificate()">Generate Certificate</button>
            </div>

            <div class="certificate" id="completionCertificate">
                <div class="certificate-header">
                    <div class="certificate-title">Certificate of Completion</div>
                    <div class="certificate-subtitle">Professional Resource Program</div>
                </div>

                <div class="certificate-body">
                    <p style="font-size: 1.2em; margin-bottom: 30px;">This is to certify that</p>
                    
                    <div class="certificate-name" id="certName">[Participant Name]</div>
                    
                    <p style="font-size: 1.1em; margin: 30px 0;">has successfully completed the resource program</p>
                    
                    <div class="certificate-course">CSA B149.1:25 Overview of Changes<br>
                    Natural Gas and Propane Installation Code</div>
                    
                    <div class="certificate-details">
                        Interactive Learning Module - February 2025 Edition<br>
                        Minimum Passing Score: 80% | Duration: Self-Paced
                    </div>
                </div>

                <div class="certificate-signatures">
                    <div class="signature-block">
                        <div class="signature-line">
                            <div class="signature-name">Michael J. Kapin</div>
                        </div>
                        <div class="signature-title">LARK Labs Resource Coordinator</div>
                    </div>
                    <div class="signature-block">
                        <div class="signature-line"></div>
                        <div class="signature-title">Date of Completion</div>
                    </div>
                </div>

                <div class="certificate-number">Certificate No: <span id="certNumber">[Number]</span></div>
                <div class="certificate-date">Date: <span id="certDate">[Date]</span></div>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="print-btn" onclick="printCertificate()" style="display: none;" id="printBtn">Print Certificate</button>
                <button class="print-btn" onclick="downloadCertificate()" style="display: none;" id="downloadBtn">Download PDF</button>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn" id="prevBtn" onclick="changeSlide(-1)" disabled>Previous</button>
            <button class="nav-btn" id="nextBtn" onclick="changeSlide(1)">Next</button>
        </div>

        <div class="footer">
            <h3>LARK Labs</h3>
            <p>This interactive learning module was developed by <strong>LARK Labs</strong>, specializing in professional resources solutions for technical industries.</p>
            <p>For more information about our resources programs and educational technology solutions, contact LARK Labs.</p>
            
            <div class="copyright">
                <p>&copy; 2025 LARK Labs. All rights reserved.</p>
                <p>CSA B149.1:25 content is based on the Canadian Standards Association publication. This resource module is designed for educational purposes and does not replace the official CSA B149.1:25 standard.</p>
                <p><strong>Disclaimer:</strong> Users are responsible for ensuring compliance with the most current version of applicable codes and standards as adopted by their local jurisdiction.</p>
            </div>
        </div>
    </div>

    <script>
        let currentSlideIndex = 1;
        const totalSlides = 12;
        let knowledgeCheckAnswers = {};
        let quizAnswers = {};
        let certificateGenerated = false;

        function updateProgress() {
            const progress = (currentSlideIndex / totalSlides) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            document.getElementById('currentSlide').textContent = currentSlideIndex;
        }

        function changeSlide(direction) {
            const slides = document.querySelectorAll('.slide');
            const currentSlide = document.querySelector('.slide.active');
            
            if (currentSlide) {
                currentSlide.classList.remove('active');
            }

            currentSlideIndex += direction;

            if (currentSlideIndex < 1) {
                currentSlideIndex = 1;
            } else if (currentSlideIndex > totalSlides) {
                currentSlideIndex = totalSlides;
            }

            slides[currentSlideIndex - 1].classList.add('active');
            
            updateProgress();
            updateNavButtons();
        }

        function updateNavButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            
            prevBtn.disabled = currentSlideIndex === 1;
            
            if (currentSlideIndex === totalSlides) {
                nextBtn.style.display = 'none';
            } else {
                nextBtn.style.display = 'block';
                nextBtn.disabled = false;
            }
        }

        // Knowledge Check functionality
        document.addEventListener('click', function(e) {
            if (e.target.closest('.options li')) {
                handleKnowledgeCheck(e.target.closest('.options li'));
            }
            
            if (e.target.closest('.quiz-options li')) {
                handleQuizOption(e.target.closest('.quiz-options li'));
            }

            if (e.target.closest('.expandable-header')) {
                toggleExpandable(e.target.closest('.expandable'));
            }
        });

        function handleKnowledgeCheck(selectedOption) {
            const optionsList = selectedOption.parentElement;
            const correctIndex = parseInt(optionsList.dataset.correct);
            const selectedIndex = Array.from(optionsList.children).indexOf(selectedOption);
            const feedbacks = optionsList.parentElement.querySelectorAll('.feedback');
            
            // Clear previous selections
            optionsList.querySelectorAll('li').forEach(li => {
                li.classList.remove('selected', 'correct', 'incorrect');
            });
            
            // Mark selection
            selectedOption.classList.add('selected');
            
            // Show correct answer
            optionsList.children[correctIndex].classList.add('correct');
            
            // Mark incorrect if wrong
            if (selectedIndex !== correctIndex) {
                selectedOption.classList.add('incorrect');
            }
            
            // Show appropriate feedback
            feedbacks.forEach(feedback => feedback.style.display = 'none');
            if (selectedIndex === correctIndex) {
                feedbacks[0].style.display = 'block';
            } else {
                feedbacks[1].style.display = 'block';
            }
        }

        function handleQuizOption(selectedOption) {
            const optionsList = selectedOption.parentElement;
            const questionIndex = Array.from(document.querySelectorAll('.quiz-question')).indexOf(selectedOption.closest('.quiz-question'));
            const selectedIndex = Array.from(optionsList.children).indexOf(selectedOption);
            
            // Clear previous selections in this question
            optionsList.querySelectorAll('li').forEach(li => {
                li.classList.remove('selected');
            });
            
            // Mark current selection
            selectedOption.classList.add('selected');
            
            // Store answer
            quizAnswers[questionIndex] = selectedIndex;
        }

        function toggleExpandable(expandable) {
            expandable.classList.toggle('open');
        }

        function calculateQuizScore() {
            const correctAnswers = [2, 0, 3, 1, 0]; // Correct answer indices for each question
            let correct = 0;
            
            for (let i = 0; i < correctAnswers.length; i++) {
                if (quizAnswers[i] === correctAnswers[i]) {
                    correct++;
                }
            }
            
            const percentage = Math.round((correct / correctAnswers.length) * 100);
            
            document.getElementById('finalScore').textContent = `${correct}/${correctAnswers.length} (${percentage}%)`;
            
            const passMessage = document.getElementById('passMessage');
            if (percentage >= 80) {
                passMessage.innerHTML = '<strong style="color: green;">Congratulations! You passed the assessment.</strong><br>You are now eligible for a certificate of completion.';
                // Show certificate section
                document.getElementById('certificateSection').classList.add('show');
            } else {
                passMessage.innerHTML = '<strong style="color: red;">You need 80% to pass. Please review the material and try again.</strong>';
            }
            
            document.getElementById('quizResults').style.display = 'block';
        }

        function generateCertificateNumber() {
            // Generate a unique certificate number
            const date = new Date();
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const random = Math.floor(Math.random() * 9000) + 1000; // 4-digit random number
            return `CSA-B149-${year}${month}${day}-${random}`;
        }

        function generateCertificate() {
            const nameInput = document.getElementById('participantName');
            const participantName = nameInput.value.trim();
            
            if (!participantName) {
                alert('Please enter your full name to generate the certificate.');
                nameInput.focus();
                return;
            }

            // Check if quiz was passed
            const finalScore = document.getElementById('finalScore').textContent;
            if (!finalScore.includes('80%') && !finalScore.includes('100%') && !finalScore.includes('(100%)') && !finalScore.includes('(80%)')) {
                // Check if they actually passed by looking at the score
                const scoreMatch = finalScore.match(/\((\d+)%\)/);
                if (!scoreMatch || parseInt(scoreMatch[1]) < 80) {
                    alert('You must pass the quiz with 80% or higher before generating a certificate.');
                    return;
                }
            }

            // Generate certificate
            const certificate = document.getElementById('completionCertificate');
            const certName = document.getElementById('certName');
            const certNumber = document.getElementById('certNumber');
            const certDate = document.getElementById('certDate');

            // Set participant name
            certName.textContent = participantName;

            // Set certificate number
            const certificateNumber = generateCertificateNumber();
            certNumber.textContent = certificateNumber;

            // Set completion date
            const today = new Date();
            const formattedDate = today.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            certDate.textContent = formattedDate;

            // Show certificate and buttons
            certificate.classList.add('show');
            document.getElementById('printBtn').style.display = 'inline-block';
            document.getElementById('downloadBtn').style.display = 'inline-block';

            // Scroll to certificate
            certificate.scrollIntoView({ behavior: 'smooth' });

            certificateGenerated = true;
        }

        function printCertificate() {
            if (!certificateGenerated) {
                alert('Please generate your certificate first.');
                return;
            }
            window.print();
        }

        function downloadCertificate() {
            if (!certificateGenerated) {
                alert('Please generate your certificate first.');
                return;
            }
            
            // Simple download notification (in a real implementation, you'd generate a PDF)
            alert('Certificate download functionality would be implemented here. For now, please use the Print option and save as PDF.');
        }

        // Initialize
        updateProgress();
        updateNavButtons();
    </script>
</body>
</html>